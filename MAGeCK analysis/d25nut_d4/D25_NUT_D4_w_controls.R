pdf(file='D25_NUT_D4_w_controls.pdf',width=4.5,height=4.5);
gstable=read.table('D25_NUT_D4_w_controls.gene_summary.txt',header=T)
# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=3
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("V10V","E11K","V10I","L111V","R158AfsTer12","G154AfsTer16","E298Q","P301S","L114FfsTer35","R158_A159insP")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='D25-NUT-REP1,D25-NUT-REP2,D25-NUT-REP3_vs_D4-REP1,D4-REP2,D4-REP3 neg.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(56.771570464158366,20.72480472532036,36.25080409316965,45.00320781603517,0.0,0.0),c(187.3461825317226,228.37140591554936,54.37620613975447,4.245585643022186,4.153432243892656,18.386274370793654),c(68.12588455699004,106.01534724875415,73.01947681624172,387.19741064362336,8.306864487785312,33.325122297063494),c(15.139085457108898,15.942157481015663,5.1786862990242355,3.396468514417749,0.0,13.78970577809524),c(64.34111319271281,55.797551183554816,44.018833541706,2.547351385813312,0.0,33.325122297063494),c(87.04974137837617,14.746495669939486,38.840147242681766,0.8491171286044372,16.613728975570623,2.2982842963492067),c(92.726898424792,60.580198427859514,67.84079051721748,29.719099501155302,4.153432243892656,1.1491421481746034),c(7.569542728554449,20.72480472532036,7.25016081863393,0.0,0.0,75.84338177952382),c(3.7847713642772245,17.934927166142618,49.19751984073024,0.0,8.306864487785312,0.0),c(115.43552661045534,46.63081063197081,107.19880638980167,23.775279600924243,8.306864487785312,4.5965685926984134),c(13.246699774970285,28.2973295288028,19.679007936292095,18.680576829297618,0.0,2.2982842963492067),c(166.52994002819787,107.60956299685571,126.87781432609377,4.245585643022186,8.306864487785312,14.938847926269844),c(9.461928410693062,14.746495669939486,32.10785505395026,1.6982342572088744,16.613728975570623,1.1491421481746034),c(83.26497001409894,96.84860669717014,66.80505325741264,84.91171286044373,137.06326404845765,329.80379652611117),c(121.11268365687118,97.64571457122094,108.23454364960652,0.8491171286044372,16.613728975570623,4.5965685926984134),c(39.74009932491086,35.471300395259846,9.839503968146047,0.8491171286044372,913.7550936563842,3.44742644452381),c(92.726898424792,51.01490393925012,25.893431495121177,2.547351385813312,0.0,5.745710740873017),c(9.461928410693062,9.565294488609396,17.6075334166824,7.642054157439935,0.0,2.2982842963492067),c(83.26497001409894,47.82647244304699,35.732935463267225,0.8491171286044372,0.0,52.860538816031756),c(158.96039729964343,88.87752795666232,87.51979845350958,67.08025315975054,4.153432243892656,0.0),c(18.923856821386124,4.384093307279307,41.94735902209631,7.642054157439935,0.0,2.2982842963492067),c(56.771570464158366,52.609119687351686,24.85769423531633,237.75279600924242,16.613728975570623,5.745710740873017),c(174.09948275675234,181.74059528357856,292.0779072649669,15.28410831487987,20.76716121946328,965.2794044666668),c(236.54821026732654,70.54404685349431,44.018833541706,22.07704534371537,606.4011076083277,1.1491421481746034),c(215.7319677638018,112.79076417818581,75.60881996575384,39.05938791580411,8.306864487785312,186.16102800428575),c(155.1756259353662,78.11657165697675,68.87652777702233,29.719099501155302,49.84118692671187,18.386274370793654),c(100.29644115334645,34.275638584183675,62.66210421819325,13.585874057670996,49.84118692671187,2.2982842963492067))
targetgene="V10V"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(100.29644115334645,37.464070080386804,59.037023808876285,215.67575066552706,20.76716121946328,5.745710740873017),c(105.97359819976228,75.326694097799,115.48470446824045,28.869982372550865,91.37550936563844,103.4227933357143),c(13.246699774970285,59.783090553808734,14.50032163726786,1.6982342572088744,0.0,1.1491421481746034),c(121.11268365687118,135.50833858863314,100.98438283097259,1.6982342572088744,24.920593463355935,4.5965685926984134),c(272.5035382279602,126.74015197407451,148.11042815209314,17.83145970069318,49.84118692671187,1.1491421481746034),c(20.816242503524734,17.934927166142618,32.10785505395026,4.245585643022186,4.153432243892656,12.640563629920637),c(15.139085457108898,9.565294488609396,11.393109857853318,0.0,8.306864487785312,14.938847926269844),c(47.3096420534653,34.674192521209065,42.46522765199873,2.547351385813312,4.153432243892656,2.2982842963492067),c(32.170556596356406,74.52958622374823,36.76867272307207,2.547351385813312,0.0,122.95820985468256),c(20.816242503524734,11.159510236710963,31.072117794145413,1.6982342572088744,53.99461917060452,2.2982842963492067),c(211.94719639952456,72.13826260159587,53.340468879949626,8.491171286044372,3588.565458723255,21.833700815317464),c(300.88932346003935,82.10211102723066,114.4489672084356,5.094702771626624,20.76716121946328,179.26617511523813),c(32.170556596356406,33.47853071013289,33.14359231375511,6.792937028835498,8.306864487785312,3.44742644452381),c(128.68222638542562,85.68909646045918,233.55875208599304,3.396468514417749,20.76716121946328,93.08051400214288),c(35.95532796063363,57.391766931656385,30.036380534340566,1.6982342572088744,12.460296731677968,3.44742644452381),c(60.55634182843559,56.993212994630994,30.55424916424299,0.0,8.306864487785312,62.053676001428585),c(5.677157046415837,21.521912599371145,19.679007936292095,26.322630986737554,4.153432243892656,2.2982842963492067),c(13.246699774970285,11.159510236710963,5.1786862990242355,0.0,12.460296731677968,32.1759801488889),c(13.246699774970285,4.384093307279307,25.893431495121177,0.0,4.153432243892656,0.0),c(98.40405547120784,42.2467173246915,66.28718462751021,1.6982342572088744,0.0,51.71139666785715),c(51.09441341774253,53.00767362437708,19.679007936292095,140.10432621973214,8.306864487785312,0.0),c(113.54314092831673,126.34159803704912,58.51915517897386,56.041730487892856,12.460296731677968,11.491421481746034),c(278.180695274376,80.50789527912909,130.50289473541073,389.7447620294367,20.76716121946328,1475.4985182561907),c(66.23349887485143,64.56573779811343,66.28718462751021,717.5039736707495,12.460296731677968,5.745710740873017),c(321.7055659635641,95.25439094906858,184.36123224526278,3.396468514417749,16.613728975570623,6.89485288904762),c(45.417256371326694,33.0799767731075,53.340468879949626,1.6982342572088744,116.29610282899436,0.0),c(90.83451274265339,17.934927166142618,96.8414337917532,0.0,4.153432243892656,3.44742644452381))
targetgene="E11K"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(20.816242503524734,23.5146822844981,11.910978487755742,5.094702771626624,3526.263975064865,1.1491421481746034),c(15.139085457108898,11.159510236710963,6.214423558829083,1.6982342572088744,357.1951729747684,1.1491421481746034),c(35.95532796063363,13.550833858863312,46.60817669121812,0.8491171286044372,4.153432243892656,2.2982842963492067),c(60.55634182843559,6.775416929431656,19.16113930638967,0.0,0.0,0.0),c(136.2517691139801,102.42836181552563,103.05585735058229,3.396468514417749,8.306864487785312,196.50330733785717),c(109.75836956403951,40.65250157658994,54.37620613975447,2.547351385813312,4.153432243892656,0.0),c(24.60101386780196,17.137819292091837,23.821956975511483,16.982342572088744,12.460296731677968,3.44742644452381),c(22.708628185663347,21.521912599371145,31.072117794145413,3.396468514417749,0.0,2.2982842963492067),c(90.83451274265339,65.36284567216421,63.6978414779981,0.8491171286044372,141.2166962923503,8.043995037222224),c(9.461928410693062,0.39855393702539155,6.214423558829083,0.0,0.0,0.0),c(37.84771364277225,56.19610512058021,31.072117794145413,36.5120365299908,137.06326404845765,2.2982842963492067),c(20.816242503524734,15.54360354399027,10.357372598048471,0.0,220.13190892631076,1.1491421481746034),c(71.91065592126726,129.53002953325225,60.07276106868113,3.396468514417749,12.460296731677968,6.89485288904762),c(107.8659838819009,86.88475827153536,138.2709241839471,3.396468514417749,0.0,10.34227933357143),c(132.46699774970287,71.73970866457047,106.68093775989925,3.396468514417749,228.43877341409606,6.89485288904762),c(70.01827023912865,54.601889372478645,103.05585735058229,95.10111840369697,0.0,2.2982842963492067),c(28.385785232079183,28.695883465828192,31.589986424047837,1.6982342572088744,0.0,2.2982842963492067),c(70.01827023912865,54.601889372478645,45.57243943141327,2.547351385813312,4.153432243892656,62.053676001428585),c(24.60101386780196,23.913236221523494,9.839503968146047,1.6982342572088744,4.153432243892656,83.88737681674604),c(52.98679909988114,43.44237913576768,73.01947681624172,0.0,0.0,10.34227933357143),c(43.524870689188084,41.84816338766611,25.375562865218754,84.91171286044373,0.0,0.0),c(24.60101386780196,74.13103228672283,38.840147242681766,25.473513858133117,8.306864487785312,1139.9490109892065),c(219.51673912807902,55.000443309504035,148.62829678199557,648.72548625379,8.306864487785312,230.97757178309527),c(384.1542934741383,147.06640276236948,182.8076263555555,29.719099501155302,12.460296731677968,2327.0128500535716),c(280.0730809565146,22.71757441044732,66.28718462751021,99.34670404671915,20.76716121946328,10.34227933357143))
targetgene="V10I"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(45.417256371326694,60.181644490834124,39.35801587258419,80.66612721742153,16.613728975570623,20.68455866714286),c(100.29644115334645,35.072746458234455,91.14487886282654,0.8491171286044372,4.153432243892656,3.44742644452381),c(47.3096420534653,16.340711418041053,23.821956975511483,33.115568015573054,0.0,1.1491421481746034),c(39.74009932491086,61.77586023893569,29.00064327453572,4.245585643022186,1221.1090797044408,3.44742644452381),c(7.569542728554449,11.558064173736355,15.018190267170283,0.0,0.0,3.44742644452381),c(107.8659838819009,76.12380197184979,88.55553571331443,4.245585643022186,8.306864487785312,643.5196029777779),c(96.51166978906923,53.00767362437708,140.8602673334592,0.0,4.153432243892656,9.193137185396827),c(162.74516866392065,101.63125394147484,108.75241227950895,2.547351385813312,4.153432243892656,4.5965685926984134),c(81.37258433196033,65.76139960918961,174.0038596472143,602.8731613091504,74.7617803900678,873.3480326126986),c(13.246699774970285,19.130588977218792,4.660817669121812,4.245585643022186,0.0,9.193137185396827),c(71.91065592126726,22.71757441044732,56.44768065936417,0.8491171286044372,0.0,5.745710740873017),c(247.9025243601582,169.7839771728168,291.5600386350645,4.245585643022186,0.0,1.1491421481746034),c(43.524870689188084,30.290099213929757,10.875241227950895,12.736756929066559,0.0,9.193137185396827),c(414.4324643883561,388.59008859975677,402.9017940640855,11.038522671857685,33.22745795114125,16.08799007444445),c(117.32791229259396,149.85628032154722,178.6646773163361,5.094702771626624,1113.1198413632317,4.5965685926984134),c(13.246699774970285,16.739265355066443,14.50032163726786,39.05938791580411,0.0,17.23713222261905),c(367.12282233489077,137.50110827376008,350.59706244394073,17.83145970069318,8.306864487785312,2.2982842963492067),c(62.4487275105742,35.471300395259846,37.80440998287692,226.71427333738472,236.7456379018814,131.0022048919048),c(96.51166978906923,100.03703819337328,134.1279751447277,0.0,1138.0404348265877,1.1491421481746034),c(563.9309332773064,260.2557208775807,399.794582284671,49.24879345905736,49.84118692671187,16.08799007444445),c(56.771570464158366,35.471300395259846,43.50096491180358,703.068982484474,20.76716121946328,10.34227933357143))
targetgene="L111V"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(22.708628185663347,5.18120118133009,12.428847117658165,3.396468514417749,0.0,0.0),c(616.9177323771876,214.02346418263525,278.09545425760143,2.547351385813312,465.18441131597746,16.08799007444445),c(0.0,0.0,0.0,0.0,0.0,0.0),c(22.708628185663347,28.695883465828192,18.125402046584824,0.0,178.5975864873842,1.1491421481746034),c(225.19389617449485,196.88564489054343,148.62829678199557,5.943819900231061,4.153432243892656,1.1491421481746034),c(851.5735569623755,526.4897508105422,481.6178258092539,1074.9822848132176,41.53432243892656,16.08799007444445),c(1.8923856821386122,1.9927696851269578,1.5536058897072706,0.0,0.0,0.0),c(20.816242503524734,10.36240236266018,12.428847117658165,0.0,0.0,0.0),c(603.6710326022173,220.7988811120669,413.77703529203643,50.947027716266234,41.53432243892656,1627.1852818152383),c(20.816242503524734,7.572524803482439,8.8037667083412,0.0,4.153432243892656,3.44742644452381),c(0.0,0.0,0.5178686299024235,0.0,0.0,0.0),c(51.09441341774253,58.587428742732556,52.8226002500472,1.6982342572088744,8.306864487785312,20.68455866714286),c(1580.1420445857411,524.8955350624407,1244.9561862854262,1867.2085658011574,157.83042526792093,49.41311237150794),c(669.9045314770688,86.88475827153536,107.7166750197041,0.8491171286044372,12.460296731677968,1.1491421481746034),c(200.5928823066929,51.8120118133009,93.73422201233866,3.396468514417749,16.613728975570623,2.2982842963492067),c(1.8923856821386122,3.1884314962031324,1.5536058897072706,0.0,0.0,0.0),c(34.06294227849502,45.03659488386924,33.14359231375511,0.0,128.75639956067232,1.1491421481746034),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,0.0,0.0,0.0,0.0),c(3.7847713642772245,1.1956618110761745,1.035737259804847,11.887639800462122,0.0,9.193137185396827),c(70.01827023912865,74.52958622374823,93.73422201233866,1.6982342572088744,0.0,466.55171215888896),c(145.71369752467314,72.13826260159587,173.4859910173119,234.35632749482468,2492.0593463355935,14.938847926269844),c(0.0,15.942157481015663,5.1786862990242355,0.0,0.0,0.0),c(132.46699774970287,79.31223346805292,147.5925595221907,1.6982342572088744,1540.9233624841754,2240.8271889404764),c(0.0,0.0,2.5893431495121177,0.8491171286044372,0.0,0.0),c(158.96039729964343,227.97285197852398,187.98631265457976,8.491171286044372,53.99461917060452,8030.205331444128),c(113.54314092831673,98.44282244527172,175.03959690701916,2.547351385813312,0.0,24.13198511166667),c(62.4487275105742,40.253947639564544,41.429490392193884,5.943819900231061,0.0,185.01188585611115),c(28.385785232079183,13.550833858863312,22.268351085804213,0.0,0.0,1.1491421481746034),c(0.0,1.9927696851269578,3.625080409316965,0.0,0.0,0.0))
targetgene="R158AfsTer12"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1.8923856821386122,0.39855393702539155,0.5178686299024235,2.547351385813312,0.0,0.0),c(3.7847713642772245,0.39855393702539155,1.035737259804847,0.0,0.0,1.1491421481746034),c(7.569542728554449,7.173970866457048,3.625080409316965,0.0,0.0,0.0),c(1.8923856821386122,0.39855393702539155,2.071474519609694,5.943819900231061,4.153432243892656,0.0),c(1.8923856821386122,0.39855393702539155,0.5178686299024235,0.0,0.0,1.1491421481746034),c(17.03147113924751,3.1884314962031324,10.357372598048471,10.189405543253248,0.0,0.0),c(187.3461825317226,47.0293645689962,72.5016081863393,1.6982342572088744,0.0,4.5965685926984134),c(240.33298163160376,119.56618110761747,122.73486528687438,61.98555038812392,1030.0511964853786,1.1491421481746034),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,0.0,0.0,0.0,0.0),c(83.26497001409894,30.290099213929757,36.25080409316965,3.396468514417749,4.153432243892656,1.1491421481746034),c(0.0,1.1956618110761745,1.5536058897072706,0.8491171286044372,0.0,0.0),c(79.48019864982172,35.072746458234455,39.87588450248661,6.792937028835498,33.22745795114125,41.36911733428572),c(0.0,0.0,0.0,0.0,0.0,0.0),c(1.8923856821386122,1.1956618110761745,2.071474519609694,1.6982342572088744,0.0,0.0),c(1.8923856821386122,0.39855393702539155,3.625080409316965,0.8491171286044372,0.0,0.0),c(0.0,0.0,0.0,0.0,0.0,1.1491421481746034),c(5.677157046415837,2.391323622152349,7.25016081863393,1.6982342572088744,33.22745795114125,11.491421481746034),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,0.0,0.0,0.0,0.0),c(18.923856821386124,27.101667717726624,17.089664786779977,2.547351385813312,0.0,22.982842963492068),c(49.20202773560392,39.85539370253915,55.92981202946174,37.361153658595235,4.153432243892656,0.0),c(24.60101386780196,5.579755118355481,9.839503968146047,39.90850504440855,0.0,0.0),c(100.29644115334645,72.53681653862127,104.60946324028956,747.2230731719047,16.613728975570623,2.2982842963492067),c(98.40405547120784,60.978752364884905,52.30473162014478,191.9004710646028,24.920593463355935,34.4742644452381),c(3.7847713642772245,2.7898775591777407,2.071474519609694,0.0,0.0,3.44742644452381),c(149.49846888895036,172.57385473199454,261.5236581007239,0.8491171286044372,49.84118692671187,14.938847926269844),c(677.4740742056232,182.13914922060394,454.6886570543279,45.00320781603517,253.359366877452,3880.6530343856357),c(35.95532796063363,27.898775591777408,60.07276106868113,0.0,0.0,1.1491421481746034),c(259.2568384529899,90.07318976773848,150.69977130160527,5.943819900231061,20.76716121946328,10.34227933357143),c(3.7847713642772245,1.9927696851269578,0.0,19.529693957902055,0.0,0.0),c(9.461928410693062,5.579755118355481,9.839503968146047,5.094702771626624,0.0,0.0),c(22.708628185663347,15.54360354399027,10.875241227950895,0.0,8.306864487785312,194.20502304150796),c(35.95532796063363,22.71757441044732,20.19687656619452,0.0,0.0,0.0),c(9.461928410693062,12.75372598481253,8.8037667083412,15.28410831487987,0.0,63.20281814960318),c(166.52994002819787,69.74693897944353,110.30601816921622,5.094702771626624,29.07402570724859,1703.0286635947623),c(446.6030209847125,172.57385473199454,193.6828675835064,1.6982342572088744,4.153432243892656,39.07083303793652),c(28.385785232079183,11.558064173736355,11.393109857853318,25.473513858133117,0.0,3.44742644452381),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,0.0,0.0,0.0,0.0),c(20.816242503524734,16.340711418041053,16.571796156877554,0.8491171286044372,0.0,33.325122297063494),c(73.80304160340587,87.68186614558614,52.8226002500472,23.775279600924243,0.0,237.8724246721429),c(20.816242503524734,1.5942157481015662,14.50032163726786,0.0,4.153432243892656,2.2982842963492067),c(60.55634182843559,29.492991339878973,21.232613825999366,5.094702771626624,4.153432243892656,18.386274370793654),c(70.01827023912865,27.101667717726624,22.268351085804213,0.0,4.153432243892656,2.2982842963492067),c(0.0,1.1956618110761745,0.0,0.0,0.0,0.0),c(5.677157046415837,7.971078740507831,10.357372598048471,0.0,0.0,0.0),c(0.0,0.0,0.0,0.0,4.153432243892656,0.0),c(0.0,0.0,0.0,0.0,4.153432243892656,0.0),c(128.68222638542562,64.96429173513883,145.521085002581,2.547351385813312,49.84118692671187,265.4518362283334),c(94.6192841069306,53.00767362437708,164.16435567906825,7.642054157439935,4.153432243892656,6.89485288904762),c(77.5878129676831,46.23225669494542,29.518511904438142,10.189405543253248,0.0,0.0),c(1065.4131390440386,569.9321299463099,943.0387750523133,3585.821634096538,440.2638178526215,2325.8637079053974),c(251.68729572443542,120.76184291869365,147.0746908922883,9.340288414648809,33.22745795114125,52.860538816031756),c(7.569542728554449,8.768186614558614,6.732292188731506,0.8491171286044372,20.76716121946328,31.026838000714292),c(15.139085457108898,7.173970866457048,8.8037667083412,3.396468514417749,41.53432243892656,21.833700815317464),c(739.9228017161973,438.0107767909053,443.29554719647456,321.8153917410817,58.14805141449718,10.34227933357143),c(37.84771364277225,5.18120118133009,20.19687656619452,4.245585643022186,0.0,24.13198511166667))
targetgene="G154AfsTer16"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(34.06294227849502,0.7971078740507831,7.768029448536353,0.0,141.2166962923503,0.0),c(707.752245119841,284.5675110361296,242.88038742423663,4.245585643022186,0.0,3780.677667494445),c(0.0,1.5942157481015662,0.0,0.0,0.0,0.0),c(181.66902548530678,120.76184291869365,126.87781432609377,2.547351385813312,8.306864487785312,484.93798652968263),c(71.91065592126726,71.73970866457047,106.68093775989925,0.0,0.0,2.2982842963492067),c(43.524870689188084,27.500221654752018,27.96490601473087,0.8491171286044372,0.0,0.0),c(384.1542934741383,251.48753426302207,210.7725323702864,3.396468514417749,8.306864487785312,18.386274370793654),c(0.0,0.0,1.035737259804847,0.0,0.0,0.0),c(164.63755434605926,57.790320868681775,101.50225146087502,320.96627461247726,0.0,14.938847926269844),c(902.667970380118,237.13959253010796,446.92062760579154,5.943819900231061,8.306864487785312,228.67928748674606),c(126.78984070328703,9.565294488609396,53.340468879949626,0.8491171286044372,477.6447080476554,13.78970577809524),c(261.14922413512846,99.2399303193225,175.5574655369216,2.547351385813312,2712.191255261904,9.193137185396827),c(83.26497001409894,23.11612834747271,39.87588450248661,0.8491171286044372,0.0,2.2982842963492067),c(493.9126630381778,68.55127716836735,221.64777359823728,1.6982342572088744,4.153432243892656,1.1491421481746034),c(128.68222638542562,45.83370275792003,49.19751984073024,2.547351385813312,4.153432243892656,48.26397022333334),c(592.3167185093856,94.85583701204318,193.16499895360397,0.8491171286044372,4.153432243892656,10.34227933357143),c(34.06294227849502,1.9927696851269578,6.214423558829083,0.0,0.0,6.89485288904762),c(123.0050693390098,100.43559213039867,91.14487886282654,2.547351385813312,4.153432243892656,3.44742644452381),c(1.8923856821386122,0.0,1.035737259804847,0.0,0.0,0.0),c(35.95532796063363,87.28331220856074,62.144235588290826,104.44140681834578,62.30148365838984,68.9485288904762),c(28.385785232079183,43.44237913576768,32.10785505395026,155.388434534612,24.920593463355935,24.13198511166667),c(30.278170914217796,72.13826260159587,61.6263669583884,156.23755166321644,369.65546970644635,72.39595533500001),c(15.139085457108898,54.601889372478645,39.35801587258419,67.92937028835497,0.0,25.281127259841274),c(15.139085457108898,15.942157481015663,9.321635338243624,20.378811086506495,8.306864487785312,11.491421481746034),c(476.8811918989303,591.8525964827064,547.9050104367641,1269.4301072636335,1117.2732736071243,889.436022687143),c(488.23550599176195,585.0771795532748,544.7977986573496,687.7848741695941,1079.8923834120906,299.92610067357145),c(68.12588455699004,107.21100905983033,95.80569653194836,80.66612721742153,53.99461917060452,148.23933711452383),c(306.5664805064552,259.4586130035299,300.36380534340566,906.0079762209346,240.89907014577403,51.71139666785715),c(41.63248500704947,8.369632677533222,28.482774644633295,2.547351385813312,4.153432243892656,0.0),c(454.1725637132669,183.33481103168012,260.48792084091906,9.340288414648809,8.306864487785312,449.3145799362699))
targetgene="E298Q"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(2418.4689017731466,671.1648299507593,777.8386821134402,550.2278993356754,66.4549159022825,26.430269408015878),c(115.43552661045534,82.89921890128144,69.91226503682718,10.189405543253248,12.460296731677968,188.45931230063496),c(1530.9400168501372,1103.1972976862837,1001.5579302312872,2099.8666590387734,32405.078366850503,103.4227933357143),c(1065.4131390440386,363.8797445041825,449.50997075530364,23.775279600924243,5087.954498768503,3.44742644452381),c(145.71369752467314,145.8707409512933,153.28911445111737,2.547351385813312,1590.7645494108872,6.89485288904762),c(105.97359819976228,141.486647644014,95.28782790204593,63.68378464533279,37.3808901950339,3.44742644452381),c(526.0832196345342,156.63169725097887,196.27221073301854,11.038522671857685,240.89907014577403,14.938847926269844),c(1177.063894290217,582.2873019940971,747.2844329491971,154.53931740600757,58.14805141449718,4469.013814251032),c(15.139085457108898,2.391323622152349,7.25016081863393,0.0,0.0,0.0),c(18.923856821386124,0.7971078740507831,2.071474519609694,60.287316130915045,0.0,0.0),c(588.5319471451085,489.4242346671808,377.00836256896434,24.62439672952868,16.613728975570623,42.51825948246032),c(1267.8984070328702,343.9520476529129,370.79393901013526,1781.4477358121094,74.7617803900678,8.043995037222224),c(457.95733507754414,63.370075987037254,138.2709241839471,1.6982342572088744,74.7617803900678,26.430269408015878),c(633.9492035164351,354.71300395259846,448.99210212540123,129.06580354787445,207.6716121946328,2652.2200779869845),c(217.62435344594041,235.5453767820064,218.54056181882274,632.5922608103057,1254.336537655582,10.34227933357143),c(160.85278298178204,125.54449016299834,87.51979845350958,215.67575066552706,4.153432243892656,16.08799007444445),c(30.278170914217796,22.71757441044732,25.375562865218754,0.8491171286044372,4.153432243892656,11.491421481746034),c(842.1116285516824,298.91545276904367,300.88167397330807,5.094702771626624,58.14805141449718,13.78970577809524),c(325.4903373278413,59.38453661678334,74.57308270594899,3.396468514417749,0.0,113.76507266928573),c(1072.9826817725932,573.9176693165638,566.5482811132514,5.943819900231061,1158.807596046051,5636.542236796429),c(976.4710119835239,200.07407638674655,380.1155743483789,2284.9741930745404,353.04174073087574,620.5367600142858),c(255.47206708871266,167.79120748768983,160.5392752697513,101.89405543253247,685.3163202422883,305.6718114144445),c(4129.185558426452,2264.1849162412495,1950.8111288424295,1646.4381123640037,2064.25582521465,1981.1210634530162),c(213.8395820816632,244.31356339656503,107.19880638980167,1755.9742219539762,0.0,10.34227933357143),c(174.09948275675234,115.18208780033815,57.483417919169014,0.8491171286044372,0.0,0.0),c(548.7918478201975,237.93670040415876,266.70234439974814,0.8491171286044372,639.628565559469,21.833700815317464),c(616.9177323771876,217.2118956788384,233.0408834560906,5.094702771626624,207.6716121946328,71.2468131868254),c(2104.332878538137,923.8480260248576,858.1083197483158,737.0336676286515,257.51279912134464,242.46899326484132),c(121.11268365687118,100.03703819337328,94.76995927214351,1.6982342572088744,12.460296731677968,2.2982842963492067),c(1135.4314092831673,363.0826366301317,647.8536560079318,523.0561512203333,739.3109394128927,382.6643353421429))
targetgene="P301S"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(7.569542728554449,4.384093307279307,2.071474519609694,27.17174811534199,0.0,6.89485288904762),c(1.8923856821386122,4.384093307279307,0.5178686299024235,0.0,0.0,1.1491421481746034),c(88.94212706051478,72.13826260159587,74.57308270594899,374.4606537145568,8.306864487785312,40.21997518611112),c(105.97359819976228,112.79076417818581,120.14552213736226,1.6982342572088744,95.52894160953109,1.1491421481746034),c(100.29644115334645,57.790320868681775,92.69848475253382,192.74958819320725,8.306864487785312,937.6999929104763),c(34.06294227849502,12.75372598481253,48.16178258092539,0.0,0.0,0.0),c(3.7847713642772245,7.572524803482439,7.768029448536353,6.792937028835498,4.153432243892656,9.193137185396827),c(149.49846888895036,112.79076417818581,61.10849832848598,24.62439672952868,58.14805141449718,58.60624955690477),c(263.0416098172671,185.32758071680706,191.09352443399428,48.39967633045292,4.153432243892656,4.5965685926984134),c(81.37258433196033,83.69632677533222,55.92981202946174,32.26645088696861,8.306864487785312,3.44742644452381),c(13.246699774970285,19.927696851269577,60.590629698583555,776.0930555444556,4.153432243892656,1.1491421481746034),c(3.7847713642772245,10.36240236266018,2.071474519609694,0.8491171286044372,0.0,1.1491421481746034),c(7.569542728554449,0.39855393702539155,2.071474519609694,30.56821662975974,0.0,0.0),c(43.524870689188084,74.13103228672283,62.66210421819325,4.245585643022186,8.306864487785312,939.9982772068256),c(43.524870689188084,32.282868899056716,36.25080409316965,0.0,0.0,17.23713222261905),c(5.677157046415837,3.586985433228524,3.1072117794145413,1.6982342572088744,0.0,4.5965685926984134),c(166.52994002819787,179.74782559845158,122.21699665697196,1.6982342572088744,4.153432243892656,913.5680077988096),c(157.06801161750482,78.11657165697675,135.68158103443497,44.15409068743074,8.306864487785312,2225.8883410142066),c(22.708628185663347,56.5946590576056,20.714745196096942,318.41892322666394,16.613728975570623,18.386274370793654),c(105.97359819976228,78.51512559400213,98.9129083113629,3.396468514417749,45.68775468281922,6.89485288904762),c(11.354314092831673,18.333481103168012,12.946715747560589,0.0,0.0,16.08799007444445),c(88.94212706051478,24.311790158548884,42.983096281901155,5.943819900231061,0.0,27.57941155619048),c(52.98679909988114,61.77586023893569,178.1468086864337,5.943819900231061,12.460296731677968,1.1491421481746034),c(0.0,3.1884314962031324,2.5893431495121177,0.0,0.0,2.2982842963492067),c(68.12588455699004,70.54404685349431,64.73357873780294,45.85232494463961,29.07402570724859,11.491421481746034),c(66.23349887485143,43.84093307279307,47.12604532112054,59.438199002310604,12.460296731677968,4.5965685926984134),c(62.4487275105742,29.492991339878973,36.76867272307207,21.227928215110932,8.306864487785312,26.430269408015878),c(22.708628185663347,18.732035040193402,16.571796156877554,23.775279600924243,4.153432243892656,2.2982842963492067),c(124.8974550211484,76.12380197184979,74.05521407604657,182.56018264995402,12.460296731677968,3.44742644452381))
targetgene="L114FfsTer35"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(155.1756259353662,17.934927166142618,69.39439640692476,257.2824899671445,0.0,0.0),c(3.7847713642772245,15.145049606964879,9.839503968146047,0.0,4.153432243892656,9.193137185396827),c(26.49339954994057,12.355172047787137,28.482774644633295,0.0,16.613728975570623,0.0),c(1197.8801367937415,357.1043275747508,215.4333500394082,1867.2085658011574,120.44953507288702,243.61813541301592),c(105.97359819976228,37.464070080386804,19.679007936292095,14.434991186275433,357.1951729747684,1.1491421481746034),c(111.65075524617812,79.31223346805292,127.3956829559962,13.585874057670996,66.4549159022825,95.37879829849209),c(1057.8435963154843,480.6560480526222,969.4500751773369,174.06901136390962,1420.4738274112883,2408.6019425739687),c(24.60101386780196,30.290099213929757,38.840147242681766,4.245585643022186,4.153432243892656,158.58161644809528),c(471.20403485251444,326.0171204867703,390.9908155763298,39.05938791580411,4.153432243892656,19.53541651896826),c(5.677157046415837,5.18120118133009,6.732292188731506,3.396468514417749,0.0,10.34227933357143),c(9.461928410693062,6.775416929431656,12.946715747560589,0.0,0.0,1.1491421481746034),c(281.9654666386532,51.8120118133009,258.41644632130937,0.0,4.153432243892656,17.23713222261905),c(280.0730809565146,129.13147559622686,394.6158959856467,1.6982342572088744,8.306864487785312,9.193137185396827),c(104.08121251762367,209.63937087535595,134.1279751447277,30.56821662975974,4.153432243892656,1.1491421481746034),c(13.246699774970285,3.586985433228524,24.85769423531633,159.6340201776342,0.0,0.0),c(49.20202773560392,51.41345787627551,93.21635338243624,0.0,0.0,12.640563629920637),c(9.461928410693062,9.166740551584006,9.321635338243624,0.0,0.0,4.5965685926984134),c(227.08628185663346,234.34971497093022,154.84272034082466,2.547351385813312,4.153432243892656,251.66213045023812),c(143.82131184253453,154.63892756585193,118.59191624765499,0.0,0.0,1.1491421481746034),c(9.461928410693062,25.50745196962506,8.285898078438777,0.8491171286044372,53.99461917060452,1.1491421481746034),c(1.8923856821386122,0.39855393702539155,1.035737259804847,0.0,8.306864487785312,0.0),c(13.246699774970285,1.9927696851269578,7.25016081863393,0.0,0.0,0.0),c(9647.382207542645,6585.70525540757,9765.966622699903,13193.581944255746,30033.468555587795,15913.320467921907),c(1440.105504107484,958.920772483092,1315.3863199521559,2386.868248507073,4664.304409891452,689.485288904762),c(3429.002856035165,2544.7668879071252,3297.787435218633,4321.157067467981,5960.175269985961,8291.060599079763),c(58.66395614629698,25.50745196962506,65.25144736770537,398.2359333154811,4.153432243892656,2.2982842963492067),c(861.0354853730686,428.0469283652705,658.2110286059803,225.01603908017586,253.359366877452,2278.7488798302384),c(410.6476930240789,106.81245512280493,268.77381891935784,34.81380227278193,70.60834814617515,12.640563629920637),c(22.708628185663347,19.130588977218792,23.821956975511483,19.529693957902055,4.153432243892656,12.640563629920637),c(155.1756259353662,130.32713740730304,160.02140663984886,325.21186025549946,141.2166962923503,94.22965615031748))
targetgene="R158_A159insP"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=9
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("G244A","G244R","E271_V272insQL*","G245A","G244NfsTer390","F270C","G245R","F270S","I254_I255insH","G244S")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='D25-NUT-REP1,D25-NUT-REP2,D25-NUT-REP3_vs_D4-REP1,D4-REP2,D4-REP3 pos.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(4539.833251450531,4836.452025803126,6866.938032506137,48599.21885567497,47959.6821202285,34313.38454449366),c(6161.607781043322,6902.15708140573,7895.4251314923495,41126.98812395592,45455.162477161226,24636.458514715323),c(5758.5296307477975,5104.280271484189,5599.713495134906,38342.73305926197,39042.26309259096,37875.725203834925),c(4261.652556176155,3597.3478355911843,3438.12983392219,26132.42874993016,22723.42780633672,18149.551088269687),c(4034.566274319521,4153.330577741605,5014.5219433451675,30874.747913185944,26411.6756389134,17988.67118752524),c(2603.9226986227304,2453.099482391285,2654.5945968798233,15711.214230567903,10491.569848072848,5992.776302730556),c(5499.272792294807,5819.6845884447675,5641.660854157002,22234.132012507187,24268.50460106479,11524.746604043097),c(2651.2323406761957,2511.288357196992,2092.189264805791,5486.994885041873,8119.960036810142,3002.7084331802384),c(8767.422865348191,8544.996409824395,10157.475306906135,65957.72031573548,129408.48842296348,76800.61718895327),c(654.7654460199599,739.3175531821013,726.0518191231978,6590.847152227641,4265.574914477757,3691.044579936826),c(1373.8720052326325,1520.0847158148433,1899.0242658521872,16558.63312491513,14645.002091965505,13856.356022689368),c(1269.7907927150088,1324.394732735376,1683.0730471828765,10658.118198242895,19139.015779857356,9635.55691244405),c(1591.496358678573,1171.7485748546512,1120.6677151088445,5044.604861038962,8281.943894321956,3962.2421269060324),c(963.2243122085537,951.746801616635,1113.935422920113,7876.41048493476,10204.983023244255,6145.6122084377785),c(1186.5258227009099,1290.1190941511925,1659.7689588372675,16072.089010224789,28156.117181348312,15843.222796883256),c(1426.8588043325137,1002.7617055558851,865.3584805669498,3095.0319337631736,3434.8884656992263,1097.4307515067462),c(1742.887213249662,1198.053134698327,1087.006254165187,6494.89691669534,10911.066504706007,6120.331081177937),c(1339.8090629541375,1521.6789315629449,2031.5986351072077,16180.776002686156,26743.950218424812,18318.47498405135),c(5117.010884502807,7162.811356220337,7477.505147161093,11793.387799187029,23512.579932676326,12516.45627791778),c(794.8019864982172,848.1227779900332,708.9621543364178,1607.3787244481996,3758.8561807228534,1931.7079510815083),c(6619.565116120865,7488.429922770082,9512.210994047717,22444.71306040109,37090.14993796142,24836.4092484977),c(1241.4050074829297,1033.4503587068402,1001.5579302312872,1357.738288638495,2184.705360287537,1083.641045728651),c(4278.684027315402,4461.811324999258,4457.295297570159,6343.75406780375,15824.576849231018,11021.422343142622),c(7177.818892351756,7155.238831416855,7132.60463964608,12722.321937880282,32205.713619143655,20034.144211276034),c(6559.00877429243,6111.82462428438,6209.762741159961,17031.591365547803,27840.45633081247,22094.5560829531),c(10497.063378822882,10244.82895123769,12141.947896692223,58263.020896322065,106278.02425672527,73794.46132932851),c(9846.0827041672,10488.74396069723,10629.771497377145,32117.006272334234,50991.68765827014,39492.568206316595),c(9270.797456797061,11562.448267043634,12386.89975863607,22140.7291283607,54621.787439432315,45470.40566112088),c(976.4710119835239,1084.066708709065,986.5397399641168,1181.9710430173766,1553.3836592158532,1122.7118787665875),c(4774.489076035718,5618.016296309919,5623.017583480515,14997.10672541157,11621.303418411651,15775.423410140955))
targetgene="G244A"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(5033.745914488709,5869.105276635916,9139.863449147873,21694.093518714766,33626.18744655494,17926.61751152381),c(8952.876662197774,9178.298615757742,11170.944215625179,43307.52091021211,38028.825625081154,23360.91073024151),c(10239.698926052031,9670.114174047076,10169.386285393892,32281.734995283496,41052.52429863501,28966.426129037227),c(5349.774323405857,4073.221236399502,4545.332964653571,13555.305841041236,17423.648263129693,11152.424548034525),c(4990.221043799521,4788.226999423054,5792.87849408851,9029.511545579586,24160.515362723578,13305.916933713732),c(3239.764287821304,2971.219600524294,3184.892073899905,6548.39129579742,6595.650403301537,4462.1189613619845),c(5018.6068290316,5172.831548652557,4894.894289837707,22414.993960899934,22100.412969752822,12429.12147465651),c(5126.472812913501,4484.528899409705,4427.258917035819,12212.85166071762,7654.775625494165,3238.2825735560323),c(10691.979104083159,10435.736287072852,12455.258417783189,53896.860621038046,76659.89892552675,60104.73091812446),c(1061.6283676797614,1286.5321087179639,1508.0334502758574,18351.968500527702,16476.665711522164,10268.734236088256),c(1966.188723742018,2213.170012301999,3127.9265246106384,36372.781320899674,57408.74047508429,24940.981183981592),c(1339.8090629541375,1673.1294276325937,2083.9033667273525,22601.79972919291,27533.102344764415,22882.867596600878),c(1667.1917859641173,1491.7873862860406,1425.6923381213721,9481.241857997145,8173.954655980747,4113.92889046508),c(1322.77759181489,1348.3079689568997,1990.1691447150138,18476.788718432555,19201.31726351575,13365.672325418811),c(2959.6912068647894,2523.244975307754,3678.4208781969146,23520.54446234291,56710.96385811032,37566.605965975956),c(1398.4730191004344,1399.3228728961496,1080.791830606358,7192.0220792795835,4577.082332769707,8314.043442043256),c(2948.336892771958,2388.5337445931714,2519.948753105193,11112.395862046269,29734.421434027525,7684.313544843572),c(1619.882143910652,1888.3485536263051,2551.020870899338,16111.148398140593,65678.22407267457,30081.094012766593),c(6220.271737189619,8339.741132256318,10355.818992158764,26963.714418833904,13577.570005285092,18265.614445235322),c(1023.7806540369892,844.1372386197793,875.7158531649982,1313.5841979510644,3995.6018186247347,914.7171499469843),c(9047.495946304705,9624.280471289156,13693.482311879883,17134.33453810894,57329.82526245033,40918.65361220128),c(1423.0740329682365,1371.8226512413978,1136.7216426358198,1445.1973528847523,1661.3728975570623,681.4412938675398),c(6464.389490185499,5582.544995914659,6281.746480716398,16252.950958617534,24903.979734380366,5651.481084722699),c(5749.067702337104,5963.164005773909,5849.844043377776,14332.248013714296,15737.354772109273,6013.4608613977),c(12379.987132550801,11636.977853267383,14260.030592993135,63284.699594888705,151670.8852502281,94180.24303794597),c(6358.415891985737,5837.220961673885,5515.300908460811,16415.13233018098,22262.396827264634,17809.405012410003),c(8839.333521269458,8434.596969268361,8993.82449551539,41647.49692379044,56146.097072940924,24491.66660404532),c(11556.799360820505,12682.78338402201,14491.000001929615,54576.1543239216,120349.8526990336,101542.79678130065),c(1892.3856821386123,1995.1610087491101,1791.8254594623854,4555.513394962805,14051.061281088854,5151.604250266747),c(9278.366999525615,8734.708083848482,10073.062720232041,26258.947202092222,36479.595398109195,58385.614264455246))
targetgene="G244R"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3614.4566528847495,1428.018756361978,3218.03566621366,25223.02430519481,142209.36659864066,36485.263204543655),c(1663.40701459984,875.6229996447852,1392.0308771777145,2480.271132653561,31715.60861436432,11967.166331090319),c(1502.554231618058,742.5059846783045,1080.2739619764554,7397.508424401857,40167.843230685874,8160.0583941878585),c(3449.81909853869,1212.0025224942158,2707.41719712987,54907.31000407733,126355.71572370238,70048.2579262793),c(2096.7633358095823,1544.3965059733923,1607.9820958470252,5993.9178108187225,60756.40686366177,13539.192789793176),c(2051.346079438256,1326.7860563575284,1563.4453936754167,7839.049331276165,29186.168377833692,18362.142385681986),c(2170.5663774129885,882.7969705112423,2064.7422274209625,14509.713493592622,130002.42923384013,46974.63273308144),c(327.38272300997994,223.98731260827006,406.5268744734025,1553.8843453461202,4884.436318817763,3596.8149237865086),c(435.24870689188083,259.8571669405553,480.58208854944905,2262.897147730825,12360.614357824545,6426.002892592382),c(7.569542728554449,39.05828582848837,27.96490601473087,43.3049735588263,4.153432243892656,34.4742644452381),c(22.708628185663347,76.52235590887517,54.894074769656896,149.44461463438094,58.14805141449718,129.8530627437302),c(70.01827023912865,233.95116103390484,146.03895363248344,253.0369043241223,132.909831804565,365.4272031195239),c(562.0385475951679,493.4097740374347,682.0329855814919,3522.1378494512055,16393.597066644314,4983.829496633255),c(1863.999896906533,817.4341248390781,1273.956829559962,39667.35577988489,185126.78197478346,35367.147894369766),c(461.74210644182136,372.6479311187411,450.02783938520605,3372.6932348168248,10117.76094612251,5096.4454271543655))
targetgene="E271_V272insQL*"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(4106.4769302407885,3832.0961044991395,3897.997177275542,15665.361905623262,15263.86349630551,10067.634360157701),c(5764.206787794213,5213.085496292121,4255.326531908215,17328.782360559355,8365.012539199808,8169.251531373256),c(5607.138776176708,5356.564913621262,4921.305589962731,25390.300379529883,20796.235245170526,13386.356884085955),c(6526.838217696074,6468.92895185913,9359.957616856404,67683.9754381883,102128.74544507652,64874.819975197235),c(5504.949949341223,4694.965378159112,5535.497785027005,33630.982112635946,54978.98261240708,16667.157717124446),c(8865.826920819398,8505.539570058882,9650.481918231662,42614.64133327089,53483.74700460573,32912.58026586881),c(2456.3166154159185,2192.0466536396534,2829.6341937868424,14675.291333670488,34681.15923650368,23041.44921304897),c(1761.811070071048,1262.6188724964404,1185.4012938466476,1958.9132156904366,2832.6407903347913,1730.6080751509526),c(1305.7461206756425,1027.4720496514594,1280.6891217486934,6186.66739901193,8900.805298661962,5274.5624601214295),c(2066.4851648953645,1261.0246567483389,1092.1849404642112,5104.892177169877,4494.013687891854,3992.119822758572),c(1939.6953241920776,1460.3016252610346,1873.6487029869684,3110.3160420780537,12888.100252798911,3503.7344097843657),c(2180.0283058236814,1766.7896028335608,2549.9851336395336,4852.7043899743585,22694.35378062947,6767.298110600239),c(1916.9866960064141,2037.4077260738015,2455.21517436739,8684.769991366184,10466.649254609492,6659.278748671826),c(1108.9380097332269,792.3252268064784,899.5378101405097,2664.529549560724,75289.26628504218,1474.349376108016),c(1625.559300957068,1010.3342303593676,807.8750626477807,2105.8104789390045,2379.916675750492,1049.1667812834128),c(6260.011836514529,8166.768723587298,9363.064828635817,67464.05410187975,101148.53543551784,33614.7061184035),c(11649.526259245296,13396.992039171511,16140.411588168834,46431.422826347836,74761.78039006781,24161.86280751921),c(912.1298987908111,872.0360142115567,851.8938961894868,1288.9598012215356,3613.486052186611,1206.5992555833336),c(919.6994415193656,952.1453555536604,663.3897149050046,2717.1748115341993,3040.312402529424,1230.7312406950002),c(6471.959032914054,6414.327062486652,5851.915517897386,15053.997573028068,37189.83231181484,10387.095877350239),c(6816.373227063281,6732.373104232914,7122.765135677933,33441.62899295716,38838.74491264023,20177.78697979786),c(7090.76915097338,5883.054664431805,5293.135266232671,16677.50952291975,17710.235087958285,13465.647692310002),c(7599.8208994686665,7313.863298352961,8557.261240507647,37803.54368259815,80871.4792208339,44628.084466508895),c(9637.920279131953,8257.639021229088,8451.616040007553,25708.719302756544,44890.29569199182,37117.29138603969),c(2689.080054318968,2646.796695785625,2400.8389682276356,4957.1457967927045,5424.382510523808,5372.239542716271),c(8619.816782141379,8959.093950393777,10349.604568599934,29339.54414466912,90029.7973186172,63091.35136123025),c(8500.596484166646,8622.31587360732,9033.182511387973,24289.84458085853,68556.55261769218,46578.1786919612))
targetgene="G245A"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(9936.917216909853,8850.68727952287,7932.711672845324,20923.94428307054,24538.47769691781,28607.893778806752),c(9408.94161159318,7980.6440349964405,9034.21824864778,26747.189551039774,64029.311471849185,25413.278606881355),c(5938.306270550966,3923.3649560779545,3619.9017230179406,7625.92093199645,16273.147531571425,7880.81685218143),c(9772.279662563793,7349.733152685246,7621.472626273968,18704.352108898544,55568.769991039844,24751.37272953278),c(8557.368054630804,6227.803819958768,5553.105318443688,12963.471202403944,19774.490913172933,9282.770272954445),c(8831.763978540903,7714.410005063479,8823.963584907395,21919.10955779494,53786.94755840989,32818.350609718495),c(1269.7907927150088,1146.241122885026,1282.760596268303,7532.518047849962,23309.061752725585,12028.070864943573),c(1074.8750674547318,1113.9582539859693,839.982917701731,12244.268994475984,11982.652023630311,3366.986494151588),c(1042.7045108583754,1113.559700048944,1358.8872848639594,13295.475999688279,20846.07643209724,8573.749567530716),c(953.7623837978606,1163.378942177118,890.7340434321685,2430.173222065899,4793.060809452125,4402.363569656905),c(832.6497001409894,841.3473610606015,959.0927025792885,3659.6948242851245,14923.282052306313,5042.43574619016),c(1188.4182083830485,1086.8565862682428,779.3922880031474,5550.678669687206,6034.937050376029,2087.9912832332543),c(9757.140577106684,10865.377431186223,10155.403832386526,29964.494351321984,62833.1229856081,31797.91238213945),c(8519.520340988032,8758.22276613298,8074.607677438588,16858.371471312497,29356.459099833293,23070.17776675334),c(1430.6435756967908,1184.900854776489,1004.6651420107016,1955.516747176019,5079.647634280718,2385.6190996104765),c(1112.722781097504,1165.3717118622449,746.2486956893923,1439.2535329845211,2051.795528482972,1653.6155512232542),c(9687.122306867555,9632.251550029663,8167.306162191122,21221.135278082096,40699.482557904135,35102.84520028961),c(9478.959881832308,9392.720633877403,7355.288150504121,9508.413606112488,33896.16054240797,16528.11151719532),c(758.8466585375835,1123.1249945375534,1104.095918951967,11619.318787823118,28966.036468907383,22997.781811418336),c(1735.3176705211074,1816.2102910247092,1851.8982205310667,12954.130913989295,51207.66613495255,25895.918309114688),c(1169.4943515616624,1151.0237701293308,1047.6482382926029,7246.365575510267,18877.349548492122,10197.48742290143))
targetgene="G244NfsTer390"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(348.1989655135047,814.2456933428749,501.296833745546,482.29852904732036,224.28534117020342,490.6836972705556),c(342.5218084670888,958.920772483092,619.3708813632986,1122.532844015066,415.3432243892656,551.5882311238096),c(861.0354853730686,1762.006955589256,1368.208920202203,2414.8891137510195,647.9354300472543,1694.9846685575399),c(3131.8983039394034,1274.9740445442276,1987.5798015655016,44617.70863964876,248454.16339741478,55839.11526410033),c(2293.571446751998,1332.365811475884,1693.430419780925,17006.966968818273,111482.27485832278,36712.79334988223),c(4299.500269818927,2161.7565544257236,3053.871310534592,22181.486750533713,83110.17920029204,33056.22303439064),c(4679.869791928788,1671.1366579474668,2648.380173320994,51690.00520379512,346695.2962622078,38198.63414747199),c(6426.541776542727,1471.4611354977455,3415.8614828363857,18446.220501802793,100708.27161766523,58854.464260910485),c(7588.466585375835,3163.3225981705327,5471.282074919105,19634.1353647204,225631.05321722463,41177.210595540564),c(5052.669771310095,1577.4764827464996,2905.7608823824985,44150.69421891632,226814.78140673405,39237.45864942183),c(3559.5774681027297,1556.353124084154,2575.3606965047525,22389.5204470418,115951.36795275127,47213.654299901755),c(1426.8588043325137,951.746801616635,1255.3135588834748,12392.864491981762,40275.83246902708,12999.095980151113),c(3270.042458735522,1471.4611354977455,2380.124223031539,16640.997486389762,70014.4073352985,23334.480460833496),c(3463.0657983136603,1437.5840508505873,2084.421235357255,17047.724590991285,67277.29548657325,15555.937259839606),c(6180.531637864708,2351.8667823868354,4497.689050702548,16894.88350784249,102805.75490083102,51198.87926977128),c(185.453796849584,406.52501576589935,276.02397973799174,736.1845505000471,261.6662313652373,171.2221800780159),c(972.6862406192467,2163.749324110851,1586.7494820210259,2760.4797850930254,1387.246369460147,2260.3626054594447),c(558.2537762308906,1272.1841669850498,879.8588022042176,1447.7447042705655,1403.8600984357176,1344.496313364286),c(1214.911607932989,2523.643529244779,2117.56482767101,1883.3417912446419,1611.5317106303505,3773.7828146053976),c(2005.928823066929,3409.628931252225,2991.727074946301,4034.1554779996814,3696.5546970644637,5569.891992202302),c(149.49846888895036,486.2358031709777,341.27542710569713,272.56659828202436,2384.0701079943847,472.29742289976195),c(319.81318028142545,709.8245618422224,480.58208854944905,1090.2663931280974,855.6070422418871,518.2631088267461),c(1118.3999381439198,1911.8632359108033,1844.6480597124328,1143.7607722301768,2363.302946774921,2630.386377171667),c(2656.9094977226114,5060.8378923484215,4120.162819503682,9250.281999016739,6483.507732716435,8357.71084367389),c(1275.4679497614247,2300.054770573535,1920.7747483080889,1524.1652458449648,3401.661007748085,1831.7325841903178),c(953.7623837978606,1796.681148110465,1633.8755273421464,981.5794006667294,411.1897921453729,3466.9618610427783),c(2314.3876892555227,3575.4273690547875,3270.858266463707,4080.8569200729253,2857.5613837981473,5371.090400568096),c(1169.4943515616624,2015.8858134744305,1795.4505398717024,1761.9180418542073,2292.694598628746,3534.76124778508),c(0.0,0.0,0.5178686299024235,0.0,0.0,0.0),c(410.6476930240789,1018.7038630369008,826.0004646943655,1169.23428608831,868.067338973565,2083.394714640556))
targetgene="F270C"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(2747.744010465265,2555.129290269785,2534.9669433723634,9093.195330224919,5794.037980230255,3902.486735200953),c(3071.341962110968,3241.4391698275094,2629.7369026445067,6824.354362593862,5121.181956719644,2289.09115916381),c(4197.311442983442,3913.4011076523198,4420.008756217185,11390.906280228526,14441.483912014764,12301.566696209129),c(4333.563212097422,4808.951804148374,6449.535916804783,38369.05569024871,37227.21320200987,25968.314264449687),c(4187.849514572749,4491.702870276163,5240.312665982624,18857.193192047343,39220.86067907835,12256.750152430319),c(3818.8343065557196,4075.6125600216537,4626.638339548252,17749.944456347155,16239.920073620284,4942.460379298969),c(1266.0060213507315,1348.706522893925,1633.3576587122438,6377.718752947928,5432.689375011594,3755.396540234604),c(1292.4994209006722,910.2971921659943,865.8763491968522,1402.7414964545303,3746.3958839911757,1233.0295249913495),c(959.4395408442764,816.6370169650273,966.3428633979223,2626.3192787735243,1079.8923834120906,1369.7774406241272),c(982.1481690299397,649.2443634143629,615.7458009539816,2333.3738694049935,1582.4576849231019,799.8029351295239),c(1759.9186843889095,1639.2523429854355,2142.4225219063264,11331.468081226214,15704.127314158131,6762.70154200754),c(1954.8344096491865,1778.347667007297,2326.783754151589,6687.6465048885475,10188.369294268685,6535.1713966689695),c(1248.974550211484,874.8258917707344,1263.081588332011,1947.874693018579,2392.3769724821695,2271.854026941191),c(847.7887855980982,822.2167720833828,1083.8990423857724,2318.089761090114,1831.6636195566612,603.2996277916668),c(968.9014692549695,662.7951972732261,535.9940319490083,2212.7992371431633,1408.0135306796103,214.88958170865084),c(7603.605670832944,9322.176587023909,11662.919414032482,38497.27237666798,50057.16540339429,21301.648000712623),c(8082.379248414013,8669.743792113342,11461.98638563034,25545.688814064495,36840.94400332786,14587.210428928414),c(851.5735569623755,543.2290161656086,686.1759346207112,1297.45097250758,1104.8129768754466,868.7514640200002),c(1001.0720258513259,931.8191047653654,719.8373955643688,1201.5007369752786,1225.2625119483334,1129.606731655635),c(5726.359074151441,6459.762211307546,5469.728469029397,26088.27465924273,14715.610440111679,11631.616823823335),c(7191.065592126726,6667.8073664348,6630.7899372706315,10858.509840593542,11882.96964977689,10772.058496988731),c(6716.076785909935,6240.158992006555,6085.474269983379,16041.520793595027,23932.076589309483,10027.41438497159),c(4889.924602646174,4296.012887196695,4221.147202334654,8657.598243250843,11480.0867221193,6196.174462957461),c(8018.0381352213,8317.422111782897,9434.530699562352,21760.324654745913,25319.32295876963,20979.888199223733),c(10514.09484996213,11469.983753653743,11130.550462492789,29683.436581753915,44902.755988723504,41788.55421836945),c(4978.866729706689,5601.277030954853,5124.310092884481,10743.02991110334,10279.744803634323,12910.612034741669),c(8523.30511235231,8874.600515744394,9459.388393797668,22879.461030246563,60075.243975663376,46303.53371854747),c(1421.1816472860978,1407.2939516366575,1417.9243086728357,2291.767130103376,2766.1858744325086,2458.0150549454765),c(9100.482745404586,9968.631072879094,12600.261634155868,21295.857585399284,61067.914281953716,48046.78235732834))
targetgene="G245R"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(162.74516866392065,347.9375870231668,239.25530701491968,916.1973817641878,74.7617803900678,361.97977667500004),c(338.7370371028116,672.759045698861,465.0460296523763,658.9148917970433,431.9569533648362,481.4905600851588),c(391.7238362026927,1200.8430122575048,908.3415768488509,2105.8104789390045,1129.7335703388023,1170.975848989921),c(2263.29327583778,796.7093201137577,1412.7456223738113,31167.693322554474,96197.6442007978,44314.36866005723),c(1890.4932964564737,1003.5588134299359,1501.301158087126,10911.155102567018,41687.999431950586,30911.92378589683),c(2159.2120633201566,1071.3129827242524,1499.229683567516,9591.627084715723,67443.43277632895,28284.984835169686),c(3832.08100633069,1397.3301032110228,2163.1372671024233,73139.5529894718,274276.05165769544,40054.498716773975),c(6577.932631113817,1845.7032823645882,4029.5358092707575,28947.25203125387,162386.74043947118,26053.350783414608),c(6507.914360874687,2703.391354843231,5043.0047179898,20587.693900143186,95935.97796943257,37871.128635242225),c(6343.276806528628,1879.978920948772,3748.851011863644,40213.33809357754,277918.6117355893,70865.29799363144),c(3239.764287821304,1689.4701390506348,2226.835108580421,9674.840563318958,168130.9372327747,18069.111137897464),c(1169.4943515616624,651.2371330994898,949.7710672410448,14799.262434446737,55709.986687332195,12022.325154202701),c(2988.0769920968687,1244.6839453302978,2279.6577088304684,12790.251308168637,34697.77296547925,21280.96344204548),c(1792.0892409852659,938.9930756318225,1375.9769496507395,13094.235240209026,56586.36089079354,16140.850613260478),c(2645.55518362978,1217.9808315495966,2044.5453508547682,6349.697887703982,44217.439668481216,18922.923753991192),c(83.26497001409894,221.9945429231431,149.14616541189798,416.91651014477867,207.6716121946328,54.00968096420636),c(836.4344715052666,1842.514850868385,1331.440247479131,1894.3803139164995,1262.6434021433674,2643.026940801588),c(480.6659632632075,1104.7915134343855,846.19734126056,3255.5150710694124,618.8614043400057,1084.7901878768255),c(734.2456446697815,1420.4462315584956,1229.937996018256,2398.7558883075353,1723.6743812154523,1888.0405494508734),c(1239.512621800791,2414.439750499822,1879.8631265457975,3623.1827877551336,2928.1697319443224,4131.166022687699),c(143.82131184253453,424.8584968690674,228.8979344168712,697.9742797128474,290.7402570724859,173.5204643743651),c(172.20709707461373,472.6849693121144,268.77381891935784,1193.0095656892343,315.66085053584186,401.0506097129366),c(1506.3390029823354,2742.8481946087445,2782.5081484657217,4336.441175782861,5137.795685695215,4601.165161291112),c(1298.176577947088,2083.639982768747,2054.9027234528166,3878.767043465069,5669.4350129134755,5371.090400568096),c(883.7441135587319,1645.6292059778416,1166.7580231701602,1755.9742219539762,1839.9704840444465,1011.2450903936509),c(685.0436169341776,1550.7733689657985,1394.1023516973241,1829.8474121425622,3879.3057157957405,3003.857575328413),c(2764.7754816045126,4381.303429720129,3925.962083290273,4973.279022236189,4016.3689798441983,8061.232169444843),c(900.7755846979794,1857.2613465383247,1674.2692804745354,1305.9421437936244,1943.806290141763,2733.8091705073816),c(0.0,1.1956618110761745,7.768029448536353,0.0,0.0,0.0),c(225.19389617449485,624.1354653817632,476.9570081401321,1119.1363755006482,307.3539860480565,1038.8245019498415))
targetgene="F270S"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(151.390854571089,251.48753426302207,180.2182832060434,1323.7736034943177,344.7348762430904,1267.5037894365876),c(73.80304160340587,92.06595945286544,67.32292188731506,301.4365806545752,170.2907219995989,59.755391705079376),c(357.6608939241977,300.5096685171452,132.05650062511802,31.417333758364176,269.97309585302264,40.21997518611112),c(7713.364040396984,8209.413994849016,9455.24544475845,153043.17302540655,245085.72984761783,158689.63581002367),c(908.3451274265338,925.0436878359337,1069.916589378407,24534.39031389661,37542.87405254572,25055.895398799054),c(283.85785232079184,358.6985433228524,450.02783938520605,13587.572291928205,10479.109551341171,6758.104973414843),c(4257.867784811878,10876.935495359961,13027.503253825367,182201.0061045543,359084.98464573955,290790.4205955834),c(4906.956073785422,10532.584893770023,11056.495248416742,85048.42071814903,156571.93529802145,101838.12631338152),c(2573.6445277085127,5416.348004175071,5379.619327426376,13602.00728311448,19342.533959808097,19916.931712162226),c(22.708628185663347,11.956618110761747,6.732292188731506,21.227928215110932,29.07402570724859,16.08799007444445),c(338.7370371028116,80.50789527912909,209.2189264805791,144.34991186275434,282.4333925847006,20.68455866714286),c(24.60101386780196,19.529142914244186,38.840147242681766,358.3274282710725,66.4549159022825,368.87462956404767),c(183.56141116744539,270.61812324024083,165.20009293887313,15012.39083372645,8900.805298661962,2628.0880928753177),c(149.49846888895036,132.7184610294554,180.7361518359458,635.9887293247235,519.179030486582,1314.6186175117462),c(32.170556596356406,22.319020473421926,22.268351085804213,43.3049735588263,103.8358060973164,13.78970577809524),c(4927.772316288946,12783.617530089434,15116.06743822184,364627.02824818884,816656.1546586618,544130.2985821564),c(5512.519492069778,9813.593591376217,11484.254736716144,105391.56888525415,196162.45144680626,178518.08357677647),c(3500.9135119564326,7366.870971977337,8122.769460019514,41648.346040919045,58193.73916918,66944.42498405969),c(37.84771364277225,17.934927166142618,12.946715747560589,16.982342572088744,74.7617803900678,40.21997518611112),c(556.361390548752,210.83503268643213,257.3807090615045,646.1781348679767,6504.274893935899,443.56886919539687),c(34.06294227849502,16.739265355066443,18.125402046584824,11.887639800462122,87.22207712174577,172.3713222261905),c(217.62435344594041,70.94260079051969,77.68029448536353,40.75762217301299,58.14805141449718,43.66740163063493),c(984.0405547120783,420.07584962476267,428.7952255592067,310.776869069224,382.11576643812435,265.4518362283334),c(1061.6283676797614,752.4698331039392,975.664498736166,259.82984135295777,4955.044666963939,802.1012194258732),c(9.461928410693062,11.159510236710963,16.05392752697513,27.17174811534199,4.153432243892656,34.4742644452381),c(3.7847713642772245,1.9927696851269578,2.5893431495121177,2.547351385813312,24.920593463355935,2.2982842963492067),c(242.22536731374237,120.36328898166825,133.09223788492284,354.0818426280503,29.07402570724859,13.78970577809524))
targetgene="I254_I255insH"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(6555.224002928153,6896.9758802244005,8251.200880235314,22703.693784625444,25497.920545257013,10708.855678839129),c(8727.68276602328,7939.194425545799,9142.970660927287,19094.09687092798,28147.81031686053,15002.050744419446),c(9338.923341354051,9572.468459475855,8901.126010762857,21582.010057738982,28139.503452372745,26997.945629214133),c(5099.97941336356,4434.311103344507,4110.323315535536,6847.280525066181,5274.858949743673,9179.347479618731),c(5126.472812913501,4817.719990762933,5117.0599320658475,9482.090975125751,11907.890243240245,7899.203126552224),c(3203.8089598606707,3058.90146666988,2724.5068619166505,4642.972459209062,4485.706823404068,2364.9345409433336),c(5565.506291169659,5364.53599236177,5185.936459842869,8919.975435989612,14570.240311575437,8353.114275081192),c(4744.210905121501,3948.075300173529,3380.1285473731186,4426.447591414932,6387.978791106904,3485.348135413572),c(9318.107098850527,9206.197391349519,9423.137589704498,25993.17354083903,29348.152235345508,37892.96233605754),c(492.0202773560392,711.0202236532986,626.6210421819325,3350.6161894731094,2637.4294748718366,1068.702197802381),c(668.0121457949301,911.094300040045,973.0751555866539,4265.115336980089,50804.78320729497,5044.734030486508),c(1298.176577947088,1428.4173102990032,1491.4616541189798,3836.3111870348475,14595.160905038792,10761.716217655161),c(1453.3522038824542,1114.3568079229947,1175.043921248599,2252.707742187572,1333.2517502895425,10659.44256646762),c(1148.6781090581376,1013.5226618555707,1158.4721250917214,5545.583966915579,2039.335231751294,1990.314200638413),c(1021.8882683548507,1260.227548874288,1426.2102067512744,5247.543854775422,21518.93245560785,4393.170432471508),c(1385.2263193254641,1146.6396768220516,962.7177829886053,2496.4043580970456,4332.02983038004,2677.501205246826),c(2002.1440517026517,1904.6892650443463,1468.1575657733708,5899.66580954363,4008.062115356413,2694.738337469445),c(1407.9349475111276,1545.5921677844685,2049.20616852389,12149.167876072288,23105.543572774845,13027.824533855479),c(7245.9447769087465,9219.748225208383,9147.63147859641,22168.749993604648,31146.588396951025,11594.844275081748),c(1712.609042335444,1511.3165292002848,1228.9022587584511,1359.436522895704,2097.4832831657914,1282.4426373628573),c(8599.000539637855,9910.840752010412,10890.777286847968,21634.655319712456,26461.51682584011,16276.449386745082),c(836.4344715052666,615.76583270423,613.1564578044695,1616.7190128628486,1557.5370914597459,533.2019567530159),c(5230.5540254311245,4824.495407692365,4556.208205881522,12002.27061282372,4672.611274379238,4685.052538107858),c(7240.26761986233,6745.126830217727,6220.6379823879115,17534.26870568163,15687.513585182562,7542.969060618097),c(9113.729445179557,10625.049407159913,10958.100208735283,17856.933214551314,80277.53840995725,77606.16583482367),c(9933.132445545576,9081.450009060572,8847.785541882906,12533.817935330098,25497.920545257013,18178.27964197405),c(10398.659323351674,10420.989791402913,11136.247017421716,27049.475248822953,49733.19768837066,35572.844338893025),c(17099.5970238045,20762.26879540075,23116.10203295448,42500.010520909294,87732.94928774457,69216.27901100088),c(1116.5075524617812,1108.3784988676139,1201.4552213736226,759.1107129723669,3904.2263092590965,2318.9688550163496),c(7953.6970220285875,9168.733321269132,9592.998500312493,16894.88350784249,53097.477805923714,16972.829528538892))
targetgene="G244S"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-NUT-REP1","D25-NUT-REP2","D25-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



dev.off()
Sweave("D25_NUT_D4_w_controls_summary.Rnw");
library(tools);

texi2dvi("D25_NUT_D4_w_controls_summary.tex",pdf=TRUE);

