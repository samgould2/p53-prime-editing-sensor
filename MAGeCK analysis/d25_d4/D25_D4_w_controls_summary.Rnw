% This is a template file for Sweave used in MAGeCK
% Author: Wei Li, Shirley Liu lab
% Do not modify lines beginning with "#__".
\documentclass{article}

\usepackage{amsmath}
\usepackage{amscd}
\usepackage[tableposition=top]{caption}
\usepackage{ifthen}
\usepackage{fullpage}
\usepackage[utf8]{inputenc}

\begin{document}
\setkeys{Gin}{width=0.9\textwidth}

\title{MAGeCK Comparison Report}
\author{Wei Li}

\maketitle


\tableofcontents

\section{Summary}

%Function definition
<<label=funcdef,include=FALSE,echo=FALSE>>=
genreporttable<-function(comparisons,ngenes,direction,fdr1,fdr5,fdr25){
  xtb=data.frame(Comparison=comparisons,Genes=ngenes,Selection=direction,FDR1=fdr1,FDR5=fdr5,FDR25=fdr25);
  colnames(xtb)=c("Comparison","Genes","Selection","FDR1%","FDR5%","FDR25%");
  return (xtb);
}
@

The statistics of comparisons is as indicated in the following table. 

<<label=tab1,echo=FALSE,results=tex>>=
library(xtable)
comparisons=c("D25-REP1,D25-REP2,D25-REP3_vs_D4-REP1,D4-REP2,D4-REP3 neg.","D25-REP1,D25-REP2,D25-REP3_vs_D4-REP1,D4-REP2,D4-REP3 pos.");
ngenes=c(1210,1210);
direction=c("negative","positive");
fdr1=c(0,245);
fdr5=c(0,289);
fdr25=c(0,356);

cptable=genreporttable(comparisons,ngenes,direction,fdr1,fdr5,fdr25);
print(xtable(cptable, caption = "Summary of comparisons", label = "tab:one",
    digits = c(0, 0, 0, 0, 0, 0, 0),
    table.placement = "tbp",
    caption.placement = "top"))
@

The meanings of the columns are as follows.

\begin{itemize}
\item \textbf{Comparison}: The label for comparisons;
\item \textbf{Genes}: The number of genes in the library;
\item \textbf{Selection}: The direction of selection, either positive selection or negative selection;
\item \textbf{FDR1\%}: The number of genes with FDR $<$ 1\%;
\item \textbf{FDR5\%}: The number of genes with FDR $<$ 5\%;
\item \textbf{FDR25\%}: The number of genes with FDR $<$ 25\%;
\end{itemize}

The following figures show:

\begin{itemize}
\item Individual sgRNA read counts of selected genes in selected samples; 
\item The distribution of RRA scores and p values of all genes; and
\item The RRA scores and p values of selected genes.
\end{itemize}


\newpage\section{Comparison results of D25-REP1,D25-REP2,D25-REP3 vs D4-REP1,D4-REP2,D4-REP3 neg.}

The following figure shows the distribution of RRA score in the comparison D25-REP1,D25-REP2,D25-REP3 vs D4-REP1,D4-REP2,D4-REP3 neg., and the RRA scores of 10 genes.

<<echo=FALSE>>=
gstable=read.table('D25_D4_w_controls.gene_summary.txt',header=T)
@
%


<<fig=TRUE,echo=FALSE,width=4.5,height=4.5>>=# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=3
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("V172A","V173A","R174R","H179PfsTer2","R174W","V173E","E171Ter","V172D","E171G","G244D")
# samplelabel=sub('.\w+.\w+$','',colnames(gstable)[startindex]);
samplelabel='D25-REP1,D25-REP2,D25-REP3_vs_D4-REP1,D4-REP2,D4-REP3 neg.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \n',samplelabel))



# you need to write after this code:
# dev.off()




@
%%
\clearpage
\newpage
The following figures show the distribution of sgRNA read counts (normalized) of selected genes in selected samples.
%


<<fig=TRUE,echo=FALSE,width=4.5,height=4.5>>=
par(mfrow=c(2,2));

# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(4897.533721755006,2176.141873363833,2481.880889432173,758.0347692772028,542.7544875907231,891.626821593742),c(3237.606261862469,779.8260523871164,1439.2832270933018,458.4847788051534,394.7305364296168,480.94982567529394),c(1372.0571571634252,735.4320880729197,892.0232987540738,375.79907895584387,224.09181495223035,345.56180504283856),c(10531.566789453322,3065.6964035841524,4654.305500600418,925.8817887317892,1087.564863392017,1011.5419255824883),c(2994.5988634547784,1098.9600222684176,1454.8598853951773,406.496763929839,520.1397172744429,531.8815096275034),c(5877.0404661060065,1864.5465011962633,2614.801706941511,728.8224561567881,665.0798361196928,558.3144088938399),c(50597.87892384141,15345.23445728461,22839.53484609674,4441.756966156621,5060.5688303203215,5187.94000966366),c(2265.576668231705,1058.7541677951829,1160.9802654331252,213.89354691557912,210.72854158351936,225.0019961939378),c(26510.23787859904,9760.808795345938,14390.755383159436,3117.3003967140885,3334.6506775460334,3003.679943460046),c(2074.9093248656704,744.645929723036,1032.2132234709538,185.17635774635784,184.0019948460974,190.18793374559212),c(36563.26702195722,12291.264761255152,17718.968040326847,3443.091956599392,4116.916141668268,3841.1515568008062),c(21545.409800361907,7036.024532816088,9921.292894407941,1962.1762185797224,2322.125733839855,2178.457722462223),c(49719.313714213604,15953.348006192287,22304.736244399013,4649.709025657879,5304.191583272976,4619.9550278675015),c(2871.2258765708734,1100.6352662048023,1427.860344338593,208.9423074036444,189.1417153725247,198.56909692760127),c(48545.40105113645,13820.762475174459,19929.815075306386,4456.115560741232,5005.059848634906,4231.842702054463),c(3648.849551475485,1050.3779481132588,1253.4017713575868,458.4847788051534,465.65867969431355,308.1689231538747),c(10094.153472319478,4092.6209365880245,5955.4756907504225,1363.571361586817,1308.572846028391,1780.6748237468657),c(3906.8112513236497,1363.6485642172133,1639.7028972441008,599.5951048952924,655.8283391721237,483.5286451159121),c(1887.9805568597542,1152.5678282327306,1233.6713375085444,668.4173341111848,282.6846289535016,332.023002979593),c(998.1996211515927,537.7533035795153,831.793553320155,288.6572635457931,241.56686474208317,346.85121476314765),c(1514.1230208479217,669.2599525857207,904.4846253955742,354.5087490545246,316.60678442792175,313.9712668952656),c(287.870302729111,64.49689155081414,164.07413411308926,114.86875667688508,19.530938000423745,45.77404507097302),c(994.4610457914745,70.36024532816089,469.3766368298502,157.94454043071698,124.3812367395407,136.6774303527645),c(904.7352371486346,763.911234991461,1124.6347293954154,238.15462052405917,239.51097653151226,232.73845451579237),c(171.97446656544295,57.79591580527501,36.34553603770964,18.319586194158397,23.642714421565586,39.32699646942752),c(20745.354673296584,7077.068009257515,7685.523206145402,2416.2048818241346,2735.35926416461,2384.7632777116787),c(31568.530340839137,11950.352620200849,14369.986505423602,4178.3510241216945,4995.808351687338,3538.1402725281678),c(1977.7063655025938,877.8278226656262,838.0242166409051,213.89354691557912,196.3373241095229,181.80677056358297),c(4359.178869897967,1682.7825340985144,2520.3033132434657,842.7009649312863,665.0798361196928,767.8434884440685),c(5966.766274748847,2392.24834115747,2445.535353394463,857.0595595158969,967.2954030736181,1112.7605886267525))
targetgene="V172A"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3379.6721255469656,1113.1995957276881,2134.0021873569517,862.5059229790251,561.2574814858614,544.7756068305944),c(2560.9241216810524,932.2732505981317,1220.1715669802522,460.96039856112077,323.80239316492,408.7428813379844),c(1749.6532685353761,1057.078923858798,1110.0965149803317,430.75783753831905,330.9980019019182,386.8229160927297),c(16509.548790282523,6127.204697327344,7402.028025051267,1837.9001068301613,2043.5528813074952,1885.117011091903),c(29736.628414381157,11946.164510359886,16641.06328583706,3522.311788790347,4058.3233276669976,3898.530289354561),c(1633.757432371708,505.08604682001203,746.6411546032352,116.35412853046549,134.6606777923953,172.13619766126473),c(6131.263590594053,3818.7185529891126,5541.136579920533,1717.584986690148,2062.0558752026336,1478.3082443343822),c(7895.871160569902,3835.4709923529604,4567.076214109915,1204.6365732537129,1398.0039831882261,1499.583504719482),c(10292.29796640575,4600.219849312613,4648.074837279667,816.4593955180324,1130.7385158140064,1030.2383665269701),c(6344.362386120797,1912.2909533832296,2999.0259450544413,665.4465904040239,870.6686571767849,555.0908845930671),c(11025.05873698894,4114.399107761027,5554.636350448825,1030.3529424336114,1291.0977962385382,1116.6288177876797),c(6546.245455567187,2753.2634094483906,5058.260172562391,1039.7602975062873,1231.4770381319815,994.1348943583154),c(4789.115036311574,5301.309436689646,4216.082180374318,837.2546014681581,1114.2914101294389,812.9728286548869),c(4531.15333646341,4476.25179802014,5202.6038728264375,1243.2562414468036,1697.135717826295,1448.0071159071183),c(2617.0027520828276,1655.9786311163577,2061.3111152815327,633.2635335764484,826.4670606495101,658.8883670779496),c(8594.984752912029,5049.185224263735,7862.058666899991,2862.311561849451,2923.473035431849,2387.342097152297),c(11200.7717789145,4848.155951897562,7917.096192899952,2634.554544300455,2581.167648371791,2246.1517327784504),c(25108.27211855467,8047.871870392497,11625.379312633127,2638.5155359100027,3233.912155228058,2607.1864544649984),c(26461.636398917504,9297.603846935544,14499.791991272565,2940.5411461380195,3186.6267263849268,3004.3246483202006),c(1315.9785267616503,718.6796487090719,811.0246755843209,113.38338482330468,141.85628652939351,140.5456595136918),c(36260.442417787635,14496.723403505719,20949.56697213584,4413.534900938594,5105.798370952882,4407.202424016501),c(4456.381829261043,2225.561569487184,3154.792528073197,702.0857627923407,778.1536877010934,624.074304629604),c(5219.051202725182,1908.1028435422677,2283.5381070549574,658.5148550873154,750.3991968583861,528.013280466576),c(3286.2077415440076,1846.1188178960308,1598.1651417724327,682.2808047446019,519.1117731691575,614.4037317272857),c(598.172057618932,273.902383598912,406.0315597355563,178.24462242964927,382.39520716619126,134.74331577230086),c(1241.207019559284,1048.702704176874,723.7953890938178,184.6812337951644,201.47704463595022,225.64670105409235),c(1648.7117338121814,564.5572065616718,1164.0955970935004,333.7135431043989,345.38921937591465,522.8556415853396),c(1962.7520640621206,559.5314747525175,786.10202230132,344.1111460794618,445.0997975886043,355.8770828053113),c(751.4536473837833,490.008851392549,508.837504527935,279.74503242431064,295.01995821692714,273.354860705529),c(2729.160012886377,898.768371870436,1960.5820582627373,470.86287758499014,529.3912142220121,451.93810696833924))
targetgene="V173A"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(93.46438400295813,270.55189572614245,257.5340839243426,34.65867658354291,51.39720526427302,43.19522563035482),c(3286.2077415440076,1024.4116670992946,2660.493237960346,500.5703146565984,930.2894152833416,336.53593700067483),c(1977.7063655025938,713.6539168999175,1005.2136824143695,364.90635202958754,290.90818179578525,320.4183154968111),c(3293.6848922642444,1474.214664018609,1856.737669583567,614.9439473822899,470.7984002207408,548.6438359915217),c(1959.0134887020022,695.2262335996849,858.7930943767393,196.0690846726142,193.25349179366654,136.03272549260996),c(8583.769026831675,3631.0912321140167,4640.805730072126,1082.8360812601193,1112.235521918868,915.4809014194603),c(4987.259530397845,3502.935070980581,4627.3059595438335,1046.1969088718024,1181.1077769729939,1136.6146684524708),c(3170.3119053803393,1047.8650822086818,1700.9710865648112,287.66701564340616,412.2055862194696,321.70772521712024),c(10355.85374752776,4355.634234600436,6328.277046108645,1519.53540621276,1517.2454994013394,1351.3013868839357),c(4557.323363984238,3056.4825619340363,4575.383765204248,959.5502174129452,1045.4191550753133,921.9279500210058),c(4523.676185743173,1833.5544883731447,2063.388003055116,456.00915904918605,526.3073819061557,413.2558153590663),c(2968.42883593395,1407.2049065632175,3388.4424026013303,745.6566704973661,841.886222228792,567.9849817961581),c(1988.922091582949,928.9227627253621,960.5605952823263,178.24462242964927,453.323350430888,98.63984360364609),c(3005.814589535133,1600.69558121566,2092.464431885284,645.6416323562851,680.4989976989747,579.58966927894),c(284.1317273689927,56.958293837082614,118.38260309425426,31.192808925188622,22.614770316280126,47.06345479128212),c(93.46438400295813,82.08695288285436,96.57528147162847,56.93925438724907,57.56486989598578,20.630555524945585),c(5076.985339040685,2320.2128518929244,2515.111093809507,795.1690656167132,1153.3532861302865,844.5633668024599),c(13298.112555940881,4315.4283801272,7692.792313352944,1843.841594244483,1824.600786881692,1157.2452239774163),c(5712.543150260801,2895.659144041097,4919.108691732302,1470.5181350446064,1227.3652617108396,1220.4263002725622),c(8763.220644117353,2739.8614579573123,4287.7348085629465,968.4624485344277,1019.7205524431766,713.6882801910863),c(28416.911312259388,10991.27546662056,16506.065580554136,3441.111460794618,3390.159659231448,3231.2607590946022),c(31104.946996184462,10541.472469701246,14882.977785498702,3127.2028757379576,3525.8482811291287,2846.371957582336),c(3050.677493856553,1226.278561433661,1522.3587380366382,216.36916667154648,227.17564726808672,218.5549475923923),c(441.15189249396235,290.65482296275985,220.15010399984126,69.8124771182793,26.72654673742197,79.94340265916414),c(4243.283033734298,1599.0203372792753,2165.155503960703,594.1487414321642,685.638718225402,482.8839402557576))
targetgene="R174R"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(82.24865792260314,62.82164761442936,53.99908211316861,2.970743707160821,4.111776421141841,1.9341145804636486),c(74.7715072023665,35.18012266408044,38.42242381129305,8.912231121482463,6.167664631712762,23.854079825718333),c(74.7715072023665,25.128659045771744,25.961097169792602,14.358594584610636,10.279441052854603,24.49878468587288),c(609.387783699287,84.59981878743153,203.535001811174,67.33685736231195,80.17964021226591,25.78819440618198),c(269.17742592851937,103.86512405585654,139.15148083008836,118.33462433523937,101.76646642326057,34.81406244834567),c(343.9489331308859,57.79591580527501,201.45811403759058,107.44189740898304,70.92814326469676,33.52465272803658),c(0.0,0.0,0.0,0.0,0.0,0.6447048601545495),c(0.0,0.0,0.0,0.0,0.0,0.0),c(743.9764966635466,456.50397266485334,620.989444301439,156.95429252833006,322.77444905963455,165.04444419956468),c(1043.0625254730126,350.12598270441964,694.71896026365,113.87850877449814,313.5229521120654,241.11961769780152),c(1058.016826913486,488.3336074561642,462.10752962230833,347.57701373781606,192.22554768838108,215.33142329161953),c(1129.049758755734,348.45073876803485,281.4182933205518,220.33015828109424,192.22554768838108,256.5925343415107),c(171.97446656544295,251.28659045771744,253.3803083771758,93.0833028243724,41.11776421141841,88.96927070132783),c(2183.328010309102,1183.5598410558491,1224.325342527419,179.23487033203622,222.03592674165944,502.22508606039406),c(1061.7554022736042,373.57939781380657,515.0681678486852,177.2543745272623,191.19760358309563,271.42074612506536),c(1581.4173773300515,1055.4036799224132,1017.67500905587,505.52155416853304,233.3433118997995,351.3641487842295),c(829.9637299462681,548.6423891660164,629.2969953957727,280.2401563755041,319.69061674377815,185.0302948643557),c(594.4334822588137,478.28214383785553,884.7541915465318,383.2259382237459,192.22554768838108,258.52664892197436),c(500.96909825585556,499.2226930426653,1001.0599068672027,204.98131579409664,177.83433021438464,306.23480857341104),c(897.258086428398,319.9715918494935,658.3734242259404,138.63470633417165,198.39321232009385,175.35972196203747),c(265.43885056840105,238.72226093483155,213.91944067909105,65.35636155753807,166.52694505624459,108.95512136611887),c(7776.236749046116,1640.9014356888947,2918.0273218846883,250.53271930389593,879.920154124354,578.9449644187855),c(3757.2682369189165,773.9626986097696,1284.555087961338,508.4922978756939,804.8802344385155,250.1454857399652),c(392.5504128124241,247.09848061675547,422.64666192422357,71.29784897185971,182.97405074081195,130.230381751219),c(1697.3132134937196,774.8003205779621,1300.1317462632135,377.7795747606178,362.8642691657675,133.45390605199177),c(960.8138675504096,331.698299404187,587.7592399241045,85.16131960527687,84.29141663340775,290.76189192970185),c(1020.6310733123026,433.8881795236588,805.8324561503623,199.03982837977503,204.5608769518066,251.4348954602743),c(1757.1304192556127,743.8083077548436,910.7152887163245,190.12759725829255,533.5029906431539,140.5456595136918),c(1790.7775974966776,494.19696123351093,631.3738831693561,263.40594203492617,634.241512961129,186.3197045846648),c(1787.0390221365594,795.7408697827718,786.10202230132,270.8328013028282,572.5648666440014,498.3568568994668),c(486.0147968153822,158.310551988362,218.07321622625784,119.32487223762632,156.24750400338996,57.37873255375491),c(620.603509779642,123.96805129247393,272.0722983394265,132.69321891985,143.91217473996446,67.04930545607316),c(257.9616998481644,304.0567744538381,305.302502716761,119.81999618881979,91.48702537040597,62.5363714349913),c(1387.0114586038985,206.8926261435207,691.603628603275,239.63999237763957,190.16965947781017,128.9409720309099),c(889.7809357081613,409.59714244607943,343.724926528054,31.192808925188622,254.93013811079416,155.37387129724644),c(1603.8488294907613,219.45695566640654,331.2635998865536,229.73751335377017,68.87225505412584,227.580815634556),c(3.738575360118325,0.0,0.0,0.0,11.307385158140063,0.0),c(0.0,0.0,0.0,0.0,0.0,0.0),c(1248.6841702795205,373.57939781380657,503.6452850939765,169.3323913081668,387.53492769261857,134.0986109121463),c(1917.8891597407007,1196.124170578735,930.4457225653669,223.79602593944853,325.85828137549095,260.460763502438),c(1491.6915686872117,212.75597992086742,629.2969953957727,153.98354882116922,225.1197590575158,33.52465272803658),c(844.9180313867414,245.42323668037068,397.72400864122267,209.93255530603136,226.14770316280126,176.64913168234656),c(306.56317952970267,120.61756341970437,274.1491861130099,116.84925248165897,123.35329263425524,121.2045137090553),c(1147.7426355563257,481.63263171062505,481.8379634713507,324.30618803172297,181.9461066355265,410.67699591844803),c(669.2049894611802,495.03458320170336,410.1853352827231,199.03982837977503,170.6387214773864,78.65399293885504),c(1704.790364213956,1313.3912461256698,1737.316622602521,839.235097272932,863.4730484397867,400.36171815597527),c(755.1922227439017,467.39305825135443,419.5313302638484,236.1741247192853,321.74650495434906,98.63984360364609),c(762.6693734641383,489.17122942435657,539.9908211316861,341.63552632349445,244.65069705793957,535.1050339282762),c(601.9106329790503,242.07274880760113,496.37617788643456,190.12759725829255,156.24750400338996,72.20694433730955),c(616.8649344195236,663.396598808374,406.0315597355563,67.83198131350542,210.72854158351936,133.45390605199177),c(336.47178241064927,105.54036799224131,310.4947221507195,90.11255911721157,67.84431094884039,82.52222209978234),c(7813.622502647299,2756.61389732116,3123.639211469446,697.134523280406,1244.8403115006925,488.041579136994),c(3177.789056100576,1513.5828965236512,1507.8205236215542,483.2409763648269,440.9880211674625,455.161631269112),c(1005.6767718718294,577.9591580527501,517.1450556222686,142.59569794371941,145.96806295053537,187.6091143049739),c(1775.8232960562043,498.3850710744729,1203.556464791585,330.74279939723806,279.6007966376452,303.0112842726383),c(1166.4355123569173,1016.8730693855632,1015.5981212822866,315.88908086143397,358.75249274462567,308.81362801402923),c(1682.3589120532463,753.0221494049599,708.2187307919422,380.7503184677786,278.5728525323597,289.47248220939275),c(1480.4758426068568,984.2058126260599,908.6384009427411,340.6452784211075,246.70658526851048,332.66770783974755),c(1379.534307883662,485.82074155158705,363.45536037709644,325.2964359341099,528.3632701167267,345.56180504283856),c(6381.748139721981,2111.6449818130186,2410.228261243545,641.1855167955439,940.5688563361962,800.7234363119505))
targetgene="H179PfsTer2"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



par(mfrow=c(1,1));
@
%


<<fig=TRUE,echo=FALSE,width=4.5,height=4.5>>=
par(mfrow=c(2,2));

# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1282.3313485205854,817.519040955774,1632.4337900365588,446.6018039765101,305.2993992697817,397.13819385520253),c(2235.6680653507583,777.3131864825392,1072.7125350558304,259.44495042537835,406.03792158775684,436.46519032463004),c(1308.5013760414138,495.8722051698957,703.0265113579836,324.30618803172297,297.07584642749805,279.15720444691993),c(1158.9583616366808,493.35933926531857,497.41462177322626,107.9370213601765,111.01796337082972,103.79748248488248),c(32394.755495425285,12754.469709665544,19725.24162960842,3908.5084707212536,4484.9201313604635,3306.6912277326846),c(21321.09527875481,7490.015639576364,11526.727143387916,2218.1553013467465,2658.2634562682006,2673.591055060917),c(2231.92948999064,943.9999581528251,1151.6342704519998,260.4351983277653,436.87624474632065,315.90538147572926),c(7712.680967924104,4195.648438675688,5434.176859580987,1278.41004198154,1423.7025858203626,1399.0095465353725),c(3835.7783194814015,1577.242166106273,2607.5325997339687,474.8238691945379,669.1916125408346,578.9449644187855),c(4770.422159510983,1880.4613185919188,2288.7303264889156,587.7121300666491,776.0977994905226,474.50277707374846),c(2216.975188550167,1002.6334959262925,2138.1559629041185,367.38197178555487,621.9061836977035,360.3900168263932),c(3910.549826683768,2601.653833205568,3418.5572753182896,978.364927558297,1045.4191550753133,800.7234363119505),c(1682.3589120532463,1589.806495629159,1766.3930514326887,629.3025419669007,519.1117731691575,586.6814227406401),c(2751.5914650470872,1243.0310007975088,1256.517103017962,379.76007056539163,278.5728525323597,246.92196143919247),c(6546.245455567187,3374.778909847145,4272.158150261071,926.8720366341762,1180.0798328677085,899.3632799155966),c(168.23589120532463,73.71073320093045,259.610971697926,62.385617850377244,116.15768389725702,48.352864511591214),c(1330.9328282021236,257.98756620325656,506.7606167543516,98.52966628750056,128.49301316068255,99.92925332395518),c(568.2634547379854,67.8473794235837,206.65033347154912,9.902479023869404,38.033931895562034,48.99756937174576),c(919.6895385891079,804.9547114328882,592.9514593580631,458.4847788051534,179.89021842495555,430.66284658323906),c(8834.253575959601,2962.6689014964886,4380.156314487408,853.5936918575426,1136.9061804457192,808.4598946338051),c(8475.350341388243,3600.0992192908984,5659.519183014787,1306.1369832483745,1541.9161579281904,1441.5600673055728),c(13372.884063143249,4750.991803587244,7049.995547428879,1735.9045728843064,1751.6167554064243,1654.3126711565742),c(31796.583437806352,11927.736827059654,17548.663242893006,4099.626315881933,4518.842286834883,3780.5492999462786),c(22760.446792400362,7506.768078940212,10811.239305388432,2236.474887540905,2831.9860100614433,2408.617357537397),c(1850.594803258571,666.7470866811436,852.562431055989,154.4786727723627,99.71057821268965,128.9409720309099),c(2359.041052234663,892.9050180930892,1241.978888602878,364.41122807839406,550.9780404330068,424.2157979816936),c(5200.35832592459,2073.9519932443613,2852.605357016811,804.576420689389,783.2934082275208,745.2788183386592),c(3095.540398177973,1130.7896570597284,1287.670419621713,455.0189111467991,593.1237487497106,390.04644039350245),c(407.50471425289743,91.30079453297067,267.91852279225964,136.65421052939777,64.760478632984,83.81163182009143),c(1861.8105293389258,1377.0505157082914,1571.1656007158483,306.9768497399515,291.93612590107074,417.7687493801481))
targetgene="R174W"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3854.471196281993,2374.65827982543,3741.51332411051,576.3242791891993,712.365264962824,985.1090263161517),c(2344.08675079419,1272.3477696842426,1328.1697312065894,498.5898188518245,489.30139411587913,649.2177941756314),c(1772.084720696086,959.0771535802882,957.4452636219512,503.0459344125657,564.3413138017177,444.2016486464846),c(14075.736230845494,6117.153233709035,8419.703034107137,2040.900926819484,2484.5409024749574,1876.7358479098937),c(30331.06189663997,11308.734192565476,16736.600123421893,3556.4753414226966,4210.4590552492455,4329.837840797954),c(964.5524429105278,440.5891552691979,523.3757189430189,163.88602784503863,151.10778347696268,105.08689220519157),c(5215.312627365063,4198.161304580266,5589.943442599743,1827.5025038550984,1725.9181527742878,1769.0701362640839),c(7723.896694004459,3514.6617785352746,5265.948949920731,1948.8078718974987,1918.143700462669,1355.169616044863),c(6344.362386120797,2509.5154167044047,2901.412219696021,684.7564245005693,844.9700545446484,788.474043969014),c(5880.779041466125,2512.865904577174,3206.714722412782,844.6814607360601,771.9860230693807,837.4716133407599),c(8490.304642828716,3380.642263624492,3870.280366072681,1348.2225190998192,1157.4650625514282,1115.3394080673706),c(5574.215861936423,2233.1001672009156,3630.3998282237976,1141.7558314521423,1147.1856214985737,885.1797729921965),c(7107.031759584936,3151.1338443397767,4875.49404848705,1300.1954958340527,1420.6187535045062,1272.6473939450807),c(5024.645283999029,3793.589893943341,4301.234579091239,1509.1378032376972,1494.6307290850593,1392.562497933827),c(2452.5054362376213,1639.22619175251,2146.4635139984525,833.7887338098038,1031.0279376013168,788.474043969014),c(9473.549962539835,5071.8010174049305,8851.695691012486,3266.827829974516,3498.0937902864216,2694.866315446017),c(14288.835026372239,5976.432743052713,8761.351072861607,2714.2695004426037,2871.0478860622907,2384.1185728515243),c(16270.27996723495,5785.4549343048475,7178.76258939105,1581.4259001119437,2139.151683099043,1692.3502579056926),c(25938.23584850094,9023.701463336633,12248.44564470815,2919.7459401878937,3247.275428596769,3233.194873675066),c(1274.8541978003489,519.3256202792827,629.2969953957727,106.94677345778956,98.6826341074042,116.69157968797346),c(42616.02052998879,17956.939754108487,23590.32977624714,5580.046929950409,6065.898165289502,5525.765356384644),c(6355.578112201152,1943.2829662063482,3902.472126563224,782.2958428856829,644.5209540139837,1186.256942684371),c(2975.9059866541866,1121.5758154096122,1434.0910076593434,465.9116380730554,449.2115740097462,344.27239532252946),c(2889.9187533714653,1332.6565513940948,1520.2818502630548,542.1607265568499,461.54690327317167,576.3661449781673),c(175.71304192556127,163.33628379751633,113.19038366029574,13.368346682223695,77.09580789640953,14.82821178355464),c(4729.297830549681,496.70982713808814,1352.0539406027988,331.733047299625,94.57085768626234,130.87508661137355),c(1390.750033964017,863.5882492063556,1446.5523343008438,355.99412090810506,717.5049854892513,288.18307248908366),c(915.9509632289896,483.30787564700984,599.1821226788132,254.4937109134437,378.2834307450494,341.6935758819113),c(549.5705779373938,313.2706161039544,445.49242743364107,215.37891876915953,242.59480884736863,317.8394960561929),c(639.2963865802336,201.02927236617396,402.91622807518115,211.41792715961176,270.34929969007607,93.48220472240968))
targetgene="V173E"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3596.5094964338286,1297.4764287300143,1279.3628685273793,403.5260202226782,439.960077062177,424.86050284184813),c(2407.6425319162013,1184.3974630240414,1300.1317462632135,310.9378413494993,360.8083809551966,543.4861971102853),c(2366.5182029548996,982.5305686896752,795.4480172824453,357.4794927616855,421.4570831670387,582.8131935797128),c(2489.8911898388046,1776.5961945360623,1677.086877168602,325.2964359341099,310.439119796209,348.14062448345675),c(3245.083412582706,1470.0265541776469,1415.3990176970926,561.4705606533952,469.7704561154554,708.5306413098499),c(5293.822709927548,3184.6387230674723,2940.873087394106,544.6363463128172,750.3991968583861,653.7307281967132),c(25556.90116176887,8474.221452202424,11765.569237350008,2313.714223927086,3386.0478828103064,2767.717964643481),c(26547.623632200226,9708.038611349817,12573.478581273954,2779.1307380489484,2995.4291228018315,2790.927339609045),c(32469.527002627652,10349.657038985188,14548.598853951775,2785.5673494144635,3379.8802181785936,2836.0566798198633),c(1760.868994615731,768.099344832423,758.064037357944,117.34437643285244,145.96806295053537,148.2821178355464),c(46945.29079700581,17512.16248899833,20993.18161538109,5097.301077536776,4973.193581371057,4826.260583116958),c(2373.9953536751364,907.9822135205524,917.9843959238664,141.110326090139,135.68862189768078,136.03272549260996),c(45876.05824401196,14390.345413545285,15842.499936894237,4013.969872325463,4733.682604839545,4215.725080550599),c(1278.5927731604672,686.0123919495686,688.4882969428998,109.91751716495038,129.520957265968,105.73159706534612),c(54957.057793739375,19675.740032839276,21126.102432890428,5466.168421175911,6194.391178450184,5026.7637946250225),c(7357.516308712863,2153.5260802226385,3311.5975549787445,1523.0012738711143,894.3113715983504,1019.9230887644974),c(4351.70171917773,1324.280331712171,1614.7802439610998,729.8127040591751,915.8981978093451,711.7541656106226),c(4762.945008790746,1914.8038192878068,1602.3189173195994,623.3610545525789,638.3532893822709,553.1567700126035),c(25227.906530078457,9115.839879837797,10052.136824143696,3167.8030397358225,4169.341291037827,3350.531158223194),c(2175.850859588865,954.0514217711338,855.6777627163642,175.7690026736819,238.4830324262268,157.95269073786463),c(28603.840080265305,11051.584248330413,13140.468943462223,4128.838629002348,4609.301368100004,3268.653640983566),c(3895.5955252432946,1617.4480205795078,1712.39396931952,774.3738596665874,1004.3013908638948,868.4174466281783),c(2691.774259285194,1146.704474455384,1649.0488922252262,636.2342772836092,904.590812651205,538.9732630892034),c(7069.646005983753,2764.990117003084,4765.41899648713,1571.0282971368808,1914.0319240415272,1743.281941857902),c(1521.6001715681582,1122.4134373778045,1178.6338115085841,445.6115560741232,808.9920108596573,454.51692640895743),c(743.9764966635466,390.3318371776544,444.4539835468494,206.96181159887055,184.0019948460974,259.1713537821289),c(572.0020300981037,649.9946473172957,703.0265113579836,262.4156941325392,233.3433118997995,475.147481933903),c(28102.87098200945,9073.121159459984,11211.040201803236,2935.094782674891,3626.586803447104,2454.39140260837),c(42305.71877509896,14219.470532034036,18453.147868288583,5063.137524904426,6181.027905081472,3886.9256018717792),c(2497.368340559041,860.237761333586,793.3711295088619,193.09834096545336,232.31536779451403,150.86093727616458))
targetgene="E171Ter"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(2617.0027520828276,1655.9786311163577,994.8292435464525,301.53048627682335,566.3972020122886,577.6555546984764),c(3073.108946017263,1093.096668491071,1214.9793475462939,374.8088310534569,447.1556857991752,631.166058091304),c(1401.9657600443718,854.3744075562392,726.9107207541929,342.6257742258814,335.1097783230601,293.34071137032004),c(6374.270989001744,2291.733704974383,4310.580574072364,869.9327822469271,1046.4470991805986,785.8952245283958),c(2673.0813824846023,1143.3539865826142,1479.7825386781783,416.8943669049019,452.2954063256025,390.691145253657),c(4161.034375811696,1178.5341092466947,1511.9742991687212,377.2844508094243,509.8602762215883,361.03472168654775),c(28215.028242812998,9347.023543058896,13273.389760971562,2649.9033867874523,2719.940102585328,2730.969787614672),c(1487.9529933270933,553.6681209751707,635.5276587165229,97.53941838511363,173.72255379324278,71.562239477155),c(36013.69644401982,14546.980721597261,19266.249431646487,4199.14623007182,4361.5668387262085,4085.4946987993803),c(1558.9859251693415,726.2182464228034,861.9084260371144,139.12983028536513,130.54890137125346,113.46805538720072),c(40040.14210686726,15246.395065037908,20581.957836211575,4143.197223586959,4643.223523574425,4787.578291507685),c(25844.77146449798,9545.539949520493,13318.042848103605,2627.6228089837464,2783.6726371130267,3313.13827633423),c(54426.180092602575,17464.418036811363,21515.518890437317,4904.202736571322,6354.750458874716,4149.965184814835),c(3394.626426987439,1317.5793559666317,1237.8251130557112,221.32040618348117,221.00798263637398,227.580815634556),c(29467.450988452638,9652.75556144912,12177.831460406314,3066.7977536923545,3046.8263280661045,2692.9322008655536),c(5129.3253940823415,1770.7328407587154,1970.9664971306543,890.7279881970529,774.0419112799516,778.1587662065413),c(6378.009564361862,2661.96261491542,3607.55406271438,825.8667505907083,984.770452863471,836.1822036204508),c(2714.205711445904,1277.373501493397,1239.9020008292946,549.587585824752,686.6666623306875,500.2909714799304),c(2239.4066407108767,993.4196542761763,2395.690046828461,525.8216361674654,389.5908159031895,396.493488995048),c(1271.1156224402305,699.4143434406468,960.5605952823263,324.30618803172297,456.40718274674435,346.2065099029931),c(1102.8797312349059,674.2856843948751,650.0658731316067,319.35494851978825,369.03193379748024,342.3382807420658),c(59.8172057618932,139.04524671993698,79.9601792829612,31.192808925188622,51.39720526427302,73.49635405761865),c(2545.9698202405793,161.66103986113154,354.1093653959711,287.66701564340616,113.07385158140063,55.44461797329126),c(960.8138675504096,208.56787007990548,722.7569452070261,420.8553585144497,198.39321232009385,444.2016486464846),c(89.7258086428398,103.02750208766415,96.57528147162847,39.609916095477615,61.67664631712762,29.65642356710928),c(35400.57008496042,13844.215890283846,14460.331123574479,4473.444899033003,5854.141679600696,4781.131242906139),c(28682.350162827788,10943.531014433594,12430.173324896698,3941.186651500023,3810.5887982932013,3398.884022734785),c(1719.7446656544294,685.1747699813762,695.7574041504417,149.52743326042798,127.46506905539708,124.42803800982806),c(7637.909460721738,3775.162210643108,5455.984181203613,1794.329199125136,2316.9860133134275,1455.0988693688182),c(3656.3267021957217,1588.1312516927742,1574.2809323762233,462.9408943658946,714.4211531733949,578.300259558631))
targetgene="V172D"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



par(mfrow=c(1,1));
@
%


<<fig=TRUE,echo=FALSE,width=4.5,height=4.5>>=
par(mfrow=c(2,2));

# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(2011.3535437436587,959.9147755484806,1149.5573826784164,268.8523054980543,538.6427111695812,275.9336801461472),c(5121.848243362105,2316.8623640201545,2764.337626639516,1101.1556674542776,1243.812367395407,891.626821593742),c(859.8723328272147,542.7790353886696,531.6832700373525,182.20561403919703,176.80638610909918,146.9927081152373),c(1865.5491046990442,1185.2350849922339,1551.435166866806,602.0707246512598,179.89021842495555,692.4130198059862),c(1742.1761178151394,834.2714803196219,1058.1743206407464,407.48701183222596,318.6626726384927,326.2206592382021),c(1805.7318989371508,622.3531223669469,888.9079670936987,149.52743326042798,254.93013811079416,219.8443573127014),c(15683.323635696373,7646.650947628342,8847.54191546532,1989.4080358953631,2552.385213423798,2155.8930523568138),c(26820.539633488865,11175.552299622886,16065.765372554453,4456.610684692425,4533.23350430888,3970.092528831716),c(2209.49803782993,791.5527599418099,1219.1331230934607,226.76676964660936,200.44910053066477,201.14791636821946),c(22715.58388807894,9381.366043754784,13810.265250442873,3081.6514722281586,3728.353269870365,3087.4915752801376),c(29078.63915100033,12443.711959466167,19694.088313004668,4289.2587891890325,5250.738489798131,4814.655895634176),c(534.6162764969205,316.621103976724,302.18717105638586,80.21008009334217,69.9001991594113,74.78576377792774),c(29332.862275488376,9212.16640617992,14041.838237197422,3624.8024466873953,3979.171631560017,3726.394091693296),c(1622.541706291353,735.4320880729197,1033.2516673577456,111.4028890185308,127.46506905539708,146.34800325508274),c(27377.587362146493,11064.986199821491,17016.979972855654,3962.9721053525354,5210.648669691998,4372.388361568155),c(4807.807913112166,2361.2563283343516,2886.874005280937,1447.2473093385133,2387.914156578124,1981.1780352549308),c(2400.1653811959645,1157.593560041885,1308.439297357547,452.0481674396383,403.9820333771859,450.0039923878756),c(2938.5202330530033,1216.2270978153524,1365.553711131091,418.87486270967577,416.3173626406114,276.57838500630174),c(586.956331538577,486.6583635197794,439.26176411289083,294.1036270089213,343.33333116534374,261.7501732227471),c(1394.4886093241353,691.8757457269153,833.8704410937383,383.2259382237459,400.89820106132953,392.62525983412064),c(1831.9019264579792,866.1011151109327,1739.3935103761044,732.7834477663359,679.4710535936892,357.811197385775),c(710.3293184224817,351.8012266408044,428.8773252449738,112.8882608721112,116.15768389725702,99.92925332395518),c(17922.73027640725,6500.78409514115,7997.056372182913,3051.4489112053566,3173.263453016216,2815.426124294918),c(25680.274148652774,11497.199135408764,14827.940259498742,4943.8126526668,6214.950060555893,5616.668741666435),c(3559.1237428326453,1516.933384396421,1614.7802439610998,573.3535354820385,633.2135688558435,609.8907977062039),c(2071.170749505552,999.283008053523,803.7555683767789,339.65503051872054,379.31137485033486,323.6418397975839),c(5338.685614248968,1919.8295510969613,3054.063471054402,1810.6682895145204,1842.075836671545,1544.0681400701462),c(100.94153472319478,78.7364650100848,93.45994981125337,40.105040046671085,51.39720526427302,27.07760412649108),c(594.4334822588137,474.09403399689353,200.41967015079888,37.134296339510264,182.97405074081195,201.14791636821946),c(22222.091940543323,8046.196626456112,10208.941851049243,3803.0470691170444,4150.838297142689,3106.18801622462))
targetgene="E171G"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(21661.305636525576,22052.91117856928,25279.877980057245,11804.250120403523,13165.908100496175,13725.121767830205),c(21911.790185653503,21541.12415600373,20496.805437494655,11233.372204677451,10603.243446019524,11461.563003827581),c(20266.81702720144,17443.477487606553,19203.942798438984,10025.269763765384,13061.057801757059,11841.29416645861),c(18532.118060106535,14753.03572577259,12763.513812556836,8550.295513160037,11071.985958029692,8936.898771462365),c(10198.83358240279,10054.814106181466,9804.98717908727,6640.6024334068225,5878.812338127547,7209.734451108327),c(7155.6332392664735,6041.767256571719,5727.018035656248,3920.8865695010904,4355.399174094496,4028.1159662456253),c(15556.21207345235,12984.815750918451,13120.73850961318,7222.868200010344,7641.736478692112,8559.746428271954),c(9006.228042525045,6549.366169296309,6376.045464901063,3698.5759154152224,4336.896180199357,5089.944870920169),c(28891.710382994414,25493.024601935434,28096.137801036344,13216.3436292073,15451.027846545754,13781.21109066365),c(3203.9590836214043,2985.284694637683,2884.797117507354,1668.5677155219946,1754.7005877222807,1925.7334172816395),c(3454.443632749332,2934.189754577947,3402.9806170164143,1899.2954767781516,1677.6047798258712,1678.1667509822923),c(3903.0726759635313,3364.7274462288365,3643.89959875209,2275.589679685189,2237.834317206447,2378.960933970288),c(3704.92818187726,2909.8987175003676,2086.2337685645334,1298.2150000292788,1399.0319272935114,1270.0685745044625),c(3058.15464457679,2831.162252490283,2670.877676828263,1454.179044655222,1597.4251396136053,1388.049563912745),c(3828.3011687611647,3672.134708555444,3599.2465116200465,1852.258701414772,1597.4251396136053,1878.6699624903574),c(3099.2789735380916,2383.872121475546,1882.6987667533595,1244.2464893491906,1269.5109700275434,1344.2096334222358),c(5465.797176492991,3952.738067899895,3350.0199787900374,1815.1244050752616,2259.4211434174417,1903.1687471762302),c(4273.191636615245,3210.605004081436,3517.2094445635016,2290.9385221721864,1951.0379118318037,2262.914059142469),c(18004.978934329854,21779.846416938562,20878.952787834,7984.863960897093,8552.49495597503,8584.245212957827),c(4276.930211975364,3404.9333007020714,2934.642424073356,1125.4167410627576,1058.7824284440242,1061.828904674543),c(24300.73984076911,25871.629731558394,27651.683817489495,10475.832559351442,10470.638656437699,11076.029497455162),c(2310.439572553125,1975.9502229658515,1558.7042740743477,619.4000629430312,531.4471024325829,781.382290507314),c(15171.138811360162,13066.065081833114,11867.336738255593,5890.489647348715,6157.3851906599075,5691.454505444363),c(17747.01723448169,15181.060551518902,13443.694558405401,6574.750947898091,6907.784387518293,6682.365875501906),c(23287.585918177047,21846.01855242576,20399.191712136235,10911.046512450503,14142.455000517362,12188.790086081914),c(29646.902605738316,30708.058975901262,34528.25923582416,13776.823941958308,15638.113673707709,13652.914823492896),c(20577.11878209126,22552.133871611946,23148.991124360666,10821.429077284485,12792.764390277554,10147.009793972455),c(18382.575045701804,24077.443475690292,25881.13699050964,8208.659986836543,9644.171595788188,9327.589916716022),c(3185.266206820813,3342.111653087642,2871.297346979062,965.9868287784603,1159.5209507619993,992.2007797778517),c(19051.780035162985,22412.25100292382,22458.425939644185,8203.708747324608,9450.918103994522,8268.339831482097))
targetgene="G244D"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



par(mfrow=c(1,1));
@

\newpage\section{Comparison results of D25-REP1,D25-REP2,D25-REP3 vs D4-REP1,D4-REP2,D4-REP3 pos.}

The following figure shows the distribution of RRA score in the comparison D25-REP1,D25-REP2,D25-REP3 vs D4-REP1,D4-REP2,D4-REP3 pos., and the RRA scores of 10 genes.

<<echo=FALSE>>=
gstable=read.table('D25_D4_w_controls.gene_summary.txt',header=T)
@
%


<<fig=TRUE,echo=FALSE,width=4.5,height=4.5>>=# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=9
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("V197L","G199Ter","L22L","G199EfsTer48","Q331H","D393N","R196P","D208N","V97CfsTer52","N200IfsTer47")
# samplelabel=sub('.\w+.\w+$','',colnames(gstable)[startindex]);
samplelabel='D25-REP1,D25-REP2,D25-REP3_vs_D4-REP1,D4-REP2,D4-REP3 pos.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \n',samplelabel))



# you need to write after this code:
# dev.off()




@
%%
\clearpage
\newpage
The following figures show the distribution of sgRNA read counts (normalized) of selected genes in selected samples.
%


<<fig=TRUE,echo=FALSE,width=4.5,height=4.5>>=
par(mfrow=c(2,2));

# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(198.1444940862712,891.2297741567045,639.6814342636897,1359.1152460260757,1298.2934049755363,1538.2657963287552),c(22.43145216070995,111.40372176958806,90.34461815087826,293.11337910653435,269.3213555847906,380.37586749118424),c(89.7258086428398,1078.8570950318,798.5633489428204,1572.5136689904614,1242.7844232901216,2128.170743370168),c(33.64717824106492,338.3992751497261,184.8430118489233,647.622128161059,479.0219530630245,863.9045126070964),c(239.2688230475728,1381.2386255492534,1208.7486842255435,2537.0151259153413,1909.9201476203853,2544.0053781698525),c(37.38575360118325,320.80921381768593,271.0338544526348,659.0099790385088,485.18961769473725,946.4267347068787),c(186.92876800591625,771.4498327051925,652.1427609051901,1432.8887147539028,1125.5987952875792,1567.9222198958644),c(209.3602201666262,1038.6512405585654,672.9116386410242,1766.6022578583015,1158.4930066567138,1895.4322888543757),c(220.57594624698118,1107.3362419503414,1072.7125350558304,1960.1957227749485,1589.2015867713217,2380.895048550751),c(3.738575360118325,0.0,1.038443886791704,7.921983219095523,1.0279441052854603,5.8023437413909456),c(119.6344115237864,260.5004321078337,156.80502690554732,50.99776697292743,151.10778347696268,152.79505185662825),c(37.38575360118325,50.25731809154349,88.26773037729484,58.42462624082948,152.13572758224814,123.13862828951896),c(142.06586368449635,948.1880679937871,820.3706705654462,1809.1829176609401,1593.3133631924634,2204.245916868405),c(370.1189606517142,1390.4524671993697,1246.132664150045,2845.9724714600666,2439.311361842397,3115.213884266783),c(213.0987955267445,1583.1055198836198,1356.2077161499656,2762.7916476595638,2232.69459668002,2927.6047699618093),c(4276.930211975364,4631.211862135732,4983.492212713388,7913.5661119252345,9331.676587781409,9954.8877456464),c(63.555781122011524,103.02750208766415,102.80594479237871,1178.8901277916525,1165.688615393712,1143.706421914171),c(153.28158976485133,298.19342067649137,309.4562782639278,1448.2375572409003,1497.7145614009157,1632.3927059113194),c(3043.2003431363164,3811.179955275381,3856.780595544389,6319.26698908226,7623.233484796974,7153.000423414727),c(115.89583616366808,184.27683300232613,165.11257799988095,1449.7229290944806,1318.8522870812455,1480.8870637750003),c(3.738575360118325,1.6752439363847829,0.0,9.407355072675934,6.167664631712762,6.447048601545495),c(0.0,14.239573459270654,8.307551094333633,224.291149890642,208.67265337294845,231.44904479548327),c(48.60147968153822,83.76219681923914,107.99816422633722,271.3279252540217,134.6606777923953,181.80677056358297),c(1514.1230208479217,2004.4293698843926,1727.9706276213956,4155.080198415601,4714.151666839121,5152.48124235516),c(418.7204403332524,627.3788541761012,613.7203370938971,2830.1285050218758,2386.886212472839,2727.1015584537445),c(14.9543014404733,42.71872037781196,29.076428830167714,123.78098779836755,129.520957265968,67.6940103162277),c(63.555781122011524,119.77994145151197,85.15239871691973,520.8703966555306,372.11576611333663,500.2909714799304),c(302.8246041695843,1837.7425982141067,2067.5417786022826,3145.522461932116,2738.4430964804665,3298.95476941083),c(512.1848243362106,1855.332659546147,1875.4296595458175,3097.9905626175428,3317.1756277561803,3433.0533803229764),c(321.51748097017594,1972.5997350930818,1725.8937398478122,3077.6904806186108,2850.4890039565817,3367.2934845872123))
targetgene="V197L"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(44.8629043214199,260.5004321078337,182.76612407533992,547.607090019978,455.3792386414589,674.3612837216588),c(29.9086028809466,233.69652912567722,183.8045679621316,773.3836117642004,611.626742644849,970.280814532597),c(97.20295936307645,752.1845274367676,481.8379634713507,1306.1369832483745,965.2395148630472,1689.7714384650744),c(261.70027520828273,978.3424588487131,603.33589822598,1806.2121739537793,1578.9221457184672,1978.5992158143124),c(201.88306944638956,1325.1179536803631,974.0603658106185,2578.110413864399,1862.6347187772542,2739.350950796681),c(104.6801100833131,1098.9600222684176,812.0631194711126,1763.1363901999473,1217.085820657985,2121.078989908468),c(3.738575360118325,2.512865904577174,2.076887773583408,8.417107170288993,7.1956087369982225,12.24939234293644),c(48.60147968153822,81.24933091466197,76.8448476225861,198.04958047738808,154.19161579281905,203.72673580883765),c(0.0,30.154390854926092,5.19221943395852,45.05627955860579,23.642714421565586,28.36701384680018),c(100.94153472319478,437.23866739642835,312.57160992430295,512.4532894852416,430.70858011460786,701.4388878481499),c(14.9543014404733,30.154390854926092,28.03798494337601,158.93478833310394,87.37524894926413,166.33385391987377),c(26.170027520828274,122.29280735608914,69.57574041504418,247.06685164554162,166.52694505624459,370.0605897287114),c(392.5504128124241,1400.5039308176786,1262.7477663387122,2611.778842545555,2302.5947958394313,2669.078121039835),c(205.62164480650787,1303.3397825073612,1205.6333525651685,2279.5506712947367,1926.3672533049526,2508.5466108613523),c(216.83737088686286,2140.12412873156,1802.7385874703982,2775.1697464394006,2037.3852166757824,3376.3193526293758),c(186.92876800591625,510.1117786291664,482.8764073581424,1164.5315332070418,1002.2455026533238,1463.4800325508274),c(302.8246041695843,1227.1161834018535,1140.211387697291,2795.9649523895264,1850.2993895138286,3055.2563322724104),c(235.53024768745448,1539.5491775376154,1526.512513583805,3094.0295710079954,2067.1955957290606,3143.5808981135833),c(3.738575360118325,16.752439363847827,6.230663320750224,30.697684973995152,23.642714421565586,44.484635350663915),c(119.6344115237864,363.5279341954979,231.57298675455002,663.9612185504435,442.01596527274796,799.4340265916414),c(18.692876800591623,95.48890437393263,65.42196486787736,358.46974066407245,178.8622743196701,368.7711800084023),c(3.738575360118325,30.992012823118483,14.538214415083857,34.16355263234944,26.72654673742197,33.52465272803658),c(265.43885056840105,825.0576386695055,669.7963069806491,1616.0845766954867,1156.437118446143,1623.3668378691557),c(59.8172057618932,329.1854334996098,296.9949516224274,877.8547654660226,674.331333067262,887.1138875726601),c(14.9543014404733,20.102927236617393,7.2691072075419285,34.65867658354291,22.614770316280126,37.39288188896387),c(71.03293184224817,144.90860049728371,177.5739046413814,654.0587395265741,377.25548663976394,608.6013879858948),c(14.9543014404733,104.70274602404893,133.95926139612982,439.17494470860805,320.71856084906364,483.5286451159121),c(343.9489331308859,2254.0407164057256,2493.3037721868814,4236.775650362524,3587.5249274462567,4305.339056112081),c(385.07326209218746,1448.248383004645,1391.5148083008835,2755.3647883916615,2705.5488851113314,3017.218745523292),c(254.2231244880461,1966.7363813157351,1658.3948872063513,3373.2794794811125,2976.926128906693,3845.0197859617333))
targetgene="G199Ter"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(37.38575360118325,117.2670755469348,89.30617426408655,800.1203051286478,521.1676613797284,990.9113700575426),c(52.34005504165655,195.1659185888272,137.07459305650494,837.7497254193515,697.9740474888275,1242.9909703779715),c(100.94153472319478,320.80921381768593,236.76520618850853,1389.3178070488773,1009.441111390322,1667.2067683596651),c(89.7258086428398,258.82518817144893,247.14964505642558,1280.8856617375075,1048.5029873911694,1381.6025153111996),c(67.29435648212984,153.28482017920763,129.805485848963,842.2058409800928,506.7764439057319,950.9396687279606),c(112.15726080354975,422.16147196896526,295.9565077356357,1332.3785526616282,1112.235521918868,1988.2697887166307),c(145.80443904461467,539.4285475159,550.3752599996031,2245.3871186623874,1978.792402674511,2741.929770237299),c(175.71304192556127,615.6521466214077,525.4526067166023,2128.0427422295347,1642.6546802461655,2524.0195275050614),c(306.56317952970267,835.9467242560066,623.0663320750225,2080.510842914962,1640.5987920355947,2588.490013520516),c(400.0275635326608,1047.0274602404893,1090.3660811312893,3077.1953566674174,2658.2634562682006,3907.5561573967248),c(104.6801100833131,414.62287425523374,306.3409466035527,1577.464908502396,1165.688615393712,2024.3732608852856),c(519.6619750564472,1301.6645385709762,1399.822359395217,3606.97798444443,3488.8422933388524,4118.374646667263),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,1.038443886791704,7.426859267902053,7.1956087369982225,1.289409720309099),c(3.738575360118325,5.025731809154348,43.61464324525157,40.600163997864556,32.89421136913473,38.68229160927297),c(261.70027520828273,879.503066602011,779.8713589805698,2713.2792525402165,2412.5848151049754,3006.903467760819),c(373.8575360118325,973.3167270395588,1051.9436573199962,2768.7331350738855,2408.4730386838337,2796.729683350436),c(1151.481210916444,2210.484374059721,2671.9161207150546,4681.396958534261,4754.241486945254,5167.954158998869),c(773.8850995444933,1212.8766099425827,1039.4823306784958,2765.267267415531,3153.732515015792,3073.3080683567377),c(643.0349619403519,1064.6175215725295,1022.8672284898286,2689.51330288293,2692.1856117426205,3093.9386238816833),c(900.9966617885163,1766.5447309177534,1693.7019793572692,4302.627135871256,4612.385200415861,4343.3766428612))
targetgene="L22L"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(7.47715072023665,36.01774463227283,43.61464324525157,209.43743135483788,129.520957265968,219.19965245254684),c(14.9543014404733,144.07097852909132,68.53729652825247,525.8216361674654,301.1876228486399,529.9473950470397),c(41.12432896130157,167.52439363847827,111.11349588671234,456.00915904918605,335.1097783230601,709.820051030159),c(119.6344115237864,228.67079731652285,338.53270709409554,657.0294832337349,406.03792158775684,733.6741308558774),c(0.0,2.512865904577174,1.038443886791704,3.4658676583542913,7.1956087369982225,4.512934021081847),c(59.8172057618932,67.00975745539131,79.9601792829612,313.9085850566601,218.95209442580304,430.0181417230845),c(0.0,5.025731809154348,1.038443886791704,13.368346682223695,3.083832315856381,22.564670105409235),c(0.0,15.077195427463046,7.2691072075419285,40.105040046671085,21.586826210994666,23.209374965563782),c(14.9543014404733,26.803902982156526,63.34507709429395,167.8470194545864,109.99001926554425,165.68914905971923),c(18.692876800591623,189.30256481148047,105.92127645275382,333.7135431043989,193.25349179366654,321.0630203569657),c(7.47715072023665,23.45341510938696,28.03798494337601,154.97379672355618,100.73852231797511,127.00685745044626),c(7.47715072023665,15.077195427463046,9.345994981125337,102.9857818482418,26.72654673742197,137.9668400730736),c(272.91600128863774,660.8837329037968,618.9125565278556,1297.7198760780855,1064.950093075737,1591.7762997215827),c(7.47715072023665,20.102927236617393,24.922653283000898,50.50264302173396,32.89421136913473,45.77404507097302),c(74.7715072023665,714.4915388681098,446.53087132043277,1524.9817696758882,1248.9520879218344,1703.9549453884745),c(74.7715072023665,466.555436283162,356.1862531695545,1070.953106431476,914.8702537040597,1244.925084958435),c(52.34005504165655,512.6246445337435,360.3400287167213,1130.863104525886,755.5389173848133,1307.4614563934265),c(71.03293184224817,237.88463896663916,239.88053784888365,654.0587395265741,571.5369225387159,640.8366309936222),c(149.543014404733,709.4658070589555,586.7207960373128,1579.9405282583634,1365.1097718190913,1729.098434934502),c(78.51008256248483,744.645929723036,667.7194192070657,2150.8184439844345,1608.7325247717454,2300.9516458915873),c(112.15726080354975,735.4320880729197,730.026052414568,1942.3712605319836,1428.8423063467899,2027.5967851860582),c(3.738575360118325,113.07896570597285,61.26818932071054,738.7249351806576,487.24550590530816,710.4647558903135),c(29.9086028809466,128.1561611334359,109.03660811312892,701.0955148899538,481.0778412735954,883.2456584117328),c(29.9086028809466,248.77372455314026,155.76658301875563,1161.0656655486875,732.9241470685332,1206.8874982093166),c(3.738575360118325,32.66725675950327,18.691989962250673,49.01727116815355,16.447105684567365,36.103472168654775),c(171.97446656544295,438.0762893646207,450.68464686759955,1206.1219451072934,849.0818309657902,1245.5697898185897),c(29.9086028809466,196.84116252521198,158.88191467913072,546.1217181663976,402.95408927190044,569.9190963766218))
targetgene="G199EfsTer48"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



par(mfrow=c(1,1));
@
%


<<fig=TRUE,echo=FALSE,width=4.5,height=4.5>>=
par(mfrow=c(2,2));

# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(0.0,7.538597713731523,2.076887773583408,27.23181731564086,15.419161579281905,26.43289926633653),c(41.12432896130157,113.07896570597285,82.03706705654463,304.50122998398416,190.16965947781017,297.2089405312473),c(18.692876800591623,55.28304990069783,62.306633207502244,272.81329710760207,153.1636716875336,335.24652728036574),c(0.0,7.538597713731523,21.807321622625786,60.90024599679683,66.81636684355492,97.35043388333698),c(3.738575360118325,35.18012266408044,21.807321622625786,146.55668955326718,78.12375200169498,135.3880206324554),c(14.9543014404733,22.61579314119457,21.807321622625786,145.56644165088022,87.37524894926413,168.26796850033742),c(104.6801100833131,165.8491497020935,209.7656651319242,806.0617925429694,465.65867969431355,967.0572902318243),c(7.47715072023665,25.128659045771744,22.84576550941749,198.04958047738808,96.62674589683327,211.46319413069224),c(14.9543014404733,79.57408697827718,98.6521692452119,512.4532894852416,315.5788403226363,526.0791658861124),c(0.0,38.530610536850006,24.922653283000898,72.28809687424665,68.87225505412584,87.03515612086419),c(3.738575360118325,9.213841650116306,2.076887773583408,20.795205950125748,7.1956087369982225,25.143489546027432),c(29.9086028809466,105.54036799224131,64.38352098108565,359.9551125176528,173.72255379324278,408.7428813379844),c(3.738575360118325,4.188109840961957,4.153775547166816,93.0833028243724,67.84431094884039,83.16692695993689),c(0.0,10.88908558650109,12.461326641500449,102.9857818482418,77.09580789640953,116.04687482781891),c(3.738575360118325,5.025731809154348,2.076887773583408,20.300081998932278,8.223552842283683,19.985850664791034),c(29.9086028809466,45.23158628238914,61.26818932071054,305.9866018375646,226.14770316280126,312.6818571749565),c(145.80443904461467,500.06031501085766,449.64620298080786,1445.2668135337394,994.0219498110401,1369.9978278284177),c(52.34005504165655,101.35225815127936,129.805485848963,467.89213387782934,321.74650495434906,376.50763833025695),c(14.9543014404733,19.265305268425003,15.576658301875561,71.79297292305318,42.145708316703875,61.24696171468221),c(0.0,13.401951491078263,7.2691072075419285,20.300081998932278,22.614770316280126,34.169357588191126),c(0.0,5.025731809154348,6.230663320750224,24.75619755967351,22.614770316280126,26.43289926633653),c(3.738575360118325,8.376219681923914,22.84576550941749,8.912231121482463,4.111776421141841,59.31284713421856),c(14.9543014404733,3.3504878727695657,9.345994981125337,17.329338291771457,21.586826210994666,16.76232636401829),c(0.0,0.8376219681923914,2.076887773583408,11.387850877449814,4.111776421141841,35.45876730850022),c(0.0,1.6752439363847829,1.038443886791704,7.921983219095523,2.0558882105709206,3.2235243007727474),c(0.0,3.3504878727695657,1.038443886791704,23.76594965728657,34.95009957970565,13.53880206324554),c(0.0,10.88908558650109,11.422882754708745,56.93925438724907,17.475049789852825,31.59053814757293),c(7.47715072023665,0.8376219681923914,3.115331660375112,15.843966438191046,3.083832315856381,24.49878468587288),c(22.43145216070995,7.538597713731523,13.499770528292153,32.18305682757556,14.391217473996445,29.65642356710928),c(0.0,25.128659045771744,4.153775547166816,41.095287949058026,24.67065852685105,20.630555524945585))
targetgene="Q331H"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(115.89583616366808,355.15171451357395,192.11211905646525,779.8202231297156,519.1117731691575,1184.967532964062),c(287.870302729111,616.4897685896001,510.91439230151843,1732.4387052259522,1178.0239446571375,2255.8223056807687),c(115.89583616366808,344.26262892707285,252.3418644903841,948.6574904866889,663.023947909122,1172.7181406211255),c(22.43145216070995,82.08695288285436,71.65262818862757,99.51991418988752,59.6207581065567,88.96927070132783),c(67.29435648212984,107.2156119286261,62.306633207502244,65.35636155753807,189.1417153725247,150.86093727616458),c(112.15726080354975,144.90860049728371,221.18854788663296,254.98883486463714,252.87424990022325,192.12204832605576),c(89.7258086428398,252.96183439410223,252.3418644903841,761.0055129843637,703.1137680152549,919.3491305803876),c(265.43885056840105,700.2519654088393,413.30066694309824,1436.354582412257,1340.4391132922403,2064.344962214868),c(153.28158976485133,422.16147196896526,275.1876299998016,1100.1654195518909,699.0019915941131,1188.8357621249893),c(340.2103577707676,717.004404772687,623.0663320750225,1757.6900267368192,1339.4111691869548,2070.1473059562586),c(336.47178241064927,902.9564817113979,663.5656436598989,1931.4785336057273,1761.896196459279,2736.772131356063),c(388.8118374523058,813.3309311148121,613.7203370938971,1774.0291171262038,1561.4470959286143,2176.5236078817593),c(56.07863040177487,85.43744075562392,56.07596988675202,232.21313310973753,274.4610761112179,313.32656203511107),c(74.7715072023665,257.1499442350642,191.07367516967355,462.9408943658946,412.2055862194696,644.060155294395),c(142.06586368449635,359.33982435453595,293.87961996205223,998.1698856060359,901.5069803353487,1043.7771685902158),c(766.4079488242567,1186.0727069604263,1103.8658516595815,2619.7008257646507,2042.5249372022097,3072.663363496583),c(280.3931520088744,588.8482436392512,531.6832700373525,1299.7003718828591,1109.1516896030116,1698.1526016470834),c(605.6492083391686,1151.7302062645383,946.0223808672424,2600.3909916681055,1922.2554768838108,3035.9151864677738),c(471.06049537490895,896.2555059658588,772.6022517730278,2067.6376201839316,1948.9820236212327,2865.7131033869728),c(213.0987955267445,503.41080288362724,443.4155396600576,1348.7176430510128,1151.2973979197156,1793.5689209499567),c(414.98186497313407,598.8997072575598,599.1821226788132,1495.7694565554734,1146.1576773932882,1656.2467857370377),c(97.20295936307645,179.25110119317176,148.4974758112137,954.1038539498171,634.241512961129,1034.751300548052),c(209.3602201666262,412.94763031884895,295.9565077356357,1655.6944927909644,1119.4311306558664,1805.1736084327388),c(123.37298688390472,205.2173822071359,197.3043384904238,1171.4632685237505,731.8962029632478,1110.1817691861343),c(11.215726080354974,13.401951491078263,30.114872716959418,347.0818897866226,349.50099579705653,423.57109312153904),c(52.34005504165655,152.44719821101523,104.8828325659621,707.5321262554689,686.6666623306875,816.1963529556597),c(198.1444940862712,126.48091719705111,171.34324132063117,1238.3050019348689,1175.9680564465666,1326.802602198063))
targetgene="D393N"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(175.71304192556127,943.1623361846327,778.8329150937781,1613.6089569395194,1200.6387149734176,1777.4512994460931),c(29.9086028809466,521.8384861838599,395.6471208676393,740.7054309854313,751.4271409636715,1053.4477414925339),c(254.2231244880461,1069.643253381684,766.3715884522776,2092.393817743605,2205.9680499425976,2823.807287476927),c(37.38575360118325,343.4250069588805,258.5725278111343,1009.0626125322923,684.6107741201166,1202.374564188235),c(145.80443904461467,1129.9520350915361,1117.3656221878737,2854.884702581549,2087.75447783477,4112.572302925872),c(63.555781122011524,1117.38770556865,867.1006454710729,1663.1213520588665,1347.6347220292384,2074.0155351171857),c(239.2688230475728,1056.2413018906057,990.6754679992857,5359.716771669315,4502.395181150317,6544.399035428833),c(93.46438400295813,784.8517841962707,679.1423019617745,3284.6522922174813,2410.5289268944043,3621.951904348259),c(127.11156224402305,939.8118483118632,932.5226103389502,2163.6916667154646,1550.1397107704743,2219.718833512114),c(22.43145216070995,221.13219960279133,152.6512513583805,783.7812147392633,480.04989716831,803.3022557525687),c(59.8172057618932,284.79146918541306,218.07321622625784,639.20502099077,488.27345001059365,713.6882801910863),c(33.64717824106492,900.4436158068208,570.1056938486455,1552.7087109427225,1282.8742433962545,1948.2980873870488),c(85.98723328272148,167.52439363847827,179.6507924149648,170.32263921055375,87.37524894926413,236.60668367671968),c(0.0,0.8376219681923914,0.0,0.0,0.0,0.0),c(7.47715072023665,15.914817395655437,18.691989962250673,49.51239511934702,31.86626726384927,49.642274231900316),c(11.215726080354974,33.504878727695655,21.807321622625786,313.9085850566601,305.2993992697817,288.8277773492382),c(3099.2789735380916,3683.8614161101377,3660.514700940757,6111.810053532196,7073.283388469253,6546.97785486945),c(205.62164480650787,291.4924449309522,285.5720688677186,1949.7981197998856,1748.532923090568,1765.8466119633113),c(0.0,0.8376219681923914,1.038443886791704,3.4658676583542913,0.0,1.289409720309099),c(11.215726080354974,13.401951491078263,10.38443886791704,239.1448684264461,213.81237389937576,217.91024273223775),c(179.4516172856796,257.1499442350642,163.03569022629753,416.39924295370844,312.4950080067799,377.1523431904115),c(1401.9657600443718,1748.9546695857134,1747.701061470438,3505.477574449769,4301.946080619651,4427.832979541447),c(3.738575360118325,16.752439363847827,14.538214415083857,44.56115560741232,42.145708316703875,37.39288188896387),c(56.07863040177487,64.49689155081414,58.15285766033543,498.5898188518245,412.2055862194696,538.3285582290489),c(3308.6391937047174,4079.218985096946,4437.270728260952,7127.309277430003,8098.143661438857,7356.08245436341),c(3.738575360118325,19.265305268425003,13.499770528292153,53.96851068008825,65.78842273826946,49.642274231900316),c(149.543014404733,311.5953721675696,341.64803875447063,1548.7477193331747,1500.7983937167721,1554.383417832619),c(317.7789056100576,2127.559799208674,1991.7353748664884,3716.8955016093805,2782.644693007741,3808.271608932924),c(261.70027520828273,1452.4364928456068,1119.442509961457,2770.2185069274656,2548.273437002656,3026.88931842561),c(310.301754889821,2016.1560774390862,2171.3861672814533,6098.441706849972,5080.099768320745,6900.276118234144))
targetgene="R196P"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(0.0,0.0,1.038443886791704,3.9609916095477615,5.139720526427301,1.9341145804636486),c(3.738575360118325,5.86335377734674,11.422882754708745,13.368346682223695,16.447105684567365,19.985850664791034),c(0.0,0.8376219681923914,9.345994981125337,40.105040046671085,40.089820106132954,69.62812489669135),c(3.738575360118325,6.7009757455391314,4.153775547166816,29.21231312041474,80.17964021226591,38.037586749118425),c(3.738575360118325,1.6752439363847829,1.038443886791704,5.446363463128172,11.307385158140063,2.578819440618198),c(7.47715072023665,85.43744075562392,78.92173539616951,260.4351983277653,151.10778347696268,347.4959196233022),c(14.9543014404733,107.2156119286261,73.729515962211,238.15462052405917,170.6387214773864,308.1689231538747),c(29.9086028809466,53.60780596431305,48.80686267921009,267.86205759566735,192.22554768838108,286.89366276877456),c(0.0,8.376219681923914,4.153775547166816,29.21231312041474,30.83832315856381,14.82821178355464),c(56.07863040177487,134.857136878975,182.76612407533992,510.47279368046776,462.57484737845715,600.2202248038856),c(257.9616998481644,498.3850710744729,394.6086769808476,1127.8923608187251,775.0698553852371,1210.7557273702441),c(63.555781122011524,149.09671033824569,134.99770528292152,416.39924295370844,335.1097783230601,540.2626728095125),c(22.43145216070995,8.376219681923914,42.57619935845987,83.18082380050299,76.06786379112407,38.68229160927297),c(0.0,12.564329522885872,5.19221943395852,11.882974828643285,13.363273368710985,47.70815965143667),c(7.47715072023665,10.88908558650109,15.576658301875561,87.14181541005075,31.86626726384927,34.169357588191126),c(18.692876800591623,48.5820741551587,20.76887773583408,253.99858696225022,195.30938000423745,263.0395829430562),c(11.215726080354974,29.3167688867337,33.23020437733453,210.92280320841832,185.02993895138286,259.1713537821289),c(37.38575360118325,124.80567326066632,103.84438867917041,427.78709383115824,322.77444905963455,489.97569371745766),c(93.46438400295813,322.4844577540707,306.3409466035527,917.9598055126937,765.8183584376679,1117.9182275079888),c(213.0987955267445,319.9715918494935,457.9537540751415,947.1721186331084,729.8403147526768,1087.617099080725),c(138.32728832437803,217.78171173002178,296.9949516224274,904.5914588304701,819.2714519125119,1021.2124984848065),c(672.9435648212985,825.8952606376979,1018.7134529426617,1874.0441552672846,1932.5349179366654,2082.396698299195),c(164.4973158452063,388.6565932412696,328.1482682261785,853.5936918575426,774.0419112799516,895.4950507546693),c(127.11156224402305,351.8012266408044,384.2242381129305,888.2523684410855,962.1556825471908,1012.1866304426428))
targetgene="D208N"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



par(mfrow=c(1,1));
@
%


<<fig=TRUE,echo=FALSE,width=4.5,height=4.5>>=
par(mfrow=c(2,2));

# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(14.9543014404733,34.34250069588805,10.38443886791704,28.71718916922127,29.81037905327835,27.72230898664563),c(0.0,5.86335377734674,0.0,2.970743707160821,1.0279441052854603,1.9341145804636486),c(7.47715072023665,23.45341510938696,28.03798494337601,28.2220652180278,20.558882105709205,65.75989573576405),c(11.215726080354974,25.128659045771744,25.961097169792602,48.02702326576661,47.28542884313117,82.52222209978234),c(11.215726080354974,35.18012266408044,63.34507709429395,49.01727116815355,94.57085768626234,47.70815965143667),c(3.738575360118325,5.025731809154348,6.230663320750224,6.4366113655151125,11.307385158140063,10.315277762472792),c(18.692876800591623,26.803902982156526,23.884209396209194,20.300081998932278,62.70459042241308,32.235243007727476),c(71.03293184224817,73.71073320093045,47.76841879241839,104.96627765301568,87.37524894926413,71.562239477155),c(22.43145216070995,12.564329522885872,38.42242381129305,49.01727116815355,62.70459042241308,51.57638881236396),c(0.0,12.564329522885872,3.115331660375112,48.52214721696008,27.75449084270743,50.93168395220941),c(52.34005504165655,53.60780596431305,65.42196486787736,283.7060240338584,205.58882105709208,402.94053759659346),c(7.47715072023665,27.641524950348916,19.730433849042377,72.28809687424665,56.536925790700316,60.60225685452765),c(14.9543014404733,41.04347644142718,19.730433849042377,38.124544241897205,30.83832315856381,32.879947867882024),c(11.215726080354974,12.564329522885872,22.84576550941749,30.697684973995152,37.00598779027657,106.37630192550067),c(11.215726080354974,67.8473794235837,30.114872716959418,138.13958238297818,89.43113715983505,85.74574640055509),c(3.738575360118325,5.025731809154348,4.153775547166816,98.52966628750056,87.37524894926413,102.50807276457337),c(63.555781122011524,67.8473794235837,114.22882754708745,314.898832959047,285.76846126935794,284.31484332815637),c(22.43145216070995,83.76219681923914,16.615102188667265,210.42767925722484,152.13572758224814,165.04444419956468),c(3.738575360118325,3.3504878727695657,1.038443886791704,23.76594965728657,7.1956087369982225,36.74817702880932),c(0.0,0.8376219681923914,0.0,3.9609916095477615,7.1956087369982225,0.0),c(7.47715072023665,35.18012266408044,19.730433849042377,57.92950228963601,76.06786379112407,48.99756937174576),c(164.4973158452063,221.13219960279133,303.22561494317756,527.8021319722392,476.9660648524536,488.041579136994),c(3.738575360118325,16.752439363847827,15.576658301875561,25.25132151086698,28.78243494799289,42.55052077020027),c(67.29435648212984,146.5838444336685,161.99724633950584,192.6032170142599,152.13572758224814,157.30798587771008),c(0.0,7.538597713731523,6.230663320750224,51.98801487531437,43.17365242198933,44.484635350663915),c(3.738575360118325,8.376219681923914,22.84576550941749,74.76371663021399,98.6826341074042,96.70572902318243),c(0.0,0.0,0.0,6.931735316708583,2.0558882105709206,1.289409720309099),c(44.8629043214199,114.75420964235762,94.49839369804508,111.89801296972426,241.56686474208317,134.0986109121463),c(3.738575360118325,12.564329522885872,1.038443886791704,10.397602975062874,13.363273368710985,10.315277762472792),c(7.47715072023665,8.376219681923914,12.461326641500449,326.2866838364969,245.67864116322502,269.4866315446017),c(7.47715072023665,15.914817395655437,31.153316603751122,12.378098779836755,20.558882105709205,16.76232636401829),c(0.0,0.8376219681923914,1.038443886791704,7.921983219095523,0.0,1.289409720309099),c(7.47715072023665,7.538597713731523,14.538214415083857,23.2708257060931,25.69860263213651,33.52465272803658),c(26.170027520828274,20.102927236617393,25.961097169792602,85.16131960527687,31.86626726384927,75.43046863808229),c(11.215726080354974,6.7009757455391314,36.34553603770964,32.67818077876903,51.39720526427302,36.103472168654775),c(3.738575360118325,10.88908558650109,2.076887773583408,6.931735316708583,3.083832315856381,12.89409720309099),c(11.215726080354974,24.29103707757935,4.153775547166816,20.300081998932278,14.391217473996445,30.301128427263826),c(29.9086028809466,92.13841650116306,106.95972033954553,66.84173341111847,182.97405074081195,139.2562497933827),c(14.9543014404733,89.62555059658588,13.499770528292153,68.32710526469889,42.145708316703875,53.51050339282761),c(18.692876800591623,23.45341510938696,12.461326641500449,207.95205950125748,139.8003983188226,172.13619766126473),c(41.12432896130157,48.5820741551587,52.96063822637691,415.90411900251496,309.4111756909235,361.6794265467023),c(26.170027520828274,45.23158628238914,30.114872716959418,255.48395881583062,154.19161579281905,214.04201357131043),c(26.170027520828274,10.051463618308697,17.65354607545897,73.27834477663359,34.95009957970565,38.037586749118425),c(26.170027520828274,30.154390854926092,33.23020437733453,73.77346872782707,52.425149369558476,75.43046863808229),c(97.20295936307645,107.2156119286261,74.7679598490027,178.24462242964927,187.08582716195377,215.33142329161953),c(11.215726080354974,0.8376219681923914,9.345994981125337,105.46140160420916,83.26347252812229,95.41631930287333),c(82.24865792260314,170.03725954305546,172.3816852074229,783.7812147392633,652.7445068562673,682.742446903668),c(29.9086028809466,95.48890437393263,46.72997490562668,224.78627384183545,197.3652682148084,196.6349823471376),c(0.0,8.376219681923914,13.499770528292153,65.35636155753807,22.614770316280126,70.2728297568459),c(0.0,0.8376219681923914,6.230663320750224,4.456115560741232,1.0279441052854603,1.9341145804636486),c(14.9543014404733,56.12067186889023,32.191760490542826,99.02479023869404,81.20758431755137,38.037586749118425),c(119.6344115237864,220.29457763459894,215.99632845267445,344.1111460794618,362.8642691657675,373.9288188896387),c(26.170027520828274,15.914817395655437,19.730433849042377,31.687932876382092,34.95009957970565,64.47048601545495),c(67.29435648212984,154.12244214740002,85.15239871691973,111.4028890185308,129.520957265968,115.40216996766436),c(0.0,19.265305268425003,11.422882754708745,54.95875858247519,41.11776421141841,59.31284713421856),c(14.9543014404733,12.564329522885872,29.076428830167714,181.71049008800355,76.06786379112407,146.34800325508274),c(3.738575360118325,0.0,2.076887773583408,2.475619755967351,3.083832315856381,2.578819440618198),c(48.60147968153822,80.41170894646957,31.153316603751122,160.42016018668434,100.73852231797511,168.26796850033742),c(0.0,2.512865904577174,1.038443886791704,3.4658676583542913,10.279441052854603,9.025868042163694),c(11.215726080354974,36.855366600465224,21.807321622625786,502.55081046137224,296.04790232221256,391.33585011381155))
targetgene="V97CfsTer52"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(44.8629043214199,182.60158906594134,99.69061313200359,359.45998856645934,284.7405171640725,460.9639750105029),c(56.07863040177487,306.56964035841526,172.3816852074229,746.6469183997531,558.173649170005,852.2998251243145),c(52.34005504165655,557.8562308161327,358.2631409431379,1066.9921148219282,719.5608736998222,1301.6591126520354),c(71.03293184224817,296.5181767401066,238.84209396209195,615.9341952846769,556.117760959434,760.1070301222139),c(0.0,9.213841650116306,5.19221943395852,18.814710145351867,10.279441052854603,14.82821178355464),c(18.692876800591623,128.99378310162828,86.19084260371145,236.1741247192853,177.83433021438464,241.76432255795606),c(0.0,9.213841650116306,1.038443886791704,12.873222731030225,15.419161579281905,17.407031224172837),c(11.215726080354974,72.03548926454566,17.65354607545897,144.5761937484933,107.93413105497334,200.5032115080649),c(29.9086028809466,105.54036799224131,21.807321622625786,194.08858886784031,95.59880179154781,247.56666629934702),c(11.215726080354974,35.18012266408044,12.461326641500449,49.51239511934702,24.67065852685105,42.55052077020027),c(291.60887808922934,775.6379425461545,711.3340624523173,1212.5585564728085,764.7904143323825,1543.4234352099916),c(67.29435648212984,327.510189563225,293.87961996205223,577.8096510427797,482.1057853788809,818.1304675361233),c(142.06586368449635,1093.096668491071,860.8699821503227,2430.0683524575516,1736.1975938271426,2732.259197334981),c(108.41868544343143,1080.532338968185,838.0242166409051,1848.2977098052243,1534.7205491911923,1952.8110214081305),c(194.4059187261529,892.0673961248968,586.7207960373128,1568.0575534297202,1485.3792321374901,1825.8041639576843),c(145.80443904461467,645.8065374763338,600.2205665656049,715.4541094745645,548.9221522224358,775.5799467659231),c(14.9543014404733,41.88109840961957,49.845306566001796,93.0833028243724,87.37524894926413,78.65399293885504),c(149.543014404733,423.83671590535005,451.72309075439125,992.2283981917143,696.9461033835421,1012.1866304426428),c(205.62164480650787,1445.7355171000677,1292.8626390556715,2676.1449562007065,2253.253478785729,2884.4095443314545),c(145.80443904461467,990.9067883715991,887.8695232069069,1757.6900267368192,1249.9800320271197,1851.5923583638662),c(209.3602201666262,933.110872566324,856.7162066031559,1702.2361442031506,1579.9500898237525,2179.747132182532),c(26.170027520828274,299.03104264468374,160.95880245271414,961.5307132177192,571.5369225387159,878.0880195304965),c(7.47715072023665,20.102927236617393,20.76887773583408,104.96627765301568,88.40319305454959,115.40216996766436),c(26.170027520828274,250.44896848952504,170.30479743383947,1238.8001258860625,867.5848248609285,1109.5370643259798),c(0.0,25.128659045771744,19.730433849042377,67.83198131350542,23.642714421565586,55.44461797329126),c(332.7332070505309,636.5926958262174,808.9477878107375,1627.96755152413,1047.475043285884,1407.3907097173817),c(67.29435648212984,298.19342067649137,407.070003622348,1182.3559954500067,732.9241470685332,1121.7864566689161))
targetgene="N200IfsTer47"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D25-REP1","D25-REP2","D25-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



par(mfrow=c(1,1));
@
%__INDIVIDUAL_PAGE__









\end{document}

