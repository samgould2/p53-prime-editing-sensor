pdf(file='D16_NUT_D4_w_controls.pdf',width=4.5,height=4.5);
gstable=read.table('D16_NUT_D4_w_controls.gene_summary.txt',header=T)
# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=3
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("H179PfsTer2","H178TfsTer69","C176Ter","V173Ter","R175C","C176F","C176Y","P177H","P301S","R175H")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='D16-NUT-REP1,D16-NUT-REP2,D16-NUT-REP3_vs_D4-REP1,D4-REP2,D4-REP3 neg.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(57.3831069072757,42.8045779234133,38.083577769478765,3.435702701297968,2.8435225575108034,28.538199327217725),c(52.1664608247961,23.970563637111447,27.097930335975274,54.112317545443,35.544031968885044,1.7836374579511078),c(52.1664608247961,17.121831169365322,18.309412389172483,42.08735809090011,75.3533477740363,13.377280934633308),c(425.1566557220882,57.64349827019658,143.54579313111228,28.344547285708238,76.77510905279169,1354.6726493138665),c(187.79925896926596,70.77023550004333,98.1384504059645,18.03743918181433,28.435225575108035,870.4150794801407),c(239.96571979406204,39.38021168954024,142.08104013997846,288.5990269090293,15.639374066309419,32.997292972095494),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,0.0,0.0,0.0,0.0),c(519.0562852067212,311.0465995768033,437.9611443490058,2448.797100350127,44.07459964141745,82.93914179472651),c(727.7221285059055,238.56418095982346,489.9598755342557,71.29083105193284,79.6186316103025,25.862743140291062),c(738.1554206708648,332.73425239133275,325.9075405272702,27.485621610383745,612.7791111435781,20.51183076643774),c(787.7135584544211,237.42272554853244,198.4740302986297,32.6391756623307,329.8486166712532,117.72007222477312),c(119.98285989703102,171.2183116936532,178.69986491832344,10.307108103893905,39.80931580515125,2.6754561869266618),c(1523.260656084046,806.4382480771066,863.4718882733742,1185.317431947799,4340.637184040242,87.39823543960428),c(740.7637437121045,254.54455671789776,363.25874180118205,37.79272971427765,17.06113534506482,287.1656307301284),c(1103.3206464444374,719.1169091133435,717.7289656555613,261.9723309739701,184.8289662382022,53.50912373853323),c(579.0477151552367,373.8266471978095,443.82015631354096,109.0835607662105,258.7605527334831,540.4421497591857),c(414.72336355712895,325.88551992358657,623.9847742229982,1108.8730468439192,38.387554526395846,16.944555850535526),c(349.5152875261339,340.15371256472434,706.010941726491,45.52306079219808,89.57096056159031,34.7809304300466),c(625.9975298975531,218.01798355658508,464.3266981894142,35.21595268830417,52.60516731394986,707.2122520776143),c(185.19093592802614,162.65739610897054,150.86955808678127,14.601736480516365,12.795851508798615,329.97292972095494),c(5425.311925778794,1118.0555753595554,2057.977952542987,138.28703372724323,2074.349705704131,772.3150192928297),c(2621.3646564460037,527.3524000164518,905.9497250162544,478.42160115574205,2129.7983955755917,827.607780489314),c(273.8739193301795,168.36467316542564,298.077233695728,145.15843912983917,1017.9810755888676,11.593643476682201),c(1184.1786607228714,527.9231277220973,916.935372449758,73.86760807790631,1573.8897355822296,460.1784641513858),c(670.3390215986299,226.00817143562222,414.525096490865,30.921324311681715,102.36681207038892,7.134549831804431),c(712.0721902584668,295.6369515243745,568.3241605599138,1172.4335468179315,35.544031968885044,552.0357932358679),c(1225.9118293827082,506.8062026132135,642.2941866121707,880.3988172076043,1683.3653540463956,146.25827155199084),c(1249.3867367538664,336.7293463308513,445.2849093046748,1060.7732090257477,422.2630997903543,442.34208957187474),c(1246.7784137126266,542.1913203632351,554.4090071441428,140.0048850778922,1839.7590947094898,350.4847604873927),c(339.0819953611746,107.86753636700152,153.79906406904885,8.589256753244921,9.952328951287813,41.02366153287548),c(432.98162484580763,84.46770043553558,191.88264183852763,22.332067558436794,29.856986853863436,413.803890244657),c(179.97428984554654,207.17415714932037,215.3186896966684,307.49539176616815,69.66630265901469,152.50100265481973),c(967.6878482999676,140.96974329444114,487.76274604755497,1339.065127830883,993.8111338500258,1410.8572292393262),c(620.7808838150736,279.0858480606547,242.41662003264366,38.65165538960214,38.387554526395846,8.026368560779986),c(1118.9705846918762,149.5306588791238,233.62810208584088,136.56918237659423,48.33988347768366,15.160918392584417),c(2.608323041239805,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,0.0,0.0,0.0,0.0),c(871.1798957740948,254.54455671789776,355.2026003499462,1491.9538980386426,38.387554526395846,41.02366153287548),c(1338.06972015602,814.9991636617892,656.2093400279418,114.23711481815744,113.74090230043214,1658.7828358945303),c(1040.720893454682,144.9648372339597,443.82015631354096,330.68638499992943,1849.7114236607777,46.374573906728806),c(589.4810073201959,167.22321775413462,280.50019780212244,182.09224316879232,396.6713967727571,684.0249651242499),c(213.882489381664,82.18478961295354,193.34739482966143,560.0195403115688,267.2911204060155,69.5618608600932),c(800.7551736606201,328.1684307461686,339.82269394304126,123.68529724672686,247.3864625034399,26.754561869266617),c(466.88982438192505,337.3000740364968,289.28871574892526,219.02604720774548,136.48908276051856,1027.3751757798382),c(1189.395306805351,894.9010424521607,1225.2658770834225,2729.6657961812357,693.819504032636,1404.6144981364973),c(526.8812543304406,318.466059750195,295.8801042090273,172.6440607402229,62.557496265237674,54.40094246750879),c(532.0979004129202,333.3049800969782,380.8357776947876,32.6391756623307,103.78857334914433,21.403649495413294),c(419.9400096396086,164.94030693155258,350.0759648809779,16.31958783116535,142.17612787554017,318.37928624427275),c(430.3733018045678,452.01634287124443,286.3592097666576,444.0645741427624,150.7066955480726,28.538199327217725),c(234.74907371158244,71.91169091133435,218.9805721745029,13.742810805191873,1.4217612787554017,12.485462205657754),c(5451.395156191192,1878.2648792793757,2202.9884986652332,267.125885025917,3662.4570540739146,854.3623423585807),c(2217.074585053834,1031.3049641014377,1063.4106715631378,217.30819585709648,847.3697221382195,86.50641671062873),c(701.6388980935075,393.8021168954024,364.7234947923159,11.166033779218397,38.387554526395846,8.91818728975554),c(1238.9534445889074,339.58298485907886,848.8243583620363,47.240912142847066,75.3533477740363,263.97834377676395),c(813.7967888668192,692.86343465365,716.2642126644275,294.61150663630076,35.544031968885044,221.17104478593737),c(1173.7453685579121,513.0842073753141,499.4807699766253,218.167121532421,299.99162981738976,67.7782234021421),c(1032.8959243309628,670.605054133475,640.8294336210369,191.54042559736172,42.65283836266205,379.02295981461043),c(962.471202217488,331.0220692743962,256.33177344841476,140.0048850778922,34.12227069012964,32.997292972095494),c(4452.4074313963465,1438.8045459323323,1699.8458462107733,665.6673983764813,843.1044383019532,961.3805898356471))
targetgene="H179PfsTer2"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(112.1578907733116,27.394929870984512,112.05360382173559,1.717851350648984,0.0,7.134549831804431),c(307.78211886629697,71.91169091133435,93.74419143256311,17.178513506489843,41.23107708390665,49.941848822631016),c(78.24969123719414,18.83401428630185,26.365553840408374,17.178513506489843,0.0,22.29546822438885),c(417.3316865983688,100.44807619360988,282.69732728882315,24.908844584410268,25.59170301759723,57.968217383411),c(2190.991354641436,272.8078432985541,856.1481233177053,149.45306750646162,106.63209590665512,65.99458594419099),c(281.6988884538989,134.121010826695,215.3186896966684,8.589256753244921,18.48289662382022,26.754561869266617),c(2613.5396873222844,1042.719518214348,1280.19411425094,687.1405402595936,314.20924260494377,718.8058955542965),c(3143.0292646939647,1949.6058424850644,2630.6963720763024,1414.6505872594385,1356.3602599326532,1407.2899543234241),c(3748.1602102616,1821.1921087148246,2123.891837144008,748.983188882957,2216.525833579671,537.766693572259),c(0.0,0.0,0.0,0.0,0.0,0.0),c(701.6388980935075,173.50122251623526,531.7053357815689,22.332067558436794,294.3045847023682,57.07639865443545),c(936.3879718050899,386.3826567220107,593.9573379047554,102.21215536361456,712.3024006564563,124.85462205657755),c(482.5397626293639,491.3965545607847,466.5238276761149,44.66413511687359,130.80203764549697,396.8593343941215),c(422.5483326808484,107.29680866135601,131.09539270647497,97.0586013116676,85.3056767253241,305.893824038615),c(1142.4454920630346,594.6982692826222,710.4052006998924,76.4443851038798,3375.2612757653237,120.39552841169979),c(198.23255113422516,49.08258268551392,64.44913160988715,14.601736480516365,18.48289662382022,45.48275517775325),c(1275.4699671662645,418.9141359438048,642.2941866121707,315.2257228440886,58.29221242897147,98.10006018731093),c(151.28273639190868,67.34586926617025,79.09666152122513,47.240912142847066,17.06113534506482,8.91818728975554),c(1671.935069434715,661.4734108431469,730.9117425757655,270.561587727215,548.799853599585,360.2947665061238),c(46.94981474231649,50.22403809680494,81.29379100792582,2.576777025973476,4.265283836266205,0.8918187289755539),c(1948.4173118061342,1314.385906101611,1056.8192831030358,359.88985796096216,968.2194308324285,162.31100867355082),c(320.823734072496,108.43826407264703,144.27816962667916,5.153554051946952,12.795851508798615,7.134549831804431),c(352.12361056737365,66.20441385487923,39.548330760612565,21.4731418831123,17.06113534506482,11.593643476682201),c(427.764978763328,175.7841333388173,176.50273543162274,63.56049997401241,351.17503585258424,27.64638059824217),c(722.505482423426,125.56009524201235,303.93624566026324,85.8925675324492,54.02692859270527,18.72819330848663),c(106.941244690832,131.26737229846745,90.81468545029551,19.755290532463317,7.108806393777009,23.187286953364403),c(459.0648552582056,222.01307749610365,197.7416538030628,29.20347296103273,35.544031968885044,146.25827155199084),c(2188.3830316001963,554.1766021817908,610.801997302794,613.2729321816873,681.0236525238374,115.936434766822),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,0.0,0.858925675324492,0.0,0.0))
targetgene="H178TfsTer69"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(41.73316865983688,74.19460173391639,44.67496622958086,18.03743918181433,71.08806393777009,6.242731102828877),c(31.299876494877658,26.253474459693493,57.12536665421815,4.294628376622461,0.0,2.6754561869266618),c(237.35739675282224,76.47751255649843,89.34993245916172,1471.339681830855,12.795851508798615,6.242731102828877),c(693.8139289697881,252.83237360096123,150.13718159121436,1981.5415329736031,142.17612787554017,28.538199327217725),c(3980.3009609319424,1685.358914771193,2055.7808230562864,1214.5209049088317,260.1823140122385,622.4894728249367),c(3964.6510226845035,2535.1724684773585,3677.9947607369686,2228.053201791732,1424.6048013129125,1516.0918392584417),c(5675.710937737816,2110.5510554770985,2919.2527113296605,810.8258375063205,3763.402104865548,856.1459798165317),c(2451.8236587654164,906.8863242707165,1158.6196159868348,510.2018511427483,324.1615715562316,138.23190299121086),c(8367.500316297293,3562.4823386392777,5022.6380065977955,2375.788417947545,2229.32168508847,2621.055244459153),c(4139.40866644757,2147.077628638411,2884.8310160380165,1661.1622560775677,3036.882091421538,2030.6712458773363),c(0.0,0.0,0.0,0.0,0.0,0.0),c(1155.4871072692335,491.3965545607847,632.773292169801,87.61041888309819,558.7521825508728,257.73561267393507),c(845.0966653616968,411.4946757704132,355.93497684551306,140.0048850778922,113.74090230043214,38.34820534594882),c(318.21541103125617,124.98936753636684,194.81214782079522,9.448182428569412,15.639374066309419,43.69911771980214),c(148.67441335066889,67.91659697181576,109.8564743350349,8.589256753244921,41.23107708390665,10.701824747706647),c(2597.8897490748454,741.9460173391639,1004.088175422219,73.86760807790631,1528.3933746620569,1304.7308004912354),c(759.0220050007832,512.5134796696686,469.45333365838246,25.76777025973476,2716.985803701573,36.56456788799771),c(1288.5115823724636,534.201132484198,655.4769635323748,69.57297970128386,44.07459964141745,67.7782234021421),c(62.599752989755316,52.506948919386986,30.027436318242874,65.2783513246614,8.53056767253241,0.8918187289755539),c(73.03304515471453,17.121831169365322,21.23891837144008,121.10852022075338,4.265283836266205,5.3509123738533235),c(3709.0353646430026,770.4824026214394,1078.7905779700427,446.64135116873587,1519.8628069895244,2002.1330465501185),c(161.7160285568679,52.506948919386986,108.3917213439011,0.0,19.904657902575625,9.810006018731093),c(1604.11867036248,1033.0171472183742,704.5461887353572,433.7574660388685,557.3304212721175,316.59564878632165),c(44.341491701076684,46.228944157286364,29.295059822675974,1.717851350648984,7.108806393777009,0.0),c(302.56547278381737,136.40392164927704,103.9974623704997,10.307108103893905,7.108806393777009,122.17916586965089),c(216.49081242290382,45.658216451640854,78.36428502565823,12.88388512986738,7.108806393777009,110.58552239296868),c(320.823734072496,129.55518918153092,216.7834426878022,61.84264862336343,7.108806393777009,216.71195114105961),c(524.2729312892008,146.67702035089624,138.41915766214396,11.166033779218397,86.7274380040795,327.2974735340283),c(0.0,0.0,0.0,0.0,0.0,0.0),c(448.6315630932464,144.9648372339597,242.41662003264366,121.96744589607788,285.77401702983576,24.079105682339957))
targetgene="C176Ter"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1598.9020242800004,596.4104523995586,837.8387109285328,242.21704044150675,208.99890797704404,252.38470030008176),c(912.9130644339317,516.5085736091871,528.0434533037344,115.09604049348194,173.454876008159,329.0811109919794),c(3865.534747117391,2343.4079593804668,2953.674406621305,461.24308764925223,1888.0989781871735,1707.8328659881859),c(2248.3744615487117,762.4922147424022,1125.6626736863243,312.6489458181151,469.18122198928256,217.60376987003517),c(2759.6057776317134,1475.9018467992905,2542.0788161127075,1372.5632291685383,9345.236885259255,1524.1182078192217),c(1932.7673735586955,713.4096320568883,1061.213542076437,304.9186147401947,645.4796205549524,307.6774614965661),c(315.6070879900164,137.5453770605681,186.75600636955932,105.64785806491253,29.856986853863436,36.56456788799771),c(22522.869461105714,7330.997379016585,12793.152624562597,5645.718463907886,7047.670658790526,8464.251556706982),c(1048.5458625784015,311.0465995768033,566.8594075687801,97.0586013116676,102.36681207038892,115.04461603784645),c(7579.786757842873,3773.6515897281165,4960.386004474609,1485.0824926360467,898.5531281734138,2168.011330139572),c(25381.591514304542,8531.237743989093,13405.419374856525,4165.789525323787,7435.811487890751,3833.9287158659063),c(6872.931213666886,3060.8126853768736,3798.8368825055068,923.345100973829,1357.7820212114086,906.0878286391628),c(2647.447886858402,1160.8601532829687,1770.1539897851956,454.3716822466563,358.28384224636125,1873.7111495776387),c(2363.140675363263,776.76040738354,1271.4055963041371,527.3803646492381,621.3096788161106,281.814718356275),c(2110.133340363002,737.9509233996453,1001.1586694399514,380.50407416875,278.66521063605876,368.32113506690376),c(1332.8530740735403,565.0204285890555,555.8737601352766,232.76885801293736,309.9439587686776,254.16833775803286),c(20266.670030433284,6874.415214500176,8465.53991225779,5187.052153284608,7632.014544358996,3684.103169398013),c(32343.20571137358,10588.140395135513,14534.743931020685,5729.893180089686,14858.827124272702,7967.508524667599),c(138.24112118570966,119.85281818555724,117.91261578627079,263.69018232461906,11.374090230043214,87.39823543960428),c(427.764978763328,295.06622381872904,427.7078734110692,106.50678374023701,65.40101882274848,35.67274915902216),c(506.01467000052213,491.3965545607847,355.2026003499462,60.98372294803894,1917.955965041037,57.07639865443545),c(0.0,1.1414554112910213,0.0,0.0,0.0,3.5672749159022157),c(59.99142994851551,11.985281818555723,19.774165380306282,0.858925675324492,4.265283836266205,1.7836374579511078),c(2104.9166942805227,881.774305222314,788.0371092299837,255.95985124669863,1228.401744844667,1529.469120193075),c(427.764978763328,170.64758398800768,192.61501833409451,609.8372294803894,22.748180460086427,51.725486280582125),c(333.865349278695,45.658216451640854,80.56141451235892,27.485621610383745,169.1895921718928,86.50641671062873),c(57.3831069072757,21.116925108883894,41.74546024731326,5.153554051946952,8.53056767253241,8.91818728975554),c(1121.578907733116,469.1381740406098,725.7851071067972,907.8844388179881,399.5149193302679,47.26639263570436),c(550.3561617015988,134.6917385323405,140.61628714884466,12.024959454542888,41.23107708390665,680.4576902083477),c(2107.5250173217623,998.7734848796437,1027.5242232803598,1223.969087337401,686.7106976388591,1245.870764378849))
targetgene="V173Ter"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(52.1664608247961,49.65331039115943,63.71675511432024,4.294628376622461,11.374090230043214,0.0),c(649.4724372687114,49.08258268551392,188.95313585626002,142.58166210386568,7.108806393777009,18.72819330848663),c(3096.0794499516483,2072.8830269044947,2394.8711405037607,1917.1221073242662,1737.3922826391008,896.2778226204317),c(6379.958158872562,2652.742375840334,4017.8174546800096,1320.1687629737444,1669.1477412588415,2876.1154009461616),c(5404.445341448875,2884.457824332411,3787.8512350720034,1477.3521615581262,1633.6037092899567,2188.5231609060093),c(2472.690243095335,1043.2902459199936,1352.699387312063,523.0857362726157,619.8879175373552,552.9276119648434),c(8620.507651297556,3307.93778192138,5079.030996756447,1955.7737627138683,1750.1881341478995,2760.1789661793396),c(3106.5127421166076,1358.3319394363155,1712.2962466354106,1019.5447766101721,1347.8296922601207,624.2731102828877),c(1703.2349459295926,749.936205218201,1176.1966518804404,1059.9142833504231,558.7521825508728,298.7592742068106),c(2498.773473507733,1071.2559034966234,1496.9775569387423,1024.698330662119,1571.0462130247188,426.28935245031477),c(1898.859174022578,567.3033394116376,837.1063344329659,115.95496616880642,553.0651374358513,475.33938254397026),c(837.2716962379774,346.431717326825,355.2026003499462,301.4829120388967,46.91812219892826,143.5828153650642),c(17199.282133935274,7248.812589403631,9675.425882934307,6826.741267479063,10856.569124576248,2716.479848459537),c(10331.567566350866,4254.204317881637,4913.5139087583275,3530.1845255836624,1585.263825812273,1284.2189697247977),c(3769.026794591518,1359.4733948476064,1808.9699440502413,203.56538505190463,1350.6732148176316,251.4928815711062),c(302.56547278381737,129.55518918153092,129.63063971534118,54.97124322076749,35.544031968885044,61.53549229931322),c(1390.236180980816,577.5764381132568,580.0421844889843,383.08085119472344,462.07241559550556,326.40565480505273),c(1661.5017772697556,446.8797935204349,1015.8061993512894,118.5317431947799,659.6972333425064,441.4502708428992),c(117.37453685579122,74.19460173391639,43.94258973401396,14.601736480516365,38.387554526395846,16.944555850535526),c(1392.8445040220558,206.03270173802935,346.41408240314337,37.79272971427765,217.52947564957645,474.4475638149947),c(57.3831069072757,13.126737229846746,39.548330760612565,85.0336418571247,2.8435225575108034,0.8918187289755539),c(1074.6290929907996,437.74815023010666,418.9193554642664,15.460662155840858,21.326419181331026,29.43001805619328),c(1698.018299847113,764.7751255649843,653.2798340456742,727.5100469998448,565.8609889446499,2254.5177468502),c(88.68298340215337,25.68274675404798,24.168424353707678,6.012479727271444,46.91812219892826,2.6754561869266618),c(125.19950597951063,53.077676625032495,46.87209571628156,10.307108103893905,25.59170301759723,8.026368560779986),c(425.1566557220882,147.24774805654175,102.53270937936591,17.178513506489843,68.24454138025928,31.21365551414439),c(0.0,0.0,0.0,0.0,0.0,0.0),c(133.02447510323006,93.59934372586375,94.47656792813001,358.1720066103132,51.18340603519446,141.79917790711306),c(1773.6596680430673,767.6287640932119,1143.23970957993,526.5214389739136,4707.451593959135,181.931020711013),c(730.3304515471453,282.51021429452777,305.400998651397,152.8887702077596,143.59788915429556,191.7410267297441))
targetgene="R175C"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(117.37453685579122,98.16516537102784,26.365553840408374,139.1459594025677,9.952328951287813,24.970924411315508),c(54.774783866035904,43.375305629058815,56.392990158651244,4.294628376622461,24.16994173884183,1.7836374579511078),c(680.7723137635891,247.12509654450614,138.41915766214396,49.817689168820536,28.435225575108035,524.3894126376257),c(328.6487031962154,130.12591688717643,362.5263653056152,43.805209441549096,25.59170301759723,549.3603370489412),c(3119.5543573228065,1258.454590948351,1572.4123359821328,338.41671607784986,838.839154465687,1081.7761182473469),c(3787.2850558801965,1743.573140747035,2531.093168679204,1386.30603997373,945.4712503723422,905.1960099101873),c(2910.888514023622,1242.4742151902767,1548.9762881239922,323.8149795973335,870.1179025983058,557.3867056097212),c(7256.354700729137,3954.5722724177435,4940.611839094303,1562.385803415251,2600.4013788436296,1549.9809509595127),c(1867.5592975277002,1426.8192641137766,1617.0873022117137,495.60011466223193,614.2008724223335,599.3021858715722),c(3620.3523812408494,1871.4161468116295,2671.7094558280487,1381.1524859217832,1927.9082939923246,782.1250253115608),c(0.0,0.0,0.0,0.0,0.0,0.0),c(1152.8787842279937,495.3916485003033,623.2523977274313,44.66413511687359,274.3999267997925,417.37116516055926),c(1220.6951833002286,486.2600052099751,503.8750289500267,134.85133102594526,645.4796205549524,120.39552841169979),c(169.5409976805873,70.19950779439782,80.56141451235892,308.35431744149264,1.4217612787554017,3.5672749159022157),c(670.3390215986299,232.28617619772285,468.7209571628156,49.817689168820536,267.2911204060155,564.5212554415257),c(73.03304515471453,63.350775326651686,46.13971922071466,10.307108103893905,17.06113534506482,94.53278527140871),c(745.9803897945842,345.86098962117944,522.9168178347661,705.177979441408,456.38537048048397,180.1473832530619),c(36.516522577357264,23.399835931465937,41.74546024731326,0.858925675324492,7.108806393777009,0.8918187289755539),c(1090.2790312382385,506.8062026132135,757.277296416174,365.04341201290913,319.89628771996536,503.87758187118794),c(1512.8273639190868,547.8985974196903,708.9404477087586,724.9332699738712,76.77510905279169,246.14196919725288),c(75.64136819595434,71.34096320568884,62.25200212318644,5.153554051946952,7.108806393777009,16.05273712155997),c(198.23255113422516,33.10220692743962,122.30687475967218,8.589256753244921,15.639374066309419,11.593643476682201),c(127.80782902075043,114.14554112910213,76.16715553895753,18.896364857138824,4.265283836266205,159.63555248662416),c(224.3157815466232,97.02370995973682,32.22456580494357,552.2892092336484,0.0,70.45367958906876),c(190.40758201050576,79.33115108472599,82.02616750349273,3.435702701297968,11.374090230043214,8.91818728975554),c(545.1395156191193,155.2379359355789,283.42970378439003,553.1481349089729,11.374090230043214,10.701824747706647),c(628.605852938793,173.50122251623526,276.8383153242879,22.332067558436794,32.70050941137424,400.4266093100237),c(1525.868979125286,206.03270173802935,501.677899463326,413.14324983108065,123.69323125171995,505.6612193291391),c(0.0,0.0,1.4647529911337986,0.0,0.0,0.0),c(1343.2863662384996,838.9697272989007,1260.4199488706338,2791.508444804599,180.563682401936,1505.390014510735))
targetgene="C176F"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(133.02447510323006,33.10220692743962,35.88644828277807,359.0309322856377,240.2776561096629,4.45909364487777),c(193.01590505174556,64.4922307379427,50.53397819411605,5.153554051946952,5.687045115021607,64.21094848623989),c(498.1897008768027,139.82828788315013,191.88264183852763,176.93868911684535,314.20924260494377,19.620012037462185),c(65.20807603099512,10.843826407264704,35.88644828277807,7.730331077920429,4.265283836266205,6.242731102828877),c(3638.610642529528,1353.7661177911514,1650.0442445122242,308.35431744149264,1354.9384986538978,347.809304300466),c(7402.420791038566,3373.5714680706137,4740.673055804539,2289.036924739771,2010.370448160138,2268.786846513809),c(3088.254480827929,1413.69252688393,1534.328758212654,489.5876349349605,911.3489796822125,781.2332065825852),c(6416.47468144992,2402.7636407676,3311.806512953519,1902.5203708437498,1809.9021078556264,1788.0965515959856),c(5156.654652531094,3254.8601052963472,4148.180470890918,2044.2431072722911,7649.075679704061,1862.1175061009567),c(3568.1859204160532,1917.0743632632702,2695.8778801817566,1153.5371819607929,1929.33005527108,1388.5617610149375),c(0.0,0.0,0.0,0.0,0.0,0.0),c(1082.454062114519,343.5780787985974,960.145585688205,29.20347296103273,21.326419181331026,508.3366755160657),c(1017.2459860835239,480.55272815352,769.7276968408112,66.99620267531039,81.0403928890579,155.17645884174638),c(78.24969123719414,52.506948919386986,59.322496140918844,7.730331077920429,0.0,24.079105682339957),c(688.5972828873084,252.83237360096123,411.5955905085974,785.0580672465858,12.795851508798615,30.321836785168834),c(91.29130644339317,35.95584545566717,94.47656792813001,2.576777025973476,99.52328951287812,88.29005416857984),c(644.2557911862318,255.68601212918878,495.08651100322396,140.0048850778922,39.80931580515125,597.5185484136211),c(67.81639907223493,43.946033334704325,35.154071787211166,5.153554051946952,11.374090230043214,9.810006018731093),c(2044.925264332007,439.4603333470432,938.9066673167649,164.054803986978,292.88282342361276,1590.1127937634126),c(1293.7282284549433,710.5559935286608,687.7015293373184,45.52306079219808,62.557496265237674,64.21094848623989),c(67.81639907223493,63.350775326651686,62.25200212318644,1.717851350648984,1.4217612787554017,21.403649495413294),c(88.68298340215337,13.697464935492256,19.041788884739383,5.153554051946952,22.748180460086427,0.0),c(260.83230412398046,102.16025931054641,107.6593448483342,42.08735809090011,173.454876008159,43.69911771980214),c(206.0575202579446,103.87244242748294,88.61755596359482,18.896364857138824,7.108806393777009,82.93914179472651),c(200.84087417546496,40.52166710083126,121.57449826410529,158.04232425970653,253.0735076184615,2.6754561869266618),c(206.0575202579446,139.82828788315013,173.57322944935513,10.307108103893905,11.374090230043214,8.026368560779986),c(365.1652257735727,71.91169091133435,209.4596777321332,146.01736480516365,25.59170301759723,26.754561869266617),c(367.7735488148125,329.3098861574597,320.7809050583019,42.08735809090011,594.2962145197579,53.50912373853323),c(0.0,0.0,0.0,0.0,0.0,0.0),c(1833.651097991583,1029.0220532788558,1538.7230171860556,1602.7553101555022,766.3293292491616,907.8714660971139))
targetgene="C176Y"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(213.882489381664,164.94030693155258,173.57322944935513,35.21595268830417,499.038208843146,16.05273712155997),c(130.41615206199023,51.36549350809596,43.21021323844706,6.871405402595936,5.687045115021607,9.810006018731093),c(623.3892068563133,154.09648052428787,272.44405635088657,17.178513506489843,73.93158649528088,20.51183076643774),c(1267.6449980425452,256.2567398348343,407.201331535196,12.88388512986738,399.5149193302679,34.7809304300466),c(3787.2850558801965,1321.2346385693572,1527.004993256985,608.1193781297403,1278.163389601106,727.724082844052),c(3980.3009609319424,2051.1953740899653,3126.5152595750933,1419.8041413113854,1764.4057469354534,878.4414480409206),c(7459.8038979458415,3048.2566758526723,4855.656165608542,2682.4248840383884,2010.370448160138,3083.9091647974656),c(294.74050366009794,126.13082294765786,100.33557989266521,180.37439181814332,90.99272184034571,38.34820534594882),c(2344.8824140745846,398.93866624621194,784.3752267521492,267.98481070124154,82.4621541678133,102.5591538321887),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,0.0,0.0,0.0,0.0),c(1799.7428984554654,180.9206826896269,702.3490592486564,191.54042559736172,41.23107708390665,45.48275517775325),c(1220.6951833002286,518.7914844317692,815.8674160615259,47.240912142847066,1047.8380624427311,1417.9917790711306),c(140.84944422694946,88.46279437505416,53.46348417638365,26.626695935059253,24.16994173884183,4.45909364487777),c(380.8151640210115,211.16925108883896,210.1920542277001,58.40694592206546,467.75946071052715,23.187286953364403),c(88.68298340215337,33.67293463308513,41.74546024731326,2.576777025973476,118.00618613669835,19.620012037462185),c(983.3377865474064,517.0793013148327,688.4339058328853,42.08735809090011,2483.8169539856867,39.24002407492437),c(354.7319336086135,429.7579623510695,375.70914222581933,25.76777025973476,78.19687033154709,74.02095450497097),c(1862.3426514452206,672.8879649560571,752.1506609472056,347.86489850641925,177.7201598444252,4305.700823493974),c(70.42472211347473,23.970563637111447,13.915153415771087,3.435702701297968,11.374090230043214,0.0),c(18.258261288678632,9.70237099597368,12.450400424637289,0.858925675324492,0.0,33.88911170107105),c(1828.4344519091032,619.2395606253791,941.8361732990326,79.02116212985327,1224.1364610084008,75.80459196292209),c(2770.0390697966727,530.776766250325,1169.6052634203381,4017.1953834926494,405.2019644452895,1169.1743536869512),c(112.1578907733116,86.75061125811763,95.2089444236969,7.730331077920429,9.952328951287813,12.485462205657754),c(169.5409976805873,62.780047621006176,82.02616750349273,3.435702701297968,4.265283836266205,37.45638661697326),c(3309.9619393333123,1831.4652074164437,2723.7081870132984,1803.7439181814334,1612.2772901086255,1353.780830584891),c(7483.278805317,3166.3973109212934,4504.847824231998,1813.1921006100026,1417.4959949191355,2613.028875898373),c(5380.970434077717,1776.1046199688292,2604.330818235894,1530.6055534282448,982.4370436199825,914.1141971999427),c(148.67441335066889,45.658216451640854,77.63190853009132,8.589256753244921,27.013464296352634,3.5672749159022157),c(135.63279814446986,10.843826407264704,74.70240254782374,59.26587159738995,54.02692859270527,8.91818728975554))
targetgene="P177H"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3333.4368467044706,961.10545630704,1100.0294963414829,785.0580672465858,149.28493426931718,75.80459196292209),c(159.10770551562808,118.71136277426622,98.8708269015314,20.61421620778781,29.856986853863436,164.09464613150192),c(2110.133340363002,1579.7742892267736,1416.4161424263832,1171.5746211426072,3770.5109112593254,299.6510929357861),c(1468.4858722180102,521.0743952543512,635.7027981520686,71.29083105193284,935.5189214210543,32.997292972095494),c(200.84087417546496,208.8863402662569,216.7834426878022,31.780249987006204,561.5957051083836,16.05273712155997),c(146.06609030942906,202.6083355041563,134.75727518430946,101.35322968829006,15.639374066309419,22.29546822438885),c(725.1138054646658,224.2959883186857,277.57069181985486,46.38198646752257,206.15538541953325,46.374573906728806),c(1622.3769316511587,833.8331779480911,1056.8192831030358,200.12968235060666,44.07459964141745,2117.177662587965),c(20.86658432991844,3.424366233873064,10.253270937936591,0.858925675324492,4.265283836266205,0.8918187289755539),c(26.08323041239805,1.1414554112910213,2.9295059822675973,16.31958783116535,1.4217612787554017,0.0),c(811.1884658255793,700.8536225326872,533.1700887727027,45.52306079219808,61.13573498648228,138.23190299121086),c(1747.5764376306693,492.5380099720757,524.3815708258999,974.8806414932985,133.64556020300776,44.5909364487777),c(631.2141759800328,90.7457051976362,195.54452431636213,27.485621610383745,4.265283836266205,30.321836785168834),c(873.7882188153346,507.9476580245045,634.9704216565017,310.0721687921416,157.8155019418496,1498.2554646789306),c(299.95714974257754,337.3000740364968,309.0628811292315,262.8312566492946,723.6764908864994,49.050030093655465),c(221.7074585053834,179.77922727833587,123.77162775080599,140.0048850778922,2.8435225575108034,40.13184280389993),c(41.73316865983688,32.53147922179411,35.88644828277807,4.294628376622461,18.48289662382022,31.21365551414439),c(1160.7037533517132,428.045779234133,425.5107439243685,36.07487836362866,61.13573498648228,49.941848822631016),c(448.6315630932464,85.03842814118109,105.4622153616335,6.871405402595936,18.48289662382022,273.78834979549504),c(1478.9191643829693,821.8478961295353,801.2198861501879,44.66413511687359,850.2132446957302,2517.604271897989),c(1345.8946892797394,286.50530823404637,537.5643477461041,827.1454253374858,277.24344935730335,672.4313216475676),c(352.12361056737365,240.27636407676,227.0367136257388,133.99240535062077,277.24344935730335,197.0919391035974),c(5691.360875985254,3242.304095772146,2758.8622588005096,2909.1812623240544,2144.016008363146,2280.3804899904912),c(294.74050366009794,349.85608356069804,151.60193458234815,626.1568173115547,5.687045115021607,8.026368560779986),c(239.96571979406204,164.94030693155258,81.29379100792582,9.448182428569412,1.4217612787554017,2.6754561869266618),c(756.4136819595434,340.7244402703699,377.17389521695316,35.21595268830417,548.799853599585,90.9655103555065),c(850.3133114441764,311.0465995768033,329.5694230051047,18.896364857138824,81.0403928890579,180.1473832530619),c(2900.455221858663,1322.9468216862938,1213.5478531543522,764.4438510387979,216.10771437082107,1046.9951878173003),c(166.9326746393475,143.25265411702318,134.02489868874258,8.589256753244921,5.687045115021607,3.5672749159022157),c(1564.993824743883,519.9329398430602,916.202995954191,855.489972623194,453.54184792297315,324.62201734710163))
targetgene="P301S"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(117.37453685579122,38.23875627824921,39.548330760612565,14.601736480516365,5.687045115021607,1.7836374579511078),c(819.0134349492987,217.44725585093957,253.40226746614715,193.25827694801072,167.76783089313741,263.97834377676395),c(1898.859174022578,1063.2657156175865,1412.7542599485487,590.081938947926,602.8267821922904,692.0513336850298),c(3396.036599694226,1964.4447628318478,2622.6402306250666,7253.627328115335,2226.4781625309593,1053.2379189201292),c(3257.795478508516,949.1201744884843,1220.8716181100212,664.8084727011568,772.0163743641831,630.5158413857166),c(6153.0340542847,2920.413669788078,3500.027272314212,1373.4221548438627,1215.6058933358684,2070.803088681236),c(3119.5543573228065,1115.2019368313279,1461.091108655964,757.572445636202,695.2412653113914,604.6530982454256),c(6087.825978253704,2412.4660117635735,3527.8575791457542,862.36137802579,1509.9104780382365,852.5787049006295),c(224.3157815466232,155.80866364122443,125.96875723750668,18.896364857138824,22.748180460086427,11.593643476682201),c(472.10647046440465,188.3401428630185,87.88517946802791,242.21704044150675,42.65283836266205,35.67274915902216),c(1098.1040003619578,293.924768407438,465.05907468498106,133.13347967529626,76.77510905279169,11.593643476682201),c(1854.5176823215013,1050.1389783877396,1505.033698389978,1688.6478776879514,1451.618265609265,1937.9220980638786),c(3109.121065157847,1227.064567137848,1611.9606667427454,612.4140065063629,1885.2554556296627,1351.1053743979642),c(2206.641292888875,861.7988355247211,1017.2709523424231,504.18937141547684,312.78748132618836,623.3812915539122),c(9165.647166916675,3210.914071961643,5228.435801852094,2127.558897778767,3480.4716103932233,1038.9688192565204),c(18065.245383626887,6278.575489806263,8881.529761739788,4487.886653570471,11981.18229607177,2877.8990384041126),c(594.6976534026755,247.69582425015165,256.33177344841476,310.9310944674661,142.17612787554017,87.39823543960428),c(1257.211705877586,494.82092079465775,510.4664174101288,164.91372966230247,251.6517463397061,304.1101865806639),c(1724.101530259511,1051.8511615046762,1234.0543950302254,323.8149795973335,730.7852972802765,1957.5421101013408),c(1064.1958008258405,488.5429160325571,546.3528656929069,632.1692970388261,210.42066925579945,254.16833775803286),c(0.0,0.0,0.0,0.0,0.0,0.0),c(1064.1958008258405,279.65657576630025,438.6935208445727,54.97124322076749,115.16266357918754,41.91548026185104),c(33.908199536117465,20.546197403238384,13.182776920204187,1.717851350648984,1.4217612787554017,16.05273712155997),c(1064.1958008258405,215.73507273400304,451.14392126920995,21.4731418831123,260.1823140122385,758.0459196292209),c(119.98285989703102,45.658216451640854,41.013083751746365,9.448182428569412,7.108806393777009,2.6754561869266618),c(127.80782902075043,149.5306588791238,102.53270937936591,290.31687825967833,24.16994173884183,6.242731102828877),c(177.36596680430674,164.36957922590707,91.54706194586241,0.858925675324492,15.639374066309419,3.5672749159022157),c(328.6487031962154,98.16516537102784,78.36428502565823,18.03743918181433,4.265283836266205,15.160918392584417),c(140.84944422694946,62.780047621006176,26.365553840408374,2.576777025973476,2.8435225575108034,10.701824747706647),c(1220.6951833002286,381.2461073712011,617.3933857628962,51.53554051946952,443.5895189716853,32.997292972095494))
targetgene="R175H"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=9
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("I254_I255insH","E294SfsTer51","E198_G198del","G244A","E271_V272insQL*","I255F","L22L","N345S","G244R","G293EfsTer13")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='D16-NUT-REP1,D16-NUT-REP2,D16-NUT-REP3_vs_D4-REP1,D4-REP2,D4-REP3 pos.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(208.6658432991844,360.1291822623172,254.86702045728097,1292.6831413633606,271.5564042422817,1112.0979550325158),c(101.7245986083524,131.83810000411296,95.2089444236969,301.4829120388967,71.08806393777009,72.23731704701987),c(492.9730547943231,430.32869005671506,186.75600636955932,88.46934455842268,169.1895921718928,46.374573906728806),c(10631.524716093445,11755.849280886228,13371.730056060447,171734.45845005426,171376.26101861862,110711.26883375423),c(1251.9950597951063,1324.6590048032303,1513.089839841214,23848.930301059845,24516.851490858146,18573.90866837386),c(391.2484561859707,513.6549350809596,636.4351746476356,12077.353920737683,7135.8198580733615,5394.611491573126),c(5868.726842789561,15575.729814771632,18423.66312248092,233939.5737084046,273116.0763650764,184037.49654885326),c(6763.381645934814,15082.62107709391,15636.2381803533,104733.96114636726,121913.18613071818,71256.31644514676),c(3547.3193360861346,7756.18951972249,7607.92703594895,16138.35451367188,23788.909716135382,16493.295573673895),c(31.299876494877658,17.121831169365322,9.520894442369691,29.20347296103273,11.374090230043214,18.72819330848663),c(466.88982438192505,115.28699654039316,295.8801042090273,97.0586013116676,314.20924260494377,34.7809304300466),c(33.908199536117465,27.965657576630022,54.92823716751745,364.18448633758464,75.3533477740363,315.70383005734607),c(253.00733500026107,387.52411213330174,233.62810208584088,8822.025611257857,5414.0669495005695,1800.5820138016434),c(206.0575202579446,190.05232597995504,255.59939695284785,888.9880739608493,760.6422841341399,714.3468019094187),c(44.341491701076684,31.960751516148598,31.49218930937667,52.39446619479401,38.387554526395846,23.187286953364403),c(6792.073199388452,18306.091158579755,21377.337529102224,408792.7912855621,522558.40567759663,269406.84438003815),c(7598.045019131551,14053.028296109409,16241.18116569156,140311.52154398305,163395.91496096455,107032.51657673008),c(4825.397626293639,10549.33091115162,11487.325332966815,62627.706690610015,65723.75863302595,46456.62122979455),c(52.1664608247961,25.68274675404798,18.309412389172483,34.357027012979685,63.97925754399308,57.07639865443545),c(766.8469741245026,301.91495628647516,363.99111829674894,635.6049997401241,5291.7954795276055,343.3502106555883),c(46.94981474231649,23.970563637111447,25.633177344841478,23.190993233761287,63.97925754399308,173.01283342125745),c(299.95714974257754,101.5895316049009,109.8564743350349,39.51058106492663,22.748180460086427,46.374573906728806),c(1356.3279814446985,601.5470017503683,606.4077383293926,377.068371467452,378.18850014893684,409.3447965997793),c(1463.2692261355305,1077.533908258724,1379.7973176480384,207.00108775320257,2943.0458470236817,700.0777022458099),c(13.041615206199024,15.980375758074299,22.70367136257388,15.460662155840858,0.0,106.12642874809092),c(5.21664608247961,2.8536385282275534,3.6618824778344967,3.435702701297968,49.76164475643906,8.026368560779986),c(333.865349278695,172.3597671049442,188.22075936069314,199.27075667528214,45.496360920172854,44.5909364487777))
targetgene="I254_I255insH"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1653.6768081460364,1942.1863823116728,2098.2586597991667,3430.549147246021,3752.0280146355053,3717.1004623701087),c(349.5152875261339,549.6107805366267,485.56561656085427,860.6435266751411,763.4858066916507,923.9242032186738),c(1619.7686086099188,1880.5477901019576,1718.155258599946,2477.141647635835,2489.5039991007084,2277.7050338035647),c(819.0134349492987,845.2477320610013,768.9953203452443,1321.0276886490688,713.7241619352117,894.4941851624806),c(1831.042774950343,1774.9631645575382,2060.9074585252547,2587.08413407737,2647.319501042558,2176.929517429327),c(289.52385757761834,372.11446408087295,342.7521999253089,608.1193781297403,270.13464296352635,636.7585724885455),c(7.8249691237194146,63.350775326651686,49.06922520298225,110.80141211685947,39.80931580515125,170.3373772343308),c(219.09913546414361,396.0850277179844,327.372293518404,964.5735333894046,379.61026142769225,428.96480863724145),c(114.7662138145514,256.2567398348343,175.03798244048895,351.30060120771725,206.15538541953325,403.1020654969504),c(59.99142994851551,126.13082294765786,75.43477904339063,110.80141211685947,173.454876008159,275.57198725344614),c(59.99142994851551,168.36467316542564,100.33557989266521,175.22083776619638,102.36681207038892,211.36103876720628),c(2.608323041239805,43.946033334704325,23.43604785814078,60.98372294803894,25.59170301759723,107.01824747706647),c(286.9155345363785,607.8250065124689,490.69225202982255,749.8421145582815,652.5884269487294,1170.0661724159268),c(0.0,3.9950939395185747,0.7323764955668993,0.0,0.0,1.7836374579511078),c(174.75764376306694,384.0997458994287,295.1477277134604,825.4275739868368,663.9625171787726,618.0303791800588),c(46.94981474231649,190.05232597995504,130.36301621090809,324.673905272658,494.7729250068798,451.2602768616303),c(221.7074585053834,461.7187138672181,464.3266981894142,672.5388037790773,870.1179025983058,708.9958895355653),c(28.69155345363785,101.5895316049009,68.11101408772164,153.74769588308408,204.73362414077783,230.98105080466846),c(229.5324276291028,419.48486364945035,358.86448282778065,864.9381550517635,617.0443949798444,814.2304995546807),c(996.3794017536054,1434.8094519928138,1349.0375048342285,2610.275127311131,2554.905017923457,2594.3006825898865),c(2720.4809320131167,3163.5436723930657,3287.638088599811,7497.562219907491,8952.830772322764,6107.174656024593),c(242.57404283530184,87.89206666940865,109.12409783946799,623.5800402855813,118.00618613669835,18.72819330848663),c(367.7735488148125,214.0228896170665,358.13210633221377,43.805209441549096,446.43304152919615,64.21094848623989),c(2.608323041239805,0.0,1.4647529911337986,0.0,0.0,4.45909364487777),c(0.0,0.0,0.0,0.0,0.0,0.0),c(242.57404283530184,397.22648312927544,253.40226746614715,746.4064118569836,435.0589512991529,865.9559858352628),c(46.94981474231649,116.99917965732969,62.25200212318644,96.1996756363431,73.93158649528088,243.46651301032622),c(352.12361056737365,525.0694891938698,467.98858066724864,700.8833510647855,432.21542874164214,662.6213156288366),c(7.8249691237194146,3.9950939395185747,5.859011964535195,15.460662155840858,1.4217612787554017,0.0),c(0.0,1.712183116936532,0.7323764955668993,0.0,0.0,0.8918187289755539),c(1205.0452450527898,1325.2297325088757,1289.7150086933098,2589.6609111033436,1346.4079309813653,2539.8997401223774),c(727.7221285059055,1091.802100899862,935.2447848389304,1564.9625804412244,1726.0181924090577,1536.6036700248794),c(1930.1590505174556,2099.707229069834,2395.603516999328,4972.320734453485,2537.843882578392,2273.245940158687),c(1977.108865259772,1955.3131195415197,2528.8960391925034,3750.928424142057,3045.4126590940705,3742.0713867814243),c(412.1150405158892,626.6590207987707,566.8594075687801,1727.2995330775534,867.274380040795,696.5104273299077),c(983.3377865474064,1356.0490286137333,1098.564743350349,2520.9468570773843,1407.5436659678476,1785.421095409059),c(1231.1284754651879,1572.9255567590274,1466.9501206204993,4115.112910479641,2589.0272886135863,3415.6657319763717),c(461.67317829944545,743.6582004561004,615.9286327717623,1441.2772831944976,1116.0826038229904,1090.6943055371025),c(1562.385501702643,1893.103799626159,2227.889299514508,4126.27894425886,3225.9763414960066,3734.045018220644),c(198.23255113422516,537.0547710124256,457.73530972931206,711.1904591686795,720.8329683289886,1218.2243837806066),c(44.341491701076684,156.95011905251545,68.11101408772164,188.10472289606375,89.57096056159031,352.2683979453438),c(302.56547278381737,691.7219792423589,488.49512254312185,1392.3185197010016,717.9894457714779,890.9269102465784),c(198.23255113422516,426.904323822842,379.37102470365386,909.6022901686371,501.8817314006568,1011.3224386582782),c(91.29130644339317,228.29108225820426,175.77035893605583,506.7661484414503,160.65902449936038,560.9539805256234),c(75.64136819595434,191.19378139124606,115.71548629957009,539.405324103781,157.8155019418496,428.96480863724145),c(93.89962948463298,199.75469697592874,162.58758201585164,112.51926346750845,231.7470884371305,269.3292561506173),c(75.64136819595434,145.53556493960522,91.54706194586241,115.95496616880642,181.98544368069142,133.77280934633308),c(28.69155345363785,66.20441385487923,38.81595426504566,68.71405402595937,39.80931580515125,149.82554646789305),c(341.69031840241445,682.0196082463852,686.2367763461847,986.0466752725168,770.5946130854277,1002.4042513685226),c(172.1493207218271,350.99753897198906,268.04979737748516,925.9218779998024,291.46106214485735,1326.1344499866486),c(2.608323041239805,7.419460173391639,21.23891837144008,58.40694592206546,4.265283836266205,131.09735315940642),c(208.6658432991844,216.30580043964855,173.57322944935513,69.57297970128386,120.84970869420914,16.944555850535526),c(701.6388980935075,1393.7170571863371,1188.6470523050775,1930.8649181294581,2455.381728410579,3246.220173471016),c(5.21664608247961,4.565821645164085,14.647529911337987,20.61421620778781,2.8435225575108034,11.593643476682201),c(362.5569027323329,861.7988355247211,654.0122105412411,1742.7601952333944,1923.6430101560586,1449.205434585275),c(245.18236587654167,745.370383573037,612.9991267894948,1608.7677898827735,976.749998504961,1274.4089637060665),c(153.89105943314848,390.9484783671748,355.2026003499462,1056.4785806491252,1108.9737974292134,900.7369162653094),c(52.1664608247961,173.50122251623526,121.57449826410529,490.44656061028496,163.5025470568712,605.5449169744011),c(2712.655962889397,2542.59192865075,3460.4789415535993,7106.751037634847,10826.712137722385,6350.64116903492),c(628.605852938793,1095.226467133735,939.6390438123318,1474.7753845321529,1798.528017625583,1851.41568135325))
targetgene="E294SfsTer51"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(7.8249691237194146,104.44317013312845,73.23764955668993,366.7612633635581,69.66630265901469,499.4184882263102),c(13.041615206199024,126.13082294765786,68.84339058328854,220.74389855839445,102.36681207038892,287.1656307301284),c(28.69155345363785,170.07685628236217,110.5888508306018,185.5279458700903,173.454876008159,294.3001805619328),c(83.46633731967376,239.70563637111448,194.0797713252283,303.20076338954567,211.84243053455486,546.6848808620146),c(2.608323041239805,7.419460173391639,5.859011964535195,1.717851350648984,15.639374066309419,30.321836785168834),c(49.55813778355629,91.31643290328171,88.61755596359482,116.81389184413092,89.57096056159031,186.39011435589077),c(0.0,30.248568399212065,8.788517946802791,17.178513506489843,14.217612787554017,70.45367958906876),c(15.649938247438829,42.8045779234133,51.266354689682956,35.21595268830417,120.84970869420914,136.44826553325976),c(13.041615206199024,69.0580523831068,49.801601698549156,49.817689168820536,514.6775829094554,179.25556452408634),c(0.0,26.824202165339003,36.618824778344965,66.99620267531039,996.6546564075365,97.20824145833538),c(41.73316865983688,195.75960303641017,121.57449826410529,265.40803367526803,86.7274380040795,373.67204744075707),c(18.258261288678632,76.47751255649843,53.46348417638365,44.66413511687359,48.33988347768366,134.66462807530866),c(15.649938247438829,47.37039956857738,84.95567348576031,91.90504725972065,145.01965043305097,127.5300782435042),c(93.89962948463298,419.48486364945035,391.08904863272426,609.8372294803894,723.6764908864994,881.1169042278473),c(54.774783866035904,284.7931251171098,277.57069181985486,266.2669593505925,2800.8697191481415,481.58211364679914),c(242.57404283530184,868.0768402868217,947.6951852635677,1327.0401683763403,1470.1011622330855,2145.715861915183),c(78.24969123719414,578.1471658189023,569.7889135510477,1123.4747833244355,1302.333331339948,1776.5029081193034),c(127.80782902075043,704.2779887665602,774.8543323097795,1194.7656143763684,1180.0618613669835,1313.6489877809909),c(156.49938247438828,548.4693251253358,347.8788353942772,771.3152564413939,480.5553122193258,731.2913577599542),c(91.29130644339317,521.0743952543512,378.638648208087,607.2604524544158,344.0662294588072,717.0222580963454),c(10.43329216495922,134.6917385323405,104.7298388660666,272.27943907786397,484.820596055592,376.34750362768375),c(114.7662138145514,805.8675203714611,558.8032661175441,1183.59958059715,1202.8100418270699,859.7132547324339),c(20.86658432991844,87.89206666940865,64.44913160988715,100.49430401296557,108.05385718541054,264.87016250573953),c(23.474907371158245,119.28209047991173,127.43351022864049,417.43787820770314,308.5221974899222,318.37928624427275),c(18.258261288678632,39.95093939518575,35.154071787211166,29.20347296103273,73.93158649528088,106.12642874809092),c(138.24112118570966,396.6557554236299,645.2236925944383,802.2365807530756,1089.0691395266376,1002.4042513685226),c(18.258261288678632,95.31152684280028,182.36174739615794,213.01356748047402,264.4475978485047,475.33938254397026),c(365.1652257735727,1627.7154165009965,2142.2012495331805,2291.6137017657447,3845.8642590333616,3710.85773126728),c(764.2386510832628,2368.5199784288693,2670.2447028369147,4340.151437414658,5330.183034054001,2356.1850819534134),c(266.0489502064601,1457.6385602186342,1806.0404380679738,3422.818816168101,3750.6062533567497,2739.6671354129016))
targetgene="E198_G198del"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(6257.366975934292,6925.780708008272,9711.312331217085,36006.164309602704,31868.77906330233,27995.081721271614),c(8492.699822276805,9883.862406368953,11165.812051412948,28113.49627904595,24316.383150553636,21291.280335562373),c(7937.127014492726,7309.309726202056,7919.187046564883,35114.599458615885,32249.811086008776,30744.558862703245),c(5873.943488872041,5151.388271156379,4862.247554068645,23283.75720669633,19357.279810254793,15137.731105631052),c(5560.944723923264,5947.553420531866,7091.601606574286,21734.255288410946,16291.962493258148,16058.088033933824),c(3589.0525047459714,3512.829028248118,3754.1619162759257,11063.821623854781,8169.440307728538,7239.784441823546),c(7579.786757842873,8333.765957835747,7978.509542705801,14414.490683295626,13883.498887046497,12403.414882592004),c(3654.2605807769664,3596.1552732723626,2958.8010420902733,4328.126477960115,5429.706323566879,4356.534491045581),c(12084.360650064016,12236.402009039748,14364.832584049163,64437.463088518714,86730.28152663702,54674.730817304284),c(902.4797722689725,1058.6998939724224,1026.7918467847928,4389.110200908154,2368.654290406499,3652.889513883869),c(1893.6425279400983,2176.7554693319776,2685.62460924382,10792.401110452243,6786.0665834995325,9534.434031477647),c(1750.184760671909,1896.528165860032,2380.2236105924226,8350.475415504712,10091.66155660584,6627.1049750173415),c(2193.599677682676,1677.9394545978014,1584.8627364067702,3431.4080729213456,5739.650282335557,3762.583217547862),c(1327.6364279910606,1362.8977610814795,1575.3418419644004,5339.940923492367,7984.611341490336,5025.398537777246),c(1635.4185468573576,1847.445583174518,2347.2666682919125,10288.211739036766,11462.239429326048,10541.297376491048),c(1966.6755730948128,1435.9509074041048,1223.8011240922888,2191.9783234281035,1980.5134613062746,1393.9126733887908),c(2402.2655209818604,1715.607483170405,1537.2582641949216,6564.768936505093,7312.118256639031,4492.090937849865),c(1846.6927131977818,2179.03838015456,2873.112992108946,13169.907379750437,15207.158637567776,10670.611092192503),c(7052.905503512432,10257.118325861118,10574.784219490459,8377.102111439772,13451.283458304855,11592.751657953226),c(1095.495677320718,1214.5085576136466,1002.6234224310851,1485.9414183113713,2088.567318491685,1990.5394030734365),c(9123.913998256838,10723.4028613735,13452.291470572807,17522.08377661964,20036.881701499875,20614.38992026993),c(1711.059915053312,1479.8969407388092,1416.4161424263832,1203.3548711296135,1229.8235061234225,1683.7537603058458),c(5897.418396243199,6389.296664701492,6303.564497344302,4736.975099414573,7747.1772079381835,10881.97213095971),c(9893.369295422579,10246.274499453853,10087.021473442905,11861.763576231235,19594.713943806946,19087.59625626378),c(9040.447660937163,8752.109366073906,8781.92655834269,20049.90203909962,25597.390062712253,16704.6566124411),c(14468.367909757197,14670.555673617851,17171.299315061522,69078.23851229694,79880.23568559349,46852.5887454597),c(13571.104783570705,15019.841029472904,15032.759948006176,41506.72433438076,39129.71391390617,30136.33848954192),c(12778.174579033805,16557.38146848191,17517.713397464664,34247.08452653815,40042.484654867134,31797.796781623376),c(1345.8946892797394,1552.3793593557891,1395.1772240549433,1971.2344248697093,1838.3373334307344,1282.4353322668464),c(6580.799033048028,8044.977738779118,7952.143988865393,16073.935088022545,10859.412647133759,12672.74413874262))
targetgene="G244A"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(4981.897008768027,2044.9173693278647,4550.987543452712,7163.440132206264,27873.62986999965,16392.52005729966),c(2292.7159532497885,1253.888769303187,1968.6280200838253,1806.3206952074067,11581.667376741503,7798.062966162243),c(2071.008494744405,1063.2657156175865,1527.737369752552,2935.807958259114,14999.581490869488,5528.384300919459),c(4754.972904180164,1735.582952867998,3828.8643188237497,7775.854138712626,19023.165909747277,19199.9654161147),c(2890.021929693704,2211.569859376354,2274.0290187352225,3207.228471661653,15672.074575720793,6652.967718157633),c(2827.4221767039485,1899.9525320939051,2211.044640116469,4994.652802011921,8668.478516571684,7425.282737450462),c(2991.746528302056,1264.1618680048061,2919.9850878252278,3743.198093064136,34968.2186509891,17615.20353472514),c(451.23988613448626,320.748970572777,574.915549020016,1006.6608914803047,2718.407564980328,2063.6685388494316),c(599.9142994851551,372.11446408087295,679.6453878860825,1162.9853643893623,6577.067675522489,3368.399339340667),c(10.43329216495922,55.931315153260044,39.548330760612565,54.97124322076749,15.639374066309419,150.7173651968686),c(31.299876494877658,109.57971948393805,77.63190853009132,187.24579722073926,115.16266357918754,222.95468224388847),c(96.50795252587278,335.0171632139148,206.53017174986562,376.2094457921275,308.5221974899222,543.1176059461123),c(774.6719432482221,706.5608995891422,964.5398446616064,1491.0949723633182,5539.181942031045,2845.7935641609924),c(2569.1981956212076,1170.5625242789424,1801.6461790945723,5502.277876128696,23112.15134744781,7315.5890337864685),c(636.4308220625123,533.6304047785525,636.4351746476356,1046.1714725452314,3776.197956374347,1934.3548231479765))
targetgene="E271_V272insQL*"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(294.74050366009794,331.0220692743962,547.8176186840407,4604.700545414602,5318.808943823958,5015.588531758515),c(542.5311925778794,295.6369515243745,433.5668853756044,1755.6440803632618,3225.9763414960066,6100.040106192789),c(138.24112118570966,274.52002641549063,301.73911617356254,2965.870356895471,1279.5851508798614,3820.551434931273),c(221.7074585053834,287.07603593969185,314.9218930937667,2523.523634103358,1477.2099686268623,3701.047725248549),c(109.54956773207181,131.83810000411296,250.47276148387957,1625.0873777139388,1217.0276546146238,323.73019861812605),c(83.46633731967376,155.2379359355789,89.34993245916172,26.626695935059253,48.33988347768366,243.46651301032622),c(109.54956773207181,148.95993117347828,138.41915766214396,261.1134052986456,2094.2543636067066,419.15480261851036),c(307.78211886629697,369.8315532582909,276.10593882872104,925.0629523244779,1515.5975231532582,1637.379186399117),c(156.49938247438828,238.56418095982346,153.06668757348197,157.18339858438205,75.3533477740363,41.02366153287548),c(1066.80412386708,2548.8699334128505,2764.721270765045,18025.41422235979,15737.47559454354,14896.048230078677),c(451.23988613448626,668.8928710165385,643.7589396033045,7801.621908972361,5752.446133844355,8100.389515284956),c(20.86658432991844,120.99427359684826,120.84212176853839,505.9072227661258,1832.6502883157127,981.8924206020848),c(719.8971593821861,356.70481602844416,346.41408240314337,335.8399390518764,271.5564042422817,337.1074795527594),c(20.86658432991844,14.838920346783278,22.70367136257388,36.07487836362866,24.16994173884183,23.187286953364403),c(86.07466036091355,77.04824026214393,23.43604785814078,7.730331077920429,44.07459964141745,33.88911170107105),c(2250.9827845899517,7158.066884205995,8919.613339509267,30053.809379603976,31685.37185834288,24812.180677557863),c(8537.041313977881,27366.964213407882,33955.17146396815,128291.7156434921,220943.1244798682,128997.120052669),c(1551.952209537684,5037.813457732923,5635.63713338729,11467.516691257293,15997.65790855578,12405.198520049955),c(0.0,7.419460173391639,1.4647529911337986,1.717851350648984,8.53056767253241,10.701824747706647),c(203.4491972167048,38.23875627824921,80.56141451235892,16.31958783116535,1.4217612787554017,843.660517610874),c(7.8249691237194146,6.848732467746128,2.9295059822675973,8.589256753244921,93.83624439785652,0.8918187289755539),c(23.474907371158245,6.848732467746128,21.23891837144008,18.896364857138824,29.856986853863436,32.997292972095494),c(187.79925896926596,98.16516537102784,46.87209571628156,46.38198646752257,42.65283836266205,18.72819330848663),c(294.74050366009794,142.11119870573216,212.38918371440082,175.22083776619638,156.39374066309418,55.29276119648434),c(451.23988613448626,247.12509654450614,238.0223610592423,218.167121532421,186.25072751695762,135.5564468042842),c(101.7245986083524,57.64349827019658,67.37863759215473,359.88985796096216,5.687045115021607,14.269099663608863),c(18.258261288678632,20.546197403238384,8.788517946802791,14.601736480516365,0.0,40.13184280389993),c(7.8249691237194146,6.278004762100617,8.056141451235893,16.31958783116535,18.48289662382022,21.403649495413294),c(975.512817423687,577.5764381132568,662.068351992477,273.13836475318845,334.1139005075194,815.1223182836562),c(237.35739675282224,103.87244242748294,105.4622153616335,33.49810133765519,46.91812219892826,35.67274915902216))
targetgene="I255F"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(26.08323041239805,79.9018787903715,62.98437861875334,96.1996756363431,214.68595309206566,459.2866454224103),c(36.516522577357264,132.97955541540398,96.67369741483071,221.60282423371893,132.22379892425235,626.9485664698144),c(70.42472211347473,218.5887112622306,166.98184098925304,394.24688497394186,298.56986853863435,849.0114299847273),c(62.599752989755316,176.3548610444628,174.30560594492204,358.1720066103132,400.93668060902326,959.596952377696),c(46.94981474231649,104.44317013312845,91.54706194586241,124.54422292205135,176.2983985656698,437.88299592699695),c(78.24969123719414,287.6467636453374,208.72730123656632,306.63646609084367,429.3719061841313,715.2386206383942),c(101.7245986083524,367.54864243570887,388.1595426504566,1315.0152089217972,595.7179757985133,1407.2899543234241),c(122.59118293827083,419.48486364945035,370.58250675685105,1071.0803171296416,1868.1943202845978,1025.591538321887),c(213.882489381664,569.5862502342196,439.4258973401396,971.4449387920005,797.6080773817804,985.459695517987),c(279.09056541265915,713.4096320568883,768.9953203452443,2012.4628572852848,2289.035658796197,1605.2737121559971),c(73.03304515471453,282.51021429452777,216.0510661922353,598.671195701171,409.46724828155567,865.0641671062873),c(362.5569027323329,886.9108545731236,987.2435160241803,2854.210019103287,3238.772193004805,1664.1337482683837),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,0.7323764955668993,1.717851350648984,0.0,1.7836374579511078),c(2.608323041239805,3.424366233873064,30.75981281380977,2.576777025973476,233.16884971588587,4.45909364487777),c(182.58261288678634,599.2640909277862,550.0147481707414,1471.339681830855,1296.6462862249264,1234.2771209021666),c(260.83230412398046,663.1855939600835,741.897390009269,1966.9397964930868,2030.2751060627136,1574.9518753708282),c(803.3634967018598,1506.1504151985027,1884.404723093632,3444.291958051213,4346.324229155263,4149.632545923252),c(539.9228695366396,826.4137177746994,733.1088720624663,1879.3293776099886,2815.087331935695,1495.580008492004),c(448.6315630932464,725.3949138754441,721.3908481333958,1755.6440803632618,1572.4679743034742,1245.870764378849),c(628.605852938793,1203.664731206382,1194.5060642696128,4093.639768596529,3328.3431535663954,4294.998998746268))
targetgene="L22L"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1964.0672500535732,2346.2615979086945,2514.2485092811653,9742.793935205713,9513.004716152393,6141.95558645464),c(4254.174880262121,5066.920570720844,5106.861303587989,17583.067499567678,23076.607315478926,10970.26218512829),c(1645.8518390223169,2564.850309170925,1978.8812910217619,8503.364185712471,6046.750718546724,5546.22067549897),c(2031.883649125808,2572.8404970499623,2570.6414994398165,9945.500394582294,10437.149547343404,4941.567577253544),c(3260.4038015497563,4812.946741708592,4049.309643989386,16982.67845251586,13978.75689272311,13615.396535269781),c(1205.0452450527898,1926.776734259244,1636.86146759202,5870.756990842903,6469.013818337078,5756.689895537201),c(0.0,3.9950939395185747,0.0,2.576777025973476,1.4217612787554017,1.7836374579511078),c(44.341491701076684,114.71626883474765,77.63190853009132,22.332067558436794,18.48289662382022,128.42189697247977),c(182.58261288678634,206.60342944367486,194.81214782079522,54.97124322076749,45.496360920172854,44.5909364487777),c(206.0575202579446,268.81274935903554,269.5145503686189,26.626695935059253,22.748180460086427,92.74914781345761),c(0.0,2.2829108225820427,0.7323764955668993,0.858925675324492,0.0,7.134549831804431),c(190.40758201050576,220.87162208481263,189.68551235182693,426.88606063627253,54.02692859270527,80.26368560779986),c(5052.321730881502,5865.939358624559,6186.384258053598,26456.628651345003,23333.946106933654,24158.47754921878),c(2584.8481338686465,3537.370319590875,4119.617787563809,23249.40017968335,20797.523985634016,12302.639366217767),c(2003.1920956721701,2802.2730347194574,2782.2983066586507,13105.4879541011,12855.565482506343,7422.607281263536),c(404.29007139216975,736.2387402827088,599.0839733737237,2164.49270181772,1546.876271285877,1052.3461001911537),c(1147.662138145514,1586.0522939888742,1333.6575984273236,5941.188896219512,4798.444315799481,3814.3087038284443),c(581.6560381964765,1005.0514896417443,895.6964540783179,3948.48132946669,4779.961419175661,3812.525066370493),c(422.5483326808484,759.0678485085292,501.677899463326,1760.7976344152087,860.165573647018,1602.5982559690704),c(362.5569027323329,635.7906640890989,523.649194330333,1793.4368100775393,890.0225605008815,900.7369162653094),c(260.83230412398046,522.7865783712878,292.21822173119284,938.8057631296698,793.3427935455142,1224.4671148834354),c(2.608323041239805,5.136549350809596,5.859011964535195,98.77645266231659,55.448689871460665,10.701824747706647),c(122.59118293827083,100.44807619360988,142.08104013997846,46.38198646752257,21.326419181331026,113.26097857989535),c(1220.6951833002286,462.86016927850915,849.5567348576033,2565.610992194258,835.9956319081762,942.6523965271605),c(7.8249691237194146,2.2829108225820427,10.98564743350349,19.755290532463317,27.013464296352634,30.321836785168834),c(399.07342530969015,198.0425138589922,248.27563199717886,215.5903445064475,194.78129518949004,1217.332565051631),c(3774.2434406739976,1593.4717541622658,1952.5157371813536,1769.3868911684535,4940.620443675021,2762.854422366266))
targetgene="N345S"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(6938.1392896978805,8404.53619333579,12925.712770260207,16024.976324529049,17936.94029277815,16404.11370077634),c(12339.976308105517,13143.288333310466,15798.093385873586,23868.685591592308,19370.075661763593,18444.594952672407),c(14113.635976148584,13847.566322077026,14381.677243447202,31676.31998029194,27216.776159214656,23839.20644424553),c(7373.729237584928,5832.837151697119,6428.068501590676,11334.383211581997,10991.63644605801,9528.191300374818),c(6878.147859749365,6856.722655625165,8192.363479411335,8666.560064024125,13582.085495950352,11500.894328868744),c(4465.449046602546,4254.775045587282,4504.115447736431,4200.146552336766,4700.342787565358,4517.9536809901565),c(6917.272705367963,7407.474891573083,6922.422636098332,12806.581819088176,11666.973053466827,11260.995090774319),c(7065.947118718631,6421.828143923286,6261.086660601422,6512.374470310298,4700.342787565358,4575.030079644592),c(14737.025183004898,14943.93424462205,17614.387094879494,46236.82802839273,41703.101828453444,35866.27382320985),c(1463.2692261355305,1842.3090338237084,2132.6803550908107,9079.703313855205,5251.986163722454,7345.0190518426625),c(2710.0476398481574,3169.2509494495207,4423.554033224072,13031.620346023194,18528.392984740396,13898.103072355032),c(1846.6927131977818,2395.914908299854,2947.0830181612027,11840.290434348122,10776.950492965945,12221.483861880992),c(2297.932599332268,2136.2338022311465,2016.2324922956739,4786.792788583394,4455.799847619429,3619.892220911773),c(1823.2178058266236,1930.7718281987627,2814.522872463594,10241.829752569243,8305.929390489056,8912.836377381685),c(4079.417236499055,3613.277104441728,5202.070248011686,13706.735926828243,20046.834030451166,17870.26369121215),c(1927.5507274762158,2003.824974521388,1528.4697462481188,3202.933843285031,2304.675032862506,4767.662925103311),c(4063.767298251616,3420.3711399335457,3563.7440274285323,7848.862821115208,13135.652454421157,6021.56005804294),c(2232.724523301273,2704.1078693484296,3607.686617162546,11002.837900906743,21474.28235432159,13239.940850371073),c(8573.55783655524,11942.47724063231,14645.332781851286,12875.295873114135,7877.9792455836805,14896.048230078677),c(1411.1027653107344,1208.8012805571916,1238.4486540036266,1200.77809410364,1573.8897355822296,1190.5780031823645),c(12470.392460167506,13781.932635927791,19365.49929577995,17035.07291871065,28662.7073797089,22936.685890522273),c(1961.4589270123333,1964.4447628318478,1607.566407769344,1252.3136346231095,904.2401732884355,992.5942453497915),c(8910.031508875174,7994.182972976668,8883.726891226488,11187.506921101509,10158.484336707344,6226.678365707317),c(7924.085399286527,8539.22793186813,8272.924893923695,8648.52262484231,6925.3991888175615,5228.733207983672),c(17063.649335790804,16664.10754943762,20166.71918193014,63675.59601450589,85752.1097668533,54931.57461124924),c(8763.965418565744,8358.877976884149,7799.809677787478,18689.36376938562,20375.26088584366,12434.628538106148),c(12183.476925631128,12078.310434575942,12719.18259851034,36924.35585652459,37878.56398860141,15117.219274864614),c(15929.028812851488,18161.69704905144,20493.359098952977,54339.07392372866,59770.84415887709,55586.1695583173),c(2608.3230412398048,2857.0628944614264,2534.0226746614717,5501.4189504533715,9558.501077072566,4418.96180207387),c(12788.607871198763,12508.068396927012,14245.455215271759,30095.037812019553,27132.892243768085,36019.66664459365))
targetgene="G244R"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(446.02324005200666,609.5371896294054,479.70660459631904,1232.5583440906462,354.018558410095,643.0013035913744),c(1087.6707081969987,1302.971351988701,1244.307665968162,2879.1188636876973,1480.0534911843731,1816.6347509232032),c(1445.010964846852,1837.7432121785444,1901.9817589872375,3312.876329726566,2320.3144069288155,2615.7043320852995),c(555.5728077840785,842.9648212384193,609.3372443116602,1347.654384584128,642.6360979974415,1092.4779429950536),c(678.1639907223492,936.564164964283,815.1350395659589,2024.4878167398278,985.2805661774934,1118.3406861353446),c(359.9485796910931,723.6827307585075,525.1139473214669,1283.2349589347912,1110.3955587079688,885.575997872725),c(1306.7698436611422,1719.031849404278,1549.708664619559,2710.769431324097,3035.460330142783,2738.775316683926),c(198.23255113422516,330.4513415687507,261.45840891738305,461.24308764925223,487.6641186131028,451.2602768616303),c(1773.6596680430673,2004.966429932679,1971.557526066093,2367.1991611943,3284.268553924978,2004.8085027370453),c(1429.361026599413,1704.7636567631405,1934.938701287748,3462.3293972330275,4297.98434567758,3537.8448978460224),c(1285.9032593312238,1844.021216940645,1614.890172725013,2703.0391002461765,3152.0447550007257,2371.3460003459977),c(503.40634695928236,1047.285339859512,827.5854399905962,1300.4134724412809,1376.2649178352287,1966.4602973910964),c(65.20807603099512,179.77922727833587,138.41915766214396,256.8187769220231,99.52328951287812,401.3184280389993),c(305.17379582505714,645.4930350850726,543.4233597106393,1310.720580545175,810.403928890579,1299.379888117382),c(151.28273639190868,342.4366233873064,254.13464396171406,556.5838376102708,409.46724828155567,734.8586326758565),c(31.299876494877658,83.89697272989007,41.013083751746365,126.26207427270033,24.16994173884183,222.95468224388847),c(174.75764376306694,351.5682666776346,295.1477277134604,427.744986311597,591.4526919622471,434.31572101109475),c(36.516522577357264,162.08666840332504,103.26508587493281,211.29571612982505,123.69323125171995,553.819430693819),c(83.46633731967376,237.99345325417795,168.44659398038684,821.1329456102144,207.57714669828866,568.9803490864034),c(46.94981474231649,113.57481342345662,41.74546024731326,289.4579525843538,75.3533477740363,182.82283943998854),c(15.649938247438829,73.05314632262537,32.95694230051047,66.99620267531039,42.65283836266205,135.5564468042842),c(0.0,6.848732467746128,0.7323764955668993,0.0,0.0,2.6754561869266618),c(198.23255113422516,391.51920607282034,295.8801042090273,359.0309322856377,750.6899551828521,715.2386206383942),c(62.599752989755316,146.67702035089624,86.42042647689412,178.65654046749435,65.40101882274848,497.6348507683591),c(104.3329216495922,75.3360571452074,85.68804998132723,32.6391756623307,11.374090230043214,28.538199327217725),c(185.19093592802614,460.5772584559271,417.45460247313264,1442.9951345451466,861.5873349257735,1198.6043717431444),c(112.1578907733116,263.10547230258044,223.3748311479043,915.6147698959085,393.82787421524625,970.2987771254027),c(2.608323041239805,3.424366233873064,3.6618824778344967,10.307108103893905,17.06113534506482,0.0),c(0.0,0.0,0.0,0.0,0.0,0.0),c(20.86658432991844,77.04824026214393,59.322496140918844,216.449270181772,113.74090230043214,220.27922605696182))
targetgene="G293EfsTer13"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D16-NUT-REP1","D16-NUT-REP2","D16-NUT-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



dev.off()
Sweave("D16_NUT_D4_w_controls_summary.Rnw");
library(tools);

texi2dvi("D16_NUT_D4_w_controls_summary.tex",pdf=TRUE);

