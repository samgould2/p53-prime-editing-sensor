pdf(file='D34_D4_w_controls.pdf',width=4.5,height=4.5);
gstable=read.table('D34_D4_w_controls.gene_summary.txt',header=T)
# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=3
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("V173E","V172D","R174R","V172A","V173Ter","V173A","R174W","C176R","E171Ter","C176Y")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='D34-REP1,D34-REP2,D34-REP3_vs_D4-REP1,D4-REP2,D4-REP3 neg.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3905.1631298816537,2381.6987053188514,3795.2243651127383,471.86909865388577,1107.803447912928,1765.416449563773),c(2374.914919918329,1276.1200470473846,1347.2361817871752,400.57952259826277,382.35527945958745,782.4990417771676),c(1795.3902265411289,961.9206411252503,971.1898042281279,340.60575226575446,486.2496049999493,384.8580468017224),c(14260.852748791878,6135.289469115898,8540.571510500717,3051.8728035240524,2272.3863528072166,2257.5599542520968),c(30729.959721367468,11342.262511643672,16976.86125243464,5534.560579175432,4385.911033421903,6934.749384244559),c(977.2377182439056,441.8954211632154,530.8890036127727,230.84243675154124,93.02166356520769,92.21984039614226),c(5283.901616086234,4210.6080815019695,5670.189496919753,3081.293898404151,1741.4380263538558,3249.1515054422994),c(7825.477232139182,3525.0821049445854,5341.543923254703,3731.9527274832503,1989.6971414532088,2179.4926636197188),c(6427.800030464759,2516.955668830786,2943.0632462184267,947.1329390247059,925.3843414408973,954.1557743957294),c(5958.119886812649,2520.316090284499,3252.7484983258773,1059.1594156835422,659.0041230496207,1171.9224272123624),c(8601.96456640275,3390.665246796079,3925.8399136206426,2017.6081604313629,924.7803046644999,1652.1960514536577),c(5647.524953107222,2239.720898899491,3682.5157869647887,1591.0022846699362,1073.9773884346707,1163.704817672112),c(7200.499621634359,3160.476377216761,4945.483872940413,2257.503241761396,1418.882387757616,1749.8942982099668),c(5090.726718293834,3804.8371909661646,4362.980660643065,2306.1612063707894,2056.745223633326,2387.6721053060596),c(2484.759469643419,1644.0861962289214,2177.276925530955,1180.2385369208703,1058.2724322483368,1051.3974872886913),c(9598.1410001165,5086.837975557546,8978.765608720783,4349.7957199653165,3832.6133462418366,4996.306600472183),c(14476.754105148091,5994.151768059966,8887.12405452572,4283.032466198939,2937.4308436208116,4068.6297901505936),c(16484.257944951463,5802.607745198344,7281.8168293156705,1835.423688289215,1499.2192790184772,2207.3412292839002),c(26279.36158595433,9050.455080211636,12424.277376215585,3829.268656702037,2736.8906338568577,4777.6268799288555),c(1291.6203950433016,520.865325325463,638.3308257725006,113.15805723114767,57.98753053415545,103.176653116476),c(43176.483528148376,18010.17878117303,23928.979156887613,9023.223483611715,6259.633113806801,8560.00993776073),c(6439.163259746665,1949.0444431533456,3958.493800747619,1123.6595083052964,773.7711105651367,1534.8668485734174),c(3015.0435027990266,1124.9010816303146,1454.6780039469031,488.84280723855795,282.08517457761036,432.7941024531825),c(2927.9254116377483,1336.6076332142125,1542.1061533513875,544.2902552818202,414.9732653850499,546.9275682899922),c(178.02392541652546,163.82054586849242,114.81528054323854,31.684256024721346,121.41139205588797,14.152549763764407),c(4791.4950138703125,498.18248051290254,1371.4632593329961,391.52687801977095,70.67230283850195,82.17609540250301),c(1409.0404309563291,866.1486296944394,1467.3182183186357,573.7113501619186,692.8301825278782,530.9488830728388),c(927.9970580223135,484.7407946980519,607.7836410408132,260.26353163163964,257.3196667453148,312.72569639285865),c(556.7982348133881,314.1994059221342,451.8876637894435,174.2634081359674,187.85543745960774,269.8115132382182),c(647.7040690686351,201.62528722275988,408.70026468602344,355.31629970580366,194.49984199997974,108.65505947664286))
targetgene="V173E"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(2651.4201657780386,1660.8883034974847,1009.110447343326,401.71110317057423,617.9296222545939,971.9605950662717),c(3113.524823242211,1096.337499273757,1232.4209012439367,403.97426431519716,491.68593598752636,880.6538223968239),c(1420.403660238235,856.9074706967295,737.3458383510732,285.1583042224921,224.70168081985236,255.20242961110657),c(6458.101975216508,2298.5282743394628,4372.460821421864,817.0011732088861,1526.4009339563627,1305.2303153097562),c(2708.236312187568,1146.743821079447,1501.0254566432561,427.7374563337382,369.0664703788435,381.2057758949445),c(4215.758063587081,1182.0282463434298,1533.6793437702324,360.9742025673611,379.93913235399765,428.22876381971014),c(28586.097130181224,9374.735750494907,13463.935008290597,3805.505464683496,2063.389628173698,3277.4566049698283),c(1507.5217513995133,555.3096452260179,644.6509329583669,83.73696235104927,123.82753916147777,79.89342608576682),c(36487.32922419978,14590.109846656962,19542.824769896375,6523.561999375663,4643.834736943615,6905.531216990336),c(1579.4888701849172,728.3713500922202,874.281494044844,132.39492696044277,80.3368912608612,107.7419917499484),c(40566.72853640399,15291.597825119481,20877.420737311815,7410.721168067861,4584.639132856665,7155.711774104623),c(26184.668008605116,9573.840721627383,13509.229109789307,3951.4793585116768,2474.7386729003633,4572.186641422598),c(55141.963961995265,17516.196827477266,21824.383463994123,7810.169110093812,5618.750094049104,7174.886196365207),c(3439.270729323513,1321.4857366725055,1255.5946275921133,285.1583042224921,137.7203850186192,359.7486843176243),c(29854.991066660714,9681.374208146188,12352.649494775766,4438.059004605611,2437.8924295401184,3439.069592594751),c(5196.783524924956,1775.9827382871433,1999.2605731290528,1323.9492696044276,599.8085189626704,805.3257349445295),c(6461.889718310477,2669.8548449747123,3659.342060616612,1974.6080986835268,1097.5348227141712,1363.6666498182028),c(2749.901486221223,1281.1606792279536,1257.701329987402,616.7114119097548,389.6037207763569,506.7525883154352),c(2268.8581132872073,996.3649610258051,2430.0812129656083,916.5802635722961,301.4143514223288,679.7789225240388),c(1287.832651949333,701.4879784625188,974.349857821061,263.6582733485741,385.37546334157474,392.6191224786255),c(1117.384212720745,676.2848175596738,659.3978497253884,251.21088705314781,285.1053584595976,331.4435847900955),c(60.603889503498024,139.4574903290756,81.10804221861805,20.36845030160658,56.77945698136054,80.8064938124613),c(2579.453046992635,162.1403351416361,359.1927583967371,342.86891341037744,48.32294211179621,57.523266781752106),c(973.449975149937,209.1862354936134,733.1324335604957,753.6326611594435,89.39744290682297,483.92589514807327),c(90.90583425524704,103.33295970166445,97.9616613809283,33.9474171693443,47.1148685590013,21.00055771397299),c(35866.139356788924,13885.261446740731,14667.915427198135,5354.639268177908,4316.446804136196,5302.184288914833),c(29059.565016927303,10975.976573188991,12608.613835803353,6412.667103289138,3236.429047937551,4415.595526294495),c(1742.3618232255683,687.20618728424,705.7453024217415,151.63179668973788,68.25615573291213,104.54625470651771),c(7738.359140977904,3786.354872970745,5534.3071924236265,2922.8726182805444,2108.0883496271094,2308.691746946987),c(3704.4127459013166,1592.839769059803,1596.8804156288957,410.76374774906606,509.2030025030525,797.5646592676264))
targetgene="V172D"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(94.69357734921566,271.3540323872977,261.2310970158088,23.76319201854101,36.84624336024461,15.978685217153362),c(3329.4261795984226,1027.4488594726472,2698.685768364928,518.2639021186563,1306.5315473476899,434.16370404322424),c(2003.7160967094035,715.7697696407976,1019.6439593197698,454.89539006921365,162.48589285091475,311.356094802817),c(3337.00166578636,1478.5854396335726,1883.39194138817,634.8167010667385,389.6037207763569,786.6078465472928),c(1984.7773812395603,697.2874516453779,871.1214404519108,227.44769503460682,208.9967246335186,234.6584057604808),c(8696.658143751967,3641.8567504611005,4707.42650227278,1381.659878792313,1096.9307859377739,1486.0177251952628),c(5052.849287354148,3513.320629856591,4693.7329367034035,1738.107759070428,1395.3249534781155,1327.6004746137708),c(3212.0061436853953,1050.9718096486358,1725.3892617415113,299.8688516625413,287.5215055651874,331.9001186534427),c(10492.048370293096,4368.547889826465,6419.122198444915,1890.8711363324776,1369.9554088694224,1590.5639799017804),c(4617.258831547756,3065.5444711493788,4641.065376821184,1226.6333403856406,1003.3050855961687,1215.7496780936974),c(4583.169143702038,1838.990640544256,2093.008829719404,637.0798622113614,494.70611986951366,432.33756858983526),c(3007.4680166110893,1411.3770105593192,3437.0849579136457,826.053817787378,719.407800689366,630.9297991458842),c(2015.0793259913094,931.6768480418364,974.349857821061,496.76387124473825,630.6143945589405,172.5698003452563),c(3045.3454475507756,1605.4413495112256,2122.5026632534464,1188.1596009270504,488.6657521055391,942.7424278120484),c(287.8684751416156,57.127164713115306,120.0820365314605,21.500030873918057,4.228257434782168,37.4357767944736),c(94.69357734921566,82.33032561596029,97.9616613809283,50.92112575401645,45.906795006206394,12.326414310375451),c(5143.755121609395,2327.0918566960204,2551.216600694713,1338.659817044477,1949.8307142109768,1359.1013111847303),c(13473.002185246405,4328.222832381913,7803.225672149643,1957.6343900988547,1523.3807500743753,1619.3256132926565),c(5787.671447584062,2904.2442413711706,4989.724623241477,1941.792262086494,1176.05960364584,1817.4613099853582),c(8878.469812262461,2747.984643773532,4349.287095073688,917.7118441446075,633.0305416645303,793.4558544975013),c(28790.63525725553,11023.862578904396,16743.017286557584,5227.902244079022,3387.438242036914,5249.682894629901),c(31514.022541818973,10572.725998743472,15096.629364639402,4243.427146168037,3160.924450887869,3966.8227386241592),c(3090.798364678399,1229.9142520588352,1544.2128557466763,229.71085617922978,140.74056890060646,216.39705122659126),c(446.9536850882979,291.5165611095737,223.31045390061075,72.42115662793451,35.6381698074497,94.50250971287846),c(4299.088411654391,1603.7611387843692,2196.237247088554,879.2381046860174,520.6797012546041,625.4513927857173))
targetgene="R174R"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(4961.943453098901,2182.593734186376,2517.5093623700927,2547.187868273134,512.2231863850398,1784.1343379610098),c(3280.1855193768306,782.1380933516227,1459.944759935125,519.3954826909678,427.05400091299896,459.2730665273224),c(1390.101715486486,737.61250908993,904.8286787765313,543.1586747095088,213.8290188446982,362.94442136105494),c(10670.07229570962,3074.7856301470883,4721.120067842157,1357.896686773772,1077.6016090930555,2433.3254916407836),c(3033.98221826887,1102.2182368177541,1475.7450278997908,331.5531076872627,408.32886084467793,870.6100774031846),c(5954.3321437186805,1870.074538991098,2652.338315668575,1093.1068328528866,489.87382565833406,766.9768904233614),c(51263.31503377139,15390.730258004005,23167.40624099072,6932.062585980106,4295.305516962285,8276.958942485442),c(2295.3723149449875,1061.8931793732022,1177.6466389664283,216.13188931149205,147.9890102173759,211.83171259311888),c(26858.88627933153,9789.74780002842,14597.34089695596,5424.797263661219,3541.4676200182644,4849.75923033772),c(2102.1974171525876,746.8536680876398,1047.031090458524,152.76337726204935,124.43157593787522,157.0476489914502),c(37044.127459013165,12327.70610294491,17973.331485406234,4909.928103259497,4060.9392477200736,5992.463490295859),c(21828.763450541195,7056.885052796596,10063.717342294505,3369.8469443435774,2272.3863528072166,3471.940030755752),c(50373.19540668876,16000.646751852853,22624.93037420386,6423.982909012253,4344.836532626877,7470.720139814218),c(2908.9866961679054,1103.8984475446105,1448.3578967610367,239.89508133003307,118.99524495029816,168.00446171178393),c(49183.84407518261,13861.738496564743,20215.916185191138,7170.826086737828,3760.1289330741424,5856.872932881728),c(3696.8372597133794,1053.4921257389205,1271.3948955567791,453.7638094969021,398.06023564592124,419.0980865527653),c(10226.906353715292,4104.75480571002,6040.969118490579,2542.661545983888,1305.9275105712925,2875.706805224258),c(3958.1915331972145,1367.6915316610546,1663.2415410804924,774.0011114610501,441.5508835465378,551.4929069234646),c(1912.8102624541564,1155.9849800771567,1251.3812228015356,1262.843918699608,399.8723459751136,507.6656560421297),c(1011.3274060896233,539.3476433208828,843.7343093131567,308.92149624103314,189.6675477888001,326.42171229327585),c(1534.0359530572937,671.2441853791048,917.468893148264,345.1320745550004,268.7963654968664,388.9668515718476),c(291.6562182355842,64.6881129839688,166.42948922781366,183.31605271445923,5.436330987577073,32.8704381610012),c(1007.5396629956547,70.56885052796596,476.11474133526445,208.21082530531172,208.39268785712113,273.4637841449961),c(916.6338287404076,766.1760914464876,1140.7793470488748,870.1854601075256,76.10863382607903,579.7980064509935),c(174.23618232255683,57.96727007654347,36.867291917553665,27.15793373547544,12.684772304346504,78.5238244957251),c(21018.18642843191,7098.050215604577,7795.852213766133,2893.4515234004457,1746.8743573414329,2776.18242301456),c(31983.702685471082,11985.783220029647,14576.273873003074,6361.745977535122,4446.314711061648,5136.005962656438),c(2003.7160967094035,880.4304208727182,850.054416499023,203.6845030160658,71.2763396148994,152.4823103579778),c(4416.508447567418,1687.771675127186,2556.483356682935,999.1856453510339,494.1020830931162,949.1339018989098),c(6045.237977973928,2399.3409179508426,2480.6420704525394,953.9224224585748,827.53038366451,1759.0249754769115))
targetgene="V172A"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(2321.886516602768,877.9101047824337,1205.0337701051826,382.4742334412791,271.81654937885367,446.9466522169469),c(1325.7100828890193,760.2953539024904,759.4662135016055,289.68462651173803,247.65507832295555,385.3145806650697),c(5613.435265261504,3449.4726222360505,4248.1653800998265,1226.6333403856406,714.5755064781864,878.3711530800878),c(3265.034547000956,1122.38076554003,1619.000790779428,734.3957914301484,342.4888522173556,699.8664125113173),c(4007.432193418807,2172.512469825238,3656.182007023679,823.790656642755,1494.3869848072977,991.1350173268557),c(2806.717632630752,1050.1317042852077,1526.3058853867217,342.86891341037744,315.9112340558677,555.6017116935898),c(458.3169143702038,202.46539258618805,268.6045553993195,70.15799548331155,37.45028013664206,33.78350588769568),c(32707.16161641909,10791.153393234796,18399.93872045221,5902.324265176662,3694.2889244468197,7297.693805605614),c(1522.6727237753878,457.8574230683506,815.2938269767582,188.9739555760166,67.65211895651468,176.67860511538146),c(11007.181431072828,5554.776662987035,7134.347661645455,2503.0562259529866,1606.1337884408265,2166.709715445996),c(36858.528047408705,12557.89497252423,19280.54032168292,5567.376415772465,3459.9226552046084,5238.726081909567),c(9980.70305260733,4505.485064065256,5463.732662181453,1794.686787686002,1408.0097257824618,1925.2033017353067),c(3844.559240378156,1708.77430921289,2545.9498447064916,830.5801400766239,1625.462965285545,1155.943741995209),c(3431.6952431355758,1143.3833996257342,1828.6176791106616,669.8956988083942,661.4202701552106,694.8445400144976),c(3064.284163020619,1086.256234912619,1439.9310871798816,398.3163614536398,370.27454393163845,498.07844491183766),c(1935.5367210179681,831.7043097938846,799.4935590120923,129.00018524350835,110.53873008073381,127.37294787387967),c(29430.763840136227,10119.069102492262,12175.686493571508,3711.5842771816433,2376.2806783475785,3410.307959203875),c(46968.01436521097,15585.63470231934,20904.80786845057,8082.880028020878,4837.730542167197,7134.71121639065),c(200.7503839803372,176.4221263199149,169.58954282074686,19.236869729295105,51.34312599378347,126.91641401053242),c(621.1898674108547,434.33447289236193,615.157099424324,114.28963780345914,340.67674188816324,136.50362514082445),c(734.8221602299135,723.3307179116512,510.8753308575293,196.89501958219694,61.61175119254016,153.85191194801953),c(0.0,1.6802107268563324,0.0,0.0,0.0,0.0),c(87.11809116127841,17.64221263199149,28.44048233639854,41.868481175524636,8.456514869564336,2.282669316736195),c(3056.7086768326817,1297.9627864965169,1133.405888665364,415.29007003831197,242.21874733537848,533.6880862529223),c(621.1898674108547,251.1915036650217,277.0313649804747,86.00012349567223,44.69872145341149,181.7004776122011),c(484.8311160279842,67.2084290742533,115.86863174088293,71.28957605562303,22.349360726705743,199.04876441939618),c(83.33034806730979,31.08389844684215,60.04101826573025,76.94747891718042,141.3446056770039,132.85135423404654),c(1628.7295304065094,690.5666087379526,1043.871036865591,845.2906875166731,176.9827754844536,393.9887240686672),c(799.2137928273802,198.26486576904722,202.24342994772294,7.921064006180337,73.08844994409176,81.71956153915578),c(3060.49641992665,1470.184385999291,1477.8517302950797,561.2639638664924,647.5274242980691,1122.6167699708606))
targetgene="V173Ter"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3424.1197569476385,1116.500027996033,2164.636711159222,2612.8195414671995,607.6609970558372,971.9605950662717),c(2594.604019368509,935.037269495549,1237.6876572321587,751.3695000148206,362.42206583847155,694.8445400144976),c(1772.6637679773173,1060.2129686463459,1126.0324302818533,389.26371687514796,305.03857208071355,541.9056957931726),c(16726.673502965456,6145.370733477036,7508.287336809214,3214.8204059369054,2033.1877893538253,2463.4567266217014),c(30127.708569426457,11981.582693212507,16879.952942251355,6648.035862329925,5108.943054769654,6618.8279508082705),c(1655.2437320642898,506.58353414718425,757.3595111063166,114.28963780345914,83.96111191924591,240.13681212064768),c(6211.898674108547,3830.04035186901,5620.681990630467,2791.609271892413,2190.8413879935606,2289.5173246864033),c(7999.713414461739,3846.8424591375733,4632.638567240028,2378.582362998724,1813.3184027451525,2356.1712687351),c(10427.656737695628,4613.858655947489,4714.799960656291,1252.6596935488046,1065.5208735651063,1231.2718294475035),c(6427.800030464759,1917.9605447065035,3042.0782587969993,912.0539412830502,807.597170043394,620.4295202888977),c(11170.05438411348,4126.597545159152,5634.375556199844,1856.9237191631332,1235.8592445091879,1627.5432228329068),c(6632.338157539065,2761.4263295883825,5130.873683725826,1399.7651679492967,1299.2831060309204,1521.6273665363474),c(4852.098903373811,5317.026845136864,4276.605862436225,1537.8179977712969,1346.397974589922,1284.6862914591304),c(4590.744629889975,4489.52306216012,5277.289500198395,2916.0831348466754,2573.8007042295453,2040.249835298811),c(2651.4201657780386,1660.8883034974847,2090.9021273241146,1052.3699322496734,1004.5131591489636,1153.2045388151255),c(8708.021373033873,5064.155130744986,7974.921917365679,4250.216629601907,2919.9137771052856,4171.349909403722),c(11348.078309530005,4862.529843522226,8030.7495308408315,4359.97994511612,2390.17352420472,3297.0875610937596),c(25438.482619093294,8071.732331817821,11792.26665762895,3868.873976732939,2827.4961503164755,3884.646643221656),c(26809.64561910994,9325.169534052646,14707.942772708622,4433.532682316366,2269.3661689252294,3995.584372015035),c(1333.2855690769566,720.8104018213667,822.6672853602688,113.15805723114767,90.60551645961789,119.15533833362936),c(36737.32026840171,14539.703524851273,21250.30706127793,7487.668646985041,4625.713633651691,8233.131691604107),c(4514.989768010603,2232.1599506286375,3200.080938443658,1321.6861084598047,623.365953242171,1225.3368892239894),c(5287.689359180203,1913.7600178893626,2316.319283620014,643.8693456452303,605.2448499502475,627.2775282391063),c(3329.4261795984226,1851.5922209956784,1621.1074931747166,753.6326611594435,377.52298524840785,780.2163724604313),c(606.0388950349802,274.71445384101037,411.86031827895664,165.2107635574756,314.7031605030728,84.4587647192392),c(1257.530707197584,1051.8119150120642,734.18578475814,224.05295331767238,96.64588422359242,607.1900382518278),c(1670.3947044401643,566.231014950584,1180.8066925593616,700.448374260804,423.42978025461423,981.5478061965638),c(1988.565124333529,561.190382770015,797.3868566168035,230.84243675154124,331.61619024220147,391.2495208885838),c(761.3363618876939,491.4616376054772,516.1420868457512,279.50040136093475,212.01690851550586,254.74589574775933),c(2765.0524585970975,901.4330549584223,1988.727061152609,530.7112884140826,630.010357782543,702.1490818280535))
targetgene="V173A"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1299.195881231239,819.9428347058903,1655.8680826969817,580.5008335957875,247.65507832295555,992.9611527802447),c(2265.0703701932384,779.6177772613382,1088.1117871666552,207.07924473300022,376.9189484720104,535.057687842964),c(1325.7100828890193,497.3423751494744,713.1187608052522,350.78997741655775,231.34608536022432,341.94386364708197),c(1174.2003591302741,494.8220590591899,504.555223671663,98.44750979109847,74.29652349688666,92.21984039614226),c(32820.79390923815,12792.284368920687,20008.405999255196,6508.851451935614,4613.632898123743,5188.963890804718),c(21601.49886490308,7512.222159774662,11692.198293852733,3255.5573065401186,2681.9232872046896,3970.01847566759),c(2261.28262709927,946.7987445835433,1168.1664781876289,268.18459563782,327.99196958381674,246.07175234416178),c(7814.114002857276,4208.087765411685,5512.186817273095,1708.6866641903298,1583.1803909377231,1550.8455337905707),c(3886.224414411811,1581.918399335237,2644.964857285064,688.0009879653778,469.9406120372181,737.7587231691381),c(4833.160187903967,1886.0365408962332,2321.586039608236,622.3693147713121,570.2107169191952,483.92589514807327),c(2246.1316547233955,1005.606120023515,2168.8501159497996,405.1058448875087,518.2635541490143,396.72792724875063),c(3961.9792762911834,2609.3672588078844,3467.632142645333,1348.8440421952803,1340.9616436023448,960.5472484825907),c(1704.484392285882,1594.5199797866594,1791.750387193108,1043.3172876711815,515.8474070434245,709.9101575049566),c(2787.7789171609093,1246.7163593273988,1274.5549491497122,456.0269706415251,334.03233734779127,276.6595211884268),c(6632.338157539065,3384.7845092520815,4333.486827109022,1448.4231325586902,897.5986497266146,1111.6599572505268),c(170.4484392285882,73.92927198167862,263.3377994110976,79.21064006180337,176.37873870805615,22.37015930401471),c(1348.436541452831,258.7524519358752,514.0353844504625,499.02703238936124,197.520025881967,61.63207155187726),c(575.7369502832312,68.04853443768147,209.61688833123367,9.052644578491813,3.020183881987263,47.93605565146009),c(931.7848011162821,807.3412542544677,601.4635338549468,634.8167010667385,200.54020976395427,839.1092408322252),c(8950.436931047865,2971.452670445424,4443.035351664038,824.9222372150665,793.1002874098552,910.3285235143944),c(8586.813594026877,3610.772852014258,5740.7640271619275,1557.0548675005919,1414.654130322834,2025.6407516716993),c(13548.757047125777,4765.077621364559,7151.201280807766,2283.52959492456,1377.8078869625892,2479.891945702202),c(32214.75501420317,11963.100375217087,17800.581888992554,6941.115230558598,4587.659316738653,6571.348429020158),c(23059.779956080998,7529.024267043225,10966.439318675748,3197.846697352233,2438.496466316516,3342.7409474284837),c(1874.93283151447,668.7238692888203,864.8013332660445,145.97389382818048,108.72661975154146,124.63374469379623),c(2390.0658922942034,895.5523174144251,1259.808032382691,271.5793373547544,440.9468467701404,580.2545403143407),c(5268.750643710359,2080.1008798481394,2893.55573992914,2431.7666498973635,740.5490878632769,2102.7949745773826),c(3136.2512818060227,1134.1422406280244,1306.155485079044,465.07961522001693,450.61143519249964,530.4923492094916),c(412.8639972425803,91.57148461367012,271.7646089922527,108.63173494190175,23.55743427950065,115.50306742685146),c(1886.296060796376,1381.1332174759052,1593.7203620359626,657.448312512968,234.3662692422116,379.8361743049028))
targetgene="R174W"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(102.26906353715292,195.74454967876272,172.74959641368002,46.39480346477055,32.013949149064985,146.09083627111647),c(204.53812707430583,172.22159950277407,362.3528119896703,6.78948343386886,33.82605947825734,24.652828620750903),c(215.90135635621172,131.05643669479392,115.86863174088293,70.15799548331155,4.8322942111796205,14.152549763764407),c(499.9820884038587,64.6881129839688,388.68659193078,36.210578313967254,101.47817843477203,29.67470111757053),c(5014.971856414461,2055.737824308723,2181.4903303215324,699.3167936884926,538.8008045465277,468.40374379426714),c(6302.804508363794,2847.9571820214833,3533.9932680969296,1107.8173802929357,1332.5051287327803,1440.364338860539),c(4340.753585688046,3018.498570797401,2924.1029246608277,970.896131043247,855.9201121551903,978.8086030164803),c(5219.509983488767,1764.221263199149,2738.713113875415,890.5539104091322,519.4716277018092,640.060476412829),c(2583.2407900866033,1172.78708734572,2009.7940851054968,542.0270941371973,553.2976871800665,621.3425880155922),c(4064.248339828336,3320.096396268113,3488.699166598221,1596.6601875314936,1119.2801466644796,1161.4221483553758),c(0.0,0.0,0.0,0.0,0.0,0.0),c(602.2511519410116,497.3423751494744,661.5045521206771,426.6058757614267,172.75451804967145,331.9001186534427),c(151.50972375874505,95.77201143081095,76.8946374280405,39.60532003090169,62.81982474533507,24.196294757403663),c(1151.4739005664624,263.7930841164442,735.2391359557845,106.36857379727881,569.6066801427978,303.5950191259139),c(174.23618232255683,31.924003810270317,45.294101498708784,46.39480346477055,11.476698751551599,17.34828680719508),c(2511.2736713011996,1179.5079302531453,1791.750387193108,855.4749126674764,503.162634739078,650.1042214064682),c(1022.6906353715292,330.16140782726933,778.4265350592044,775.1326920333615,331.01215346580403,394.9017917953617),c(170.4484392285882,201.62528722275988,204.35013234301172,30.552675452409872,3.020183881987263,38.80537838451531),c(2340.825232072611,989.6441181183798,972.2431554257723,450.36906777996774,233.1581956894167,745.9763327093884),c(106.05680663112155,63.848007620540635,109.5485245550166,21.500030873918057,79.73285448446374,7.761075676903062),c(121.20777900699605,64.6881129839688,72.68123263746293,20.36845030160658,4.228257434782168,30.13123498091777),c(5022.547342602399,943.4383231298307,1716.9624521603562,338.34259112113153,933.8408563104616,475.25175174447577),c(477.25562984004694,136.9371742387911,219.0970491100332,48.657964609393495,52.551199546578374,46.10992019807113),c(246.20330110796073,58.807375439971636,268.6045553993195,81.47380120642632,103.89432554036185,110.48119493003182),c(371.1988232089254,219.26749985475138,176.96300120425758,63.36851204944269,103.89432554036185,34.24003975104292),c(1083.2945248750273,191.5440228616219,147.46916767021466,124.47386295426243,62.81982474533507,357.00948113754083),c(2643.8446795901014,1340.8081600313533,1793.8570895883968,337.21101054882007,300.20627786953395,510.40485922221313),c(3238.5203453431754,1883.5162248059487,2605.9908629722217,1168.9227311977554,553.2976871800665,1097.5074074867625),c(2742.3260000332857,879.59031550929,1333.5426162177982,866.7907183905911,475.98097980119263,691.1922691077198),c(35794.17223800352,13581.143305179736,20377.078918430732,7992.35358223596,4511.550682912573,7229.670259966876))
targetgene="C176R"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3643.8088563978185,1301.3232079502295,1297.7286754978888,663.1062153745254,524.3039219129888,639.1474086861346),c(2439.3065525157954,1187.908983887427,1318.7956994507767,269.31617621013146,330.40811668940654,535.057687842964),c(2397.6413784821407,985.4435913012389,806.8670173956029,582.7639947404105,328.5960063602142,662.4306357168437),c(2522.636900583105,1781.8634758311405,1701.1621841956903,599.7377033250826,340.0727051117658,537.3403571597003),c(3287.761005564768,1474.3849128164318,1435.717682389304,732.1326302855255,358.7978451800868,787.9774481373344),c(5363.444221059575,3194.080591753888,2983.0905917289133,618.9745730543777,884.3098406458705,932.6986828184091),c(25893.01179036953,8499.345961802757,11934.469069310942,3520.347160461004,2695.2120962854333,3700.2069624293717),c(26896.763710271218,9736.821162132446,12753.976301078279,4246.821887884972,2671.0506252295354,3538.593974804449),c(32896.54877111752,10380.341870518421,14757.450278997909,5079.665189106219,3665.2951591797423,4169.98030781368),c(1784.026997259223,770.3766182636284,768.9463742804049,109.76331551421323,109.93469330433636,136.0470912774772),c(47562.69003096404,17564.08283319267,21294.547811578996,8106.643220039419,5151.225629117475,7081.75328824237),c(2405.216864670078,910.6742139561322,931.162458717641,174.2634081359674,129.8679069254523,131.02521878065758),c(46479.395506089015,14433.010143695896,16069.92587126282,6192.008891688401,3908.7219800679154,5571.082734426357),c(1295.4081381372703,688.0462926476681,698.3718440382308,112.02647665883619,70.0682660621045,113.22039811011526),c(55679.82348133881,19734.074986927626,21429.376764877477,8880.644331500469,5493.110444558433,6734.3310182351215),c(7454.278408930257,2159.9108893738153,3359.1369692879607,3419.6364895252827,892.1623187390375,1379.645335035356),c(4408.932961379482,1328.2065795799308,1637.9611123370269,876.9749435413944,638.4668726521073,814.4564122114742),c(4825.58470171603,1920.480860796788,1625.3208979652943,1046.712029388116,435.5105157825633,877.4580853533932),c(25559.69039810029,9142.866670188732,10196.439593197698,4521.795966956661,3058.2381989003025,4242.569192085892),c(2204.466480689741,956.8800089446813,867.9613868589777,179.92131099752478,124.43157593787522,188.5484855624097),c(28980.02241195396,11084.350165071224,13329.106054992115,6751.00969441027,4025.301077912624,4868.9336525983035),c(3946.828303915309,1622.2434567797889,1736.9761249155997,866.7907183905911,792.4962506334577,1559.063143330821),c(2727.175027657411,1150.1042425331595,1672.721701859292,1022.9488373695749,760.4823014843928,636.8647393693983),c(7162.622190694673,2773.187804676377,4833.828645990107,3931.11090821007,1703.3837094408163,4557.121023932139),c(1541.611439245231,1125.7411869937428,1195.5536093263831,362.10578313967255,771.9590002359444,645.0823489096487),c(753.7608756997566,391.48909935752545,450.83431259179906,288.55304593942657,142.5526792297988,340.57426205704024),c(579.5246933771998,651.921762020257,713.1187608052522,157.28969955129526,298.998204316739,814.9129460748215),c(28472.464837362164,9100.021296653897,11371.979529768838,3978.637292247152,2085.738988900404,2766.595211884268),c(42862.10085134898,14261.62864955655,18718.050782140817,8682.617731345961,4722.963554651682,5662.846040959152),c(2530.2123867710425,862.7882082407267,804.7603150003142,176.52656928059037,135.90827468942683,125.09027855714348))
targetgene="E171Ter"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(193.17489779239995,48.72611107883364,51.614208684575125,30.552675452409872,19.933213621115936,22.37015930401471),c(280.2929889536784,94.93190606738278,72.68123263746293,22.631611446229535,19.933213621115936,65.28434245865517),c(723.4589309480077,205.82581403990073,275.97801378283026,138.05282982200015,47.1148685590013,5.021872496819628),c(94.69357734921566,15.962001905135159,51.614208684575125,278.3688207886233,30.201838819872627,233.2888041704391),c(5283.901616086234,1992.7299220516102,2373.2002482928115,577.1060918788531,470.54464881361554,530.9488830728388),c(10749.614900682962,4965.86280322389,6818.342302352139,2316.3454315215927,1912.9844708507324,2122.882464564661),c(4484.687823258854,2080.9409852115677,2206.770759064998,600.8692838973941,434.90647900616585,593.0374884880633),c(9317.848011162821,3536.8435800325797,4763.254115747933,1648.7128938578214,1370.5594456458198,2371.236886225559),c(7488.368096775975,4791.120887630832,5966.181183457827,1798.0815294029364,2635.4124554220857,2727.3332996364056),c(5181.632552549081,2821.9139157552104,3877.3857585290007,1294.5281747243293,1143.4416177203777,1315.7305941667425),c(0.0,0.0,0.0,0.0,0.0,0.0),c(1571.91338399698,505.7434287837561,1380.9434201117958,141.4475715389346,95.4378106707975,1354.535972551258),c(1477.2198066477642,707.3687160065159,1107.0721087242543,468.4743569369513,252.48737253413518,788.8905158640289),c(113.63229281905879,77.28969343539129,85.32144700919562,72.42115662793451,32.013949149064985,11.413346583680974),c(999.9641768077174,372.16667599867765,591.9833730761474,332.68468825957416,209.60076140991603,179.4178082954649),c(132.57100828890194,52.92663789597447,135.88230449612635,11.315805723114767,30.201838819872627,16.4352190805006),c(935.5725442102507,376.3672028158185,712.0654096076079,468.4743569369513,147.38497344097843,217.31011895328572),c(98.48132044318429,64.6881129839688,50.560857486930736,16.97370858467215,16.30899296273122,19.630956123931274),c(2969.590585671403,646.881129839688,1350.3962353801085,516.0007409740334,347.3211464285352,1121.7037022441662),c(1878.7205746084387,1045.9311774680668,989.0967745880826,488.84280723855795,373.2947278136257,637.3212732327455),c(98.48132044318429,93.25169534052645,89.53485179977318,10.18422515080329,25.36954460869301,9.587211130292017),c(128.7832651949333,20.16252872227599,27.38713113875415,1.1315805723114767,5.436330987577073,1.8261354533889558),c(378.77430939686263,150.37886005364174,154.84262605372538,270.4477567824429,15.100919409936314,295.3774095856636),c(299.2317044235215,152.89917614392624,127.45549491497123,21.500030873918057,24.765507832295555,60.71900382518278),c(291.6562182355842,59.6474808033998,174.8562988089688,47.52638403708202,24.161471055898105,21.00055771397299),c(299.2317044235215,205.82581403990073,249.6442338417205,82.6053817787378,105.10239909315675,30.13123498091777),c(530.2840331556077,105.85327579194895,301.25844252629565,90.52644578491814,128.6598333726574,77.61075676903062),c(534.0717762495764,484.7407946980519,461.36782456824295,174.2634081359674,236.78241634780142,111.3942626567263),c(0.0,0.0,0.0,0.0,0.0,0.0),c(2662.7833950599443,1514.7099702609837,2213.090866250864,651.7904096514105,499.53841408069326,709.4536236416093))
targetgene="C176Y"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=9
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("D393N","L22L","V197L","R196Q","W23Ter","R196L","G325A","H193N","R267P","L330P")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='D34-REP1,D34-REP2,D34-REP3_vs_D4-REP1,D4-REP2,D4-REP3 pos.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(117.42003591302742,356.20467409354245,194.86997156421222,523.9218049802137,990.6203132918222,656.9522293566769),c(291.6562182355842,618.3175474831303,518.2487892410401,1242.4754683980013,2041.0402674469922,1540.8017887969315),c(117.42003591302742,345.2833043689763,255.96434102758684,700.448374260804,1272.1014510930352,796.1950576775847),c(22.72645856381176,82.33032561596029,72.68123263746293,93.92118750185257,134.70020113663193,91.76330653279503),c(68.17937569143528,107.53348651880528,63.20107185866342,152.76337726204935,193.89580522358227,176.67860511538146),c(113.63229281905879,145.33822787307275,224.36380509825514,237.6319201854101,445.77914098132,242.41948143738387),c(90.90583425524704,253.7118197553062,255.96434102758684,551.0797387156891,1003.3050855961687,578.884938724299),c(268.9297596717725,702.3280838259469,419.23377666246733,1111.2121220098702,1983.6567736892343,1433.5163309103302),c(155.29746685271368,423.4131031677958,279.13806737576346,940.3434555908372,1148.8779487079548,802.1299979010988),c(344.684621551145,719.1301910945103,632.0107185866342,1399.7651679492967,2187.821204111573,1671.3704737142418),c(340.8968784571764,905.6335817755631,673.0914152947654,1275.2913049950341,2882.4634969686435,1764.5033818370785),c(393.92528177273715,815.7423078887495,622.5305578078347,1311.5018833090014,2809.9790838009494,1538.5191194801953),c(56.816146409529395,85.69074706967295,56.88096467279708,215.00030873918058,414.9732653850499,427.7722299563629),c(75.75486187937253,257.912346572447,193.81662036656783,306.65833509641016,610.6811809378246,704.8882850081369),c(143.9342375708078,360.40520091068333,298.09838893336246,908.6591995661158,983.3718719750527,676.1266516172609),c(776.4873342635684,1189.5891946142833,1119.712323095987,2203.187374290445,3392.874573024491,2527.828001353662),c(284.08073204764696,590.5940704900008,539.3158131939279,957.3171641755092,1614.5903033103907,1151.3784033617367),c(613.6143812229175,1155.1448747137285,959.6029410540395,2423.845585891183,2833.53651808045,2383.106766672587),c(477.25562984004694,898.9127388681378,783.6932910474264,1557.0548675005919,2752.5955900431914,2481.2615472922434),c(215.90135635621172,504.9033234203279,449.7809613941547,1022.9488373695749,1644.7921421302633,1249.9897178447402),c(420.43948343051756,600.6753348511388,607.7836410408132,1214.1859540902144,1645.396178906661,1355.4490402779525),c(98.48132044318429,179.78254777362758,150.62922126314783,499.02703238936124,924.7803046644999,935.4378859984926),c(212.1136132622431,414.17194417008596,300.20509132865124,1064.8173185450996,1577.1400231737487,1386.4933429855646),c(124.99552210096468,205.82581403990073,200.13672755243417,685.7378268207549,1080.0177561986452,758.3027470197638),c(11.36322928190588,13.44168581485066,30.54718473168732,227.44769503460682,326.7838960310218,256.11549733780106),c(53.02840331556077,152.89917614392624,106.38847096208342,562.3955444388039,840.2151559688565,668.3655759403578),c(200.7503839803372,126.8559098776531,173.8029476113244,898.4749744153124,1296.2629221489333,1147.7261324549588))
targetgene="D393N"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(37.87743093968626,117.61475087994327,90.58820299741757,388.1321363028365,814.241574583766,490.7739030982819),c(53.02840331556077,195.74454967876272,139.04235808905952,419.8163923275579,1082.433903304235,775.1944999636117),c(102.26906353715292,321.7603541929877,240.164073062921,699.3167936884926,1336.7333861675625,1205.705933100058),c(90.90583425524704,259.59255729930334,250.6975850393649,786.4484977564763,1302.9073266893051,885.6756948936436),c(68.17937569143528,153.7392815073544,131.6688997055488,529.5797078417711,930.216635652077,619.059918698856),c(113.63229281905879,423.4131031677958,300.20509132865124,952.7908418862634,1797.6134465588189,1470.0390399781095),c(147.72198066477642,541.0278540477391,558.2761347515269,1488.0284525895918,2551.45134350284,2224.232982227748),c(178.02392541652546,617.4774421197021,532.9957060080615,1388.4493622261818,2517.6252840245825,2011.0316680445876),c(310.59493370542737,838.4251527013099,632.0107185866342,1871.6342666031824,2520.6454679065696,2180.8622652097606),c(405.28851105464304,1050.1317042852077,1106.0187575266098,2642.2406363472983,3696.7050715524097,3573.7470822821865),c(106.05680663112155,415.8521548969423,310.7386033050951,1093.1068328528866,2088.1551360059934,1605.173063528892),c(526.4962900616391,1305.5237347673703,1419.917414424638,2888.9252011112,4060.335210943676,3970.01847566759),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,0.0,1.0533511976443903,4.526322289245907,7.248441316769431,1.8261354533889558),c(3.7877430939686265,5.0406321805689975,44.240750301064395,45.26322289245907,15.704956186333767,19.174422260584034),c(265.1420165778039,882.1106315995745,791.0667494309372,1811.6604962706742,2507.960695602223,2360.7366073685725),c(378.77430939686263,976.2024323035291,1067.0447632137675,2315.213850949281,2645.0770438444447,2777.0954907412547),c(1166.6248729423369,2217.0380540869305,2710.2726315390164,4367.9010091223,5149.413518788283,5250.595962356595),c(784.0628204515057,1216.4725662439846,1054.4045488420347,2419.319263601937,3761.337006626937,3390.6770030799435),c(651.4918121626038,1067.7739169171994,1037.5509296797245,2371.792879564855,3237.0330847139485,3161.953537542977),c(912.846085646439,1771.7822114700025,1718.0158033580005,4694.927794520317,5499.1508123224085,5391.208392267545))
targetgene="L22L"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(200.7503839803372,893.8721066875688,648.8643377489444,1283.2123690012145,2079.698621136429,1350.4271677811328),c(22.72645856381176,111.7340133359461,91.64155419506196,210.47398644993467,457.85987650926904,312.72569639285865),c(90.90583425524704,1082.0557080954782,810.0270709885361,1503.8705806019525,2224.667447471818,1885.4848556240968),c(34.08968784571764,339.40256682497915,187.49651318070147,521.6586438355907,826.3223101117151,571.123863047396),c(242.4155580139921,1385.333744293046,1226.1007940580703,2988.50429147461,3170.5890393102286,2754.7253314372397),c(37.87743093968626,321.7603541929877,274.9246625851859,689.1325685376893,972.4992099998987,708.9970897782621),c(189.38715469843132,773.7370397173411,661.5045521206771,1438.238907407887,1728.1492172731118,1381.4714704887451),c(212.1136132622431,1041.730650650926,682.571576073565,1756.2130482274117,2176.948542136419,1444.473143630664),c(223.47684254414895,1110.6192904520358,1088.1117871666552,2122.8451536563302,2784.0055024158587,2405.0203921132547),c(3.7877430939686265,0.0,1.0533511976443903,5.657902861557384,1.2080735527949051,2.282669316736195),c(121.20777900699605,261.27276802615967,159.05603084430294,73.55273720024599,286.3134320123925,157.50418285479745),c(37.87743093968626,50.40632180568997,89.53485179977318,88.26328464029518,96.64588422359242,86.7414340359754),c(143.9342375708078,950.9992714006842,832.1474461390684,1947.4501649480515,3057.634162123905,2557.046168607885),c(374.986566302894,1394.5749032907559,1264.0214371732684,3252.162564823184,3656.2346075337805,3255.542979529161),c(215.90135635621172,1587.799136879234,1375.6766641235738,2456.661422488216,3452.674213887839,3042.3416653460004),c(4333.178099500109,4644.942554394331,5055.032397495429,10678.725860903405,10873.266011930544,11763.964590731654),c(64.39163259746665,103.33295970166445,104.28176856679464,725.3431468516566,1281.162002738997,945.4816309921318),c(155.29746685271368,299.07750938042716,313.8986568980283,953.9224224585748,1630.899296273122,1441.7339404505806),c(3083.222878490462,3822.4794035981563,3912.1463480512657,8088.537930882435,8117.046201228967,8859.039618253171),c(117.42003591302742,184.82317995419658,167.48284042545805,929.0276498677224,1220.7583250992516,1157.3133435852508),c(3.7877430939686265,1.6802107268563324,0.0,5.657902861557384,0.6040367763974526,3.6522709067779116),c(0.0,14.281791178278826,8.426809581155123,142.57915211124606,207.7886510807237,120.06840606032384),c(49.240660221592144,84.01053634281662,109.5485245550166,462.81645407539395,159.4657089689275,228.26693167361947),c(1534.0359530572937,2010.3721346836019,1752.7763928802656,4313.585141651349,5647.743859316181,4636.557916154558),c(424.2272265244862,629.2389172076965,622.5305578078347,2099.0819616377894,2622.1236463413416,2557.046168607885),c(15.150972375874506,42.845373534836476,29.493833534042928,147.10547440049197,196.31195232917207,56.15366519171039),c(64.39163259746665,120.13506697022777,86.37479820684001,384.73739458590205,494.70611986951366,356.09641341084637),c(306.80719061145874,1843.1911673613968,2097.2222345099813,3510.1629353102007,3807.2438016331434,3528.55022981081),c(518.9208038737019,1860.8333799933882,1902.3522629457689,3254.425725967807,3950.40051763934,3717.555249236567),c(325.7459060813019,1978.4481308733314,1750.6696904849766,3093.741284699577,3941.339965993378,3868.2114241411555))
targetgene="V197L"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(128.7832651949333,677.124922923102,423.4471814530449,903.0012967045584,1293.242738266946,918.0895991912976),c(94.69357734921566,854.387154606445,718.3855167934742,1170.054311770067,1785.53271103087,1402.472028202718),c(443.16594199432933,1807.0666367339854,1457.8380575398362,3425.2943923868397,3343.3435573599,2650.6356105940695),c(37.87743093968626,338.562461461551,231.73726348176586,804.5537869134599,893.9744290682298,661.061034126802),c(178.02392541652546,1313.924788401652,1106.0187575266098,2328.792817817019,3021.3919555400576,2842.836367063257),c(242.4155580139921,1859.99327462996,1588.4536060477405,2466.8456476390193,3604.2874447635995,3140.952979829004),c(280.2929889536784,1402.1358515616093,1103.912055131321,2293.7138200753634,3354.216219335054,3048.7331394328617),c(128.7832651949333,810.7016757081803,812.133773383825,2223.5558245920515,2197.4857925339325,2120.5997952479247),c(140.1464944768392,1149.2641371697314,911.1487859623976,1715.4761476241986,1855.6009770929743,2033.4018273486022),c(37.87743093968626,256.2321358455907,205.4034835406561,580.5008335957875,943.5054447328209,533.6880862529223),c(45.45291712762352,208.34613013018523,140.0957092867039,434.526939767607,806.3890964905992,491.68697082497636),c(113.63229281905879,591.434175853429,500.34181888108543,1140.6332168899685,1616.402413639583,1508.3878844992776),c(83.33034806730979,181.46275850048391,106.38847096208342,129.00018524350835,187.85543745960774,253.83282802106484),c(0.0,0.8401053634281662,0.0,0.0,0.6040367763974526,0.0),c(11.36322928190588,15.962001905135159,23.173726348176586,92.7896069295411,32.61798592546244,68.48007950208584),c(22.72645856381176,39.484952081123815,28.44048233639854,319.1057213918364,479.60520045957736,359.292150454277),c(4492.263309446791,5099.439556008969,5400.531590322789,10743.22595352516,12289.73225258257,12533.224150471751),c(204.53812707430583,259.59255729930334,260.1777458181644,1087.4489299913291,1536.0655223787219,1288.7950962292555),c(0.0,0.0,0.0,0.0,3.020183881987263,2.282669316736195),c(0.0,3.360421453712665,4.213404790577561,73.55273720024599,97.24992099998987,82.17609540250301),c(166.66069613461957,88.21106315995745,239.11072186527662,308.92149624103314,410.74500795026773,158.87378444483915),c(1113.5964696267763,1536.552709710116,1292.461919509667,3248.7678231062496,4233.693765769745,3644.9663649643558),c(7.575486187937253,8.401053634281663,22.120375150532197,35.078997741655776,63.42386152173252,14.152549763764407),c(18.93871546984313,47.886005715405474,54.7742622775083,148.23705497280343,262.75599773289184,196.76609510266),c(3212.0061436853953,3415.0283023354955,4137.563504347166,9160.144732861403,6457.757176465166,8219.43567570369),c(7.575486187937253,13.44168581485066,20.013672755243416,78.0790594894919,92.41762678881024,83.08916312919749),c(496.1943453098901,629.2389172076965,610.9436946337464,2694.293342673626,3531.198994819508,3361.9153696890676),c(159.0852099466823,817.4225186156058,884.8150060212879,1580.818059519133,1583.1803909377231,1600.6077248954198),c(393.92528177273715,1302.1633133136577,1215.5672820816264,2220.1610828751172,2407.0865539438487,2841.466765473215),c(333.32139226923914,2256.5230061680545,2195.1838958909093,4197.032342703267,4898.134219806943,4618.753095484017))
targetgene="R196Q"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(11.36322928190588,52.92663789597447,38.97399431284244,140.3159909666231,308.0587559627008,194.93995964927103),c(22.72645856381176,62.1677968936843,54.7742622775083,160.68444126822968,337.656558006176,255.6589634744538),c(34.08968784571764,236.0696071233147,161.16273323959172,545.4218358541318,1081.2258297514402,687.9965320642891),c(124.99552210096468,299.07750938042716,304.4184961192288,931.2908110123453,1552.9785521178505,1132.6605149644997),c(26.514201657780387,178.9424424101994,140.0957092867039,408.5005866044431,1067.937020670696,635.4951377793566),c(117.42003591302742,352.8442526398298,248.59088264407612,866.7907183905911,1988.4890679004138,1342.6660921042298),c(94.69357734921566,313.359300558706,283.351472166341,848.6854292336075,1911.7763972979374,1109.833821797138),c(238.62781492002347,882.1106315995745,729.9723799675625,2018.7397410036745,3380.793837496542,2789.42190505163),c(412.8639972425803,1071.9744437343402,959.6029410540395,2054.9503193176415,3370.5252122977854,2945.556486316386),c(64.39163259746665,267.99361093358505,198.0300251571454,751.3695000148206,1444.8559691427065,1021.7227861711208),c(147.72198066477642,388.1286779038128,484.54155091641957,1296.7913358689523,2065.2017385028903,1841.2010708794146),c(640.1285828806979,1141.703188898878,1315.6356458578434,3155.9782161767084,4605.176383254178,4195.546204161126),c(522.7085469676705,1034.1697023800725,989.0967745880826,2451.0035196266585,3304.0811668940655,3332.240668571497),c(651.4918121626038,1095.4973939103288,1119.712323095987,3408.320683802168,4236.713949651732,3622.596205660341),c(507.55757459179597,1013.1670682943685,900.6152739859538,2249.5821777552155,2690.379802074254,2672.0927021713896),c(0.0,0.0,0.0,0.0,0.0,0.0),c(0.0,2.5203160902844988,1.0533511976443903,2.2631611446229534,2.4161471055898103,0.9130677266944779),c(34.08968784571764,76.44958807196312,33.70723832462049,13.57896686773772,74.90056027328411,50.218724968196284),c(196.96264088636858,514.9845877814658,200.13672755243417,341.737332838066,236.78241634780142,334.1827879701789),c(128.7832651949333,472.9793196100576,482.4348485211308,924.5013275784764,1825.3991382731017,1354.535972551258))
targetgene="W23Ter"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(200.7503839803372,1063.5733901000585,791.0667494309372,1538.9495783436082,1982.4487001364394,1583.7159719515719),c(132.57100828890194,1137.502662081737,907.9887323694645,1596.6601875314936,2077.2824740308392,1782.764736370968),c(435.5904558063921,1290.4018382256634,1185.020097349939,2009.6870964251825,2944.075248161184,2459.8044557149233),c(37.87743093968626,386.44846717695646,290.7249305498517,591.8166393189023,1038.339218627221,849.6095196892117),c(170.4484392285882,1361.8107941170574,1022.804012912703,2534.740481977708,2983.9416754034155,2583.5251326820253),c(215.90135635621172,1540.7532365272568,1186.0734485475834,1901.0553614832809,2681.9232872046896,2679.3972439849454),c(261.35427348383524,1101.378131454326,923.7890003341304,2295.976981219986,3266.026849981026,2761.5733393874484),c(223.47684254414895,1114.8198172691766,1183.9667461522947,2768.9776604461836,3416.4320073039917,3148.25752164256),c(87.11809116127841,863.6283136041549,765.7863206874717,1299.0544970135752,1584.9925012669155,1496.9745379155966),c(41.66517403365489,425.0933138946521,267.55120420167515,635.9482816390499,1227.4027296396237,847.7833842358227),c(26.514201657780387,141.9778064193601,129.56219731026002,279.50040136093475,381.1472059067926,332.35665251678995),c(87.11809116127841,914.8747407732731,676.2514688876986,1385.0546205092476,2169.70010081965,1571.8460915045437),c(159.0852099466823,134.4168581485066,167.48284042545805,59.973770332508266,198.12406265836444,119.6118721969766),c(0.0,0.0,0.0,0.0,0.0,0.45653386334723894),c(18.93871546984313,49.566216442261805,18.960321557599027,38.47373945859021,80.3368912608612,76.2411551789889),c(37.87743093968626,47.886005715405474,44.240750301064395,262.52669277626256,421.61766992542186,368.87936158456904),c(3011.255759705058,3551.9654765742866,3662.502114209545,6448.877681603106,6815.950984868855,8508.421611202491),c(348.47236464511366,402.4104690820916,494.02171169521904,1552.528545211346,2054.329076527736,1646.7176450934908),c(0.0,1.6802107268563324,0.0,5.657902861557384,2.4161471055898103,1.3696015900417169),c(15.150972375874506,5.0406321805689975,9.480160778799513,96.18434864647551,154.63341475774786,116.87266901689317),c(94.69357734921566,147.85854396335725,159.05603084430294,245.55298419159044,570.2107169191952,173.4828680719508),c(1416.6159171442664,1650.8070391363467,1837.0444886918167,4276.24298276507,5137.3327832603345,3570.551345238756),c(18.93871546984313,58.807375439971636,20.013672755243416,54.31586747095088,55.57138342856564,80.34995994911405),c(75.75486187937253,115.93454015308694,135.88230449612635,279.50040136093475,466.9204281552308,295.83394344901086),c(4037.734138170556,4511.365801609252,5356.290840021725,9957.909036340994,10870.245828048557,10957.725788060428),c(34.08968784571764,63.00790225711247,72.68123263746293,226.31611446229533,292.35379977636705,307.2472900326918),c(405.28851105464304,693.0869248282371,728.9190287699181,1939.529100941871,3006.895072906519,2219.2111097309285),c(272.71750276574113,1846.5515888151094,1883.39194138817,2881.0041371050197,2559.907858372404,2744.6815864436007),c(568.1614640952939,1987.6892898710412,1906.5656677363465,4300.006174783612,3777.041962813271,3954.4963243137836),c(329.5336491752705,1475.22501817986,1667.4549458710699,3343.8205911804134,3110.1853616704834,3504.8104689167535))
targetgene="R196L"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(11.36322928190588,23.522950175988655,13.693565569377075,43.000061747836114,39.86642724223187,36.52270906777912),c(3.7877430939686265,22.68284481256049,38.97399431284244,65.63167319406564,105.7064358695542,99.98091607304534),c(0.0,1.6802107268563324,2.1067023952887807,2.2631611446229534,6.644404540371978,4.10880477012515),c(18.93871546984313,110.05380260908977,33.70723832462049,183.31605271445923,214.43305562109566,35.60964134108464),c(7.575486187937253,7.560948270853496,3.160053592933171,7.921064006180337,28.993765267077723,28.761633390876053),c(0.0,5.0406321805689975,7.373458383510732,50.92112575401645,52.551199546578374,84.91529858258644),c(3.7877430939686265,9.241158997709828,12.640214371732684,7.921064006180337,49.53101566459111,28.761633390876053),c(3.7877430939686265,5.0406321805689975,15.800267964665855,28.289514307786916,19.933213621115936,12.78294817372269),c(11.36322928190588,18.482317995419656,51.614208684575125,14.710547440049197,121.41139205588797,53.8709958749742),c(15.150972375874506,27.723476993129484,46.34745269635317,140.3159909666231,54.36330987577073,84.00223085589197),c(53.02840331556077,185.66328531762474,102.17506617150586,201.42134187144285,578.0631950123621,233.2888041704391),c(0.0,3.360421453712665,4.213404790577561,11.315805723114767,11.476698751551599,23.739760894056424),c(0.0,2.5203160902844988,11.586863174088293,14.710547440049197,7.852478093166884,7.761075676903062),c(26.514201657780387,23.522950175988655,58.987667068085855,92.7896069295411,47.1148685590013,148.37350558785266),c(30.301944751749012,43.68547889826464,45.294101498708784,124.47386295426243,230.7420485838269,81.26302767580853),c(0.0,5.880737543997164,2.1067023952887807,10.18422515080329,19.933213621115936,4.10880477012515),c(11.36322928190588,11.761475087994327,27.38713113875415,31.684256024721346,76.10863382607903,120.52493992367108),c(26.514201657780387,47.04590035197731,31.60053592933171,71.28957605562303,80.3368912608612,52.04486042158524),c(0.0,21.84273944913232,21.06702395288781,45.26322289245907,62.21578796893761,31.500836570959486),c(22.72645856381176,99.13243288452361,20.013672755243416,134.65808810506573,64.02789829812997,105.00278856986496),c(75.75486187937253,151.2189654170699,141.1490604843483,259.1319510593282,103.29028876396438,239.68027825730044),c(0.0,4.200526817140831,1.0533511976443903,11.315805723114767,22.953397503103197,15.065617490458886),c(3.7877430939686265,24.36305553941682,22.120375150532197,33.9474171693443,114.16295073911853,32.8704381610012),c(0.0,1.6802107268563324,0.0,3.39474171693443,6.040367763974526,5.021872496819628),c(18.93871546984313,26.88337162970132,66.36112545159659,75.81589834486894,174.56662837886378,77.15422290568338),c(11.36322928190588,89.89127388681379,93.74825659035073,190.10553614832807,273.02462293164854,380.29270816825004),c(0.0,6.72084290742533,4.213404790577561,19.236869729295105,38.658353689436964,26.9354979374871),c(11.36322928190588,0.8401053634281662,3.160053592933171,5.657902861557384,19.933213621115936,29.218167254223292),c(11.36322928190588,26.88337162970132,32.6538871269761,41.868481175524636,48.32294211179621,42.45764929129322),c(22.72645856381176,47.04590035197731,53.72091107986391,76.94747891718042,64.02789829812997,114.13346583680973))
targetgene="G325A"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(0.0,0.0,0.0,0.0,0.0,0.45653386334723894),c(15.150972375874506,69.7287451645378,32.6538871269761,102.97383208034438,161.8818560745173,95.41557743957294),c(11.36322928190588,11.761475087994327,16.853619162310245,24.894772590852487,21.745323950308293,11.413346583680974),c(0.0,0.0,0.0,2.2631611446229534,4.228257434782168,0.45653386334723894),c(30.301944751749012,46.205794988549144,26.333779941109757,100.71067093572142,152.21726765215806,89.93717107940607),c(15.150972375874506,15.962001905135159,14.746916767021464,20.36845030160658,65.23597185092488,33.78350588769568),c(583.3124364711684,1689.4518858540423,1404.1171464599722,2824.425108489446,2716.9574202357417,3211.715728647826),c(268.9297596717725,648.5613405665443,613.0503970290351,1607.9759932546083,1729.9613276023042,1741.6766886697167),c(1056.7803232172469,1189.5891946142833,1276.6616515450012,2138.687281668691,2740.5148545152424,2331.5184401143492),c(3.7877430939686265,4.200526817140831,1.0533511976443903,21.500030873918057,37.45028013664206,38.34884452116807),c(715.8834447600705,1324.8461581262181,1211.3538772910488,2933.0568434313477,3135.554906279176,3010.840828775041),c(79.54260497334116,432.6542621655056,299.1517401310069,770.6063697441156,1038.9432554036184,835.0004360621),c(143.9342375708078,642.6806030225472,477.1680925329088,854.3433320951649,1276.9337453042147,1212.0974071869193),c(90.90583425524704,480.5402678809111,388.68659193078,807.9485286303943,913.9076426893457,939.0901569052705),c(45.45291712762352,82.33032561596029,54.7742622775083,207.07924473300022,218.66131305587783,136.50362514082445),c(219.68909945018035,568.7513310408685,374.99302636140294,1235.6859849641326,1615.194340086788,1311.1652555332703),c(166.66069613461957,462.8980552489196,310.7386033050951,1321.6861084598047,1741.4380263538558,1293.8169687260752),c(0.0,0.8401053634281662,3.160053592933171,13.57896686773772,34.4300962546548,15.978685217153362),c(200.7503839803372,320.08014346613135,374.99302636140294,715.1589217008533,1285.9942969501765,892.9802367071994),c(79.54260497334116,243.6305553941682,181.17640599483514,566.9218667280498,870.4169947887292,550.5798391967702),c(7.575486187937253,10.92136972456616,26.333779941109757,101.8422515080329,89.39744290682297,68.48007950208584),c(1386.3139723925174,2679.0960039724223,2576.4970294381787,4302.269335928235,4797.864114924966,4988.54552479528),c(2590.8162762745405,5138.924508090093,5465.839364576742,6855.115107062926,7595.158426421569,7425.066753479494),c(1768.8760248833487,2674.055371791853,2712.379333934305,4295.479852494365,3846.506192098978,4379.98588495341),c(409.07625414861167,1241.6757271468296,1053.3511976443904,1742.6340813596742,1687.6787532544824,1856.2666883698735),c(287.8684751416156,903.1132656852786,821.6139341626244,1182.5016980654932,1360.8948572234606,1420.2768488732604),c(412.8639972425803,897.2325281412815,1048.0844416561683,1492.5547748788376,1623.6508549563525,1061.4412322823305))
targetgene="H193N"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(333.32139226923914,1138.3427674451652,705.7453024217415,2034.5818690160352,3061.862419558687,2326.0400337541823),c(761.3363618876939,1518.9104970781245,1413.597307238772,3314.399496300315,4597.927941937409,4547.5338128018475),c(613.6143812229175,1966.686655785337,1569.4932844901416,4582.9013178614805,5388.008045465277,4541.142338714986),c(208.32587016827446,684.6858711939554,426.6072350459781,1156.4753449023292,2062.7855913973003,1535.7799163001118),c(708.3079585721332,2073.380036940714,1306.155485079044,2627.5300889072487,3375.9615432853625,2851.9670443302016),c(121.20777900699605,298.237404016999,176.96300120425758,291.94778765636096,371.4826174844333,330.9870509267482),c(477.25562984004694,1627.284088960358,1193.4469069310942,2041.371352449904,3522.138443173546,2242.494336761638),c(1052.9925801232782,3226.004595564158,2350.0265219446346,5183.770601758874,5199.548571229272,5221.377795102372),c(2246.1316547233955,5407.758224387106,4855.949021140639,12243.701792410178,13070.751804464477,13353.158969043392),c(579.5246933771998,1491.187020084995,1291.4085683120225,5411.218296793481,6995.953944235295,5633.171339841581),c(1113.5964696267763,3132.752900223632,2797.700780943501,11264.884597360751,14338.020961346332,14844.198566735475),c(1640.0927596884153,3636.8161182805316,3530.8332145039963,5527.771095741564,5303.442896769634,4720.103613147104),c(2007.503839803372,3987.1400548300767,3266.4420638952543,3710.452696609332,3780.6661834716556,3184.780230710339),c(2431.731066327858,4726.432774646863,4636.851972030607,7589.510898493074,6950.047149229089,7818.598943684814),c(170.4484392285882,698.1275570088061,338.1257344438493,1392.9756845154277,2160.0355123972904,1815.6351745319694),c(2980.953814953309,7796.177772613382,7575.701813458455,23255.112341573156,23219.777721494473,24410.40913931352),c(238.62781492002347,993.0045395720924,644.6509329583669,2405.7402967341995,3354.8202561114517,2557.046168607885),c(1174.2003591302741,3689.742756176506,3791.010960322161,5685.0607952928585,6066.945382136014,5967.810661675107),c(1003.751919901686,2921.8864540031623,2052.9814842089168,4043.1373848689063,5456.868237974587,3993.7582365616463),c(575.7369502832312,1605.4413495112256,1108.1254599218987,2724.8460181260357,3078.1714125214185,2454.782583218104),c(2973.378328765372,7913.7925234933255,7565.168301482011,9574.303222327404,11507.50462714787,12882.016022069041),c(1840.8431436687524,3924.9722579363925,3410.751177972536,3339.2942688911676,4073.62402002442,3317.6315849443854),c(2212.041966877678,4910.415849237632,4714.799960656291,12062.648900840342,12810.411953837174,14210.529564409506),c(2912.774439261874,6091.6039902176335,6351.707721795674,8533.249095800846,8686.048844595369,9630.581847310006),c(2920.349925449811,6007.593453874817,6340.120858621585,17691.130667517627,18441.242783414225,19686.653255259636),c(7.575486187937253,41.165162807980145,31.60053592933171,99.57909036340995,155.84148831054276,108.65505947664286),c(75.75486187937253,214.2268676741824,135.88230449612635,628.0272176328696,1068.5410574470936,1022.6358538978152),c(56.816146409529395,194.0643389519064,131.6688997055488,549.9481581433777,755.0459704968157,532.3184846628806),c(492.40660221592145,1412.2171159227473,1190.286853338161,2988.50429147461,3661.06690174496,3154.648995729421),c(439.3781989003607,1980.1283416001877,1398.8503904717504,4999.322968472104,5240.623072024298,4388.20349449366))
targetgene="R267P"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(7.575486187937253,21.84273944913232,29.493833534042928,75.81589834486894,57.98753053415545,51.588326558238),c(68.17937569143528,75.60948270853496,60.04101826573025,44.13164232014759,264.5681080620842,169.37406330182566),c(3.7877430939686265,1.6802107268563324,4.213404790577561,13.57896686773772,30.201838819872627,33.78350588769568),c(143.9342375708078,144.4981225096446,92.69490539270635,108.63173494190175,264.5681080620842,309.07342548608074),c(7.575486187937253,16.802107268563326,27.38713113875415,57.71060918788531,30.80587559627008,22.82669316736195),c(30.301944751749012,102.49285433823628,37.920643115198054,89.39486521260666,125.03561271427269,254.2893618844121),c(124.99552210096468,183.9830745907684,163.2694356348805,203.6845030160658,276.64884359003327,178.50474056877042),c(68.17937569143528,429.29384071179294,163.2694356348805,204.81608358837727,320.13949149064985,402.20633360891753),c(15.150972375874506,38.64484671769564,36.867291917553665,31.684256024721346,111.74680363352873,105.91585629655944),c(15.150972375874506,165.50075659534875,37.920643115198054,82.6053817787378,164.90203995650455,111.3942626567263),c(90.90583425524704,194.0643389519064,174.8562988089688,227.44769503460682,231.9501221366218,522.7312735325886),c(11.36322928190588,72.2490612548223,40.02734551048683,97.31592921878699,38.054316913039514,84.00223085589197),c(30.301944751749012,26.88337162970132,42.13404790577562,131.26334638813128,244.63489444096828,56.15366519171039),c(41.66517403365489,126.01580451422494,77.94798862568489,149.36863554511493,269.40040227326386,267.0723100581348),c(15.150972375874506,42.845373534836476,22.120375150532197,41.868481175524636,85.77322224843826,69.84968109212755),c(367.41108011495675,515.824693144894,581.4498610997034,995.7909036340994,1963.119523291721,1987.7484410138784),c(26.514201657780387,27.723476993129484,34.76058952226488,80.34222063411484,161.8818560745173,100.8939837997398),c(53.02840331556077,117.61475087994327,139.04235808905952,307.7899156687217,716.3876168073788,355.1833456841519),c(219.68909945018035,493.14184833233355,441.35415181299953,789.8432394734107,1017.8019682297075,748.2590020261247),c(102.26906353715292,249.51129293816535,190.65656677363464,393.7900391643939,791.2881770806629,673.8439823005247),c(3.7877430939686265,19.32242335884782,27.38713113875415,47.52638403708202,114.76698751551599,120.52493992367108),c(26.514201657780387,135.25696351193477,130.6155485079044,350.78997741655775,468.7325384844232,337.8350588769568),c(22.72645856381176,26.88337162970132,40.02734551048683,91.65802635722962,331.01215346580403,119.15533833362936),c(3.7877430939686265,21.84273944913232,3.160053592933171,24.894772590852487,121.41139205588797,42.91418315464046),c(22.72645856381176,141.9778064193601,95.85495898563953,183.31605271445923,335.2404109005862,228.26693167361947),c(7.575486187937253,3.360421453712665,5.266755988221952,21.500030873918057,59.799640863347804,34.69657361439016),c(37.87743093968626,225.14823739874853,140.0957092867039,391.52687801977095,369.67050715524095,246.98482007085627),c(15.150972375874506,49.566216442261805,47.40080389399756,213.8687281668691,472.3567591428079,273.4637841449961),c(3.7877430939686265,35.28442526398298,26.333779941109757,152.76337726204935,152.8213044285555,52.04486042158524),c(3.7877430939686265,30.243793083413983,33.70723832462049,71.28957605562303,213.22498206830076,135.13402355078273))
targetgene="L330P"
collabel=c("D4-REP1","D4-REP2","D4-REP3","D34-REP1","D34-REP2","D34-REP3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



dev.off()
Sweave("D34_D4_w_controls_summary.Rnw");
library(tools);

texi2dvi("D34_D4_w_controls_summary.tex",pdf=TRUE);

